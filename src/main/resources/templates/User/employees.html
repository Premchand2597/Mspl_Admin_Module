<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Employee</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
 <!--  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> -->
  <link rel="stylesheet" href="/assets/css/all.min.css">  
  <script src="assets/js/xlsx.full.min.js"></script>

  <!-- Google Fonts -->
  <!-- <link href="https://fonts.gstatic.com" rel="preconnect">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet"> -->
 
  <link rel="stylesheet" href="/assets/font/fonts.css">
  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  <!-- <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script> -->
  <script src="assets/js/jquery-3.6.4.min.js"></script> 
  <!-- =======================================================
  * Template Name: NiceAdmin
  * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
  * Updated: Apr 20 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="assets/js/sweetalert2.all.min.js"></script>
  <style>
  
     .attendanceListsOuterDiv{
   	width: 100%;
   	height: 100%;
   	position: fixed;
   	background: rgba(0,0,0,0.3);
   	top: 0;
   	left: 0;
   	z-index: 9000;
   	display: none;
   }
   
   .attendanceListsInnerBox{
	width: 66%;
   	height: auto;
   	background: rgb(255,255,255);
   	margin: 1% auto;
   	border-radius: 10px;
   	padding: 5px;
   	overflow: auto;
}

.employeeAttendnaceButtonBox{
	width: 30%; padding-top: 16px;
}

.employeeAttendnaceButtonBox2{
	width: 40%; padding-top: 16px;
}

.employeeAttendnaceTextFieldsMerger,.employeeAttendnaceTextFieldsMerger2{
	display: flex; align-items: center; gap: 20px; width: 100%;
}

.employeeAttendnaceTextFieldBox{
	width: 30%;
}

.employeeAttendnaceTextFieldBox2{
	 width: 40%;
}
  
  .fixTHead{
	position: sticky;
	top: 0;
}

.border-custom-success {
  border: 2px solid #28a745;
}

.border-custom-danger {
  border: 2px solid #dc3545;
}
  
  .filterDetails_outerBox{
	width: 70%;
	height: 100%;
	background-color: rgba(240, 248, 255, 0.9);
	z-index: 8900;
	position: fixed;
	top: 0;
    right: -10px; /* Initially positioned outside the screen */
    transform: translateX(100%); /* Initial position outside the viewport */
    transition: transform 0.8s ease;
    border: 5px solid rgb(218, 232, 245);
}

.filterDetails_outerBox.active {
    transform: translateX(0); /* When the modal is active, it slides to the right edge of the screen */
}

.close_FilterDetails_outerBox_span{
	font-size: 25px;
	color: #000;
	margin-left: 10px;
	cursor: pointer;
}

.marksDetails_outerBox_closeBox{
	/* background-color: red; */
	margin-top: 2vh;
	margin-bottom: 3px;
}

.filterBoxHeadingMerger{
	display: flex; align-items: center;
}

.filterDetails_InnerBox{
	width: 98%;
	height: 90%;
	/* background-color: #fff; */
	margin: 1px auto; 
	padding: 0 50px;
	overflow: auto;
	color: #000;
}
  
  .permissionListsOuterDiv{
   	width: 100%;
   	height: 100%;
   	position: fixed;
   	background: rgba(0,0,0,0.3);
   	top: 0;
   	left: 0;
   	z-index: 9000;
   	display: none;
   }
   
   .permissionListsInnerBox{
	width: 80%;
   	height: 92%;
   	background: rgb(255,255,255);
   	margin: 1% auto;
   	border-radius: 10px;
   	padding: 5px;
   	/* overflow: auto; */
}
  
     .leaveBalanceUpdateOuterDiv{
   		width: 100%;
	   	height: 100%;
	   	position: fixed;
	   	background: rgba(0,0,0,0.3);
	   	top: 0;
	   	left: 0;
	   	z-index: 9002;
	   	display: none;
   }
   
   .leaveBalanceUpdateInnerBox{
	width: 36%;
   	height: auto;
   	background: rgb(255,255,255);
   	margin: 1% auto;
   	border-radius: 10px;
   	padding: 10px;
   	overflow: auto;
}
  
     .leaveBalanceListsOuterDiv{
   		width: 100%;
	   	height: 100%;
	   	position: fixed;
	   	background: rgba(0,0,0,0.3);
	   	top: 0;
	   	left: 0;
	   	z-index: 9000;
	   	display: none;
   }
   
   .leaveBalanceListsInnerBox{
	width: 96%;
   	height: 94%;
   	background: rgb(255,255,255);
   	margin: 1% auto;
   	border-radius: 10px;
   	padding: 5px;
   	overflow: auto;
}

   .emailFormInnerBoxCloser{
   	/* background: red; */
   	padding-right: 10px;
   	text-align: right;
   }
   
   .emailFormInnerBoxCloser span{
   	font-size: 25px;
   	font-weight: bold;
   	cursor: pointer;
   }
  
  .permissionListsIcon:hover,.leaveBalanceIcon:hover,.filterIcon:hover {
  color: #6776f4;
}

.permissionListsIcon{
  /* position: fixed;
  right: 20px;
  top: 72px;
  z-index: 9000; */
  color: #4154f1;
  font-size: 22px;
  cursor: pointer;
  padding-left: 10px;
}

.leaveBalanceIcon{
  /* position: fixed;
  right: 60px;
  top: 75px;
  z-index: 9000; */
  color: #4154f1;
  font-size: 18px;
  cursor: pointer;
  padding-left: 10px;
}

.filterIcon{
  /* position: fixed;
  right: 100px;
  top: 75px;
  z-index: 9000; */
  color: #4154f1;
  font-size: 18px;
  cursor: pointer;
}
  .employeeFormAcademicBtnDiv,.employeeFormCandidateTypeDiv{
	display: flex;
	gap: 4px;
	margin-bottom: 10px;
	/* background: red; */
}

.hiddenTenthDetailBox,.hiddenPucDetailBox,.hiddenUGDetailBox,.hiddenPGDetailBox,
	.hiddenOtherDetailBox,.hiddenfresherDetailBox,.hiddenExperienceDetailBox{
	padding: 20px;
	margin: 20px 0;
	font-size: 14px;
	display: none;
}

.hiddenAcademicHeading,.hiddenCandidateTypeHeading{
	/* background: red; */
	margin: 0;
	margin-bottom: 5px;
	font-weight: bold;
	font-size: 14px;
}

.hiddenTextFieldsDiv1,.hiddenTextFieldsDiv2,.hiddenTextFieldsDiv3{
	display: flex;
	gap: 4px;
	margin-bottom: 5px;
}

.employeeFormCustomBtn{
	padding: 0 10px;
	border-radius: 50px;
	font-size: 12px;
}
  .custom_table_div{
	width: 100%;
	height: 72vh;
	overflow: auto;
	padding: 0 14px;
}

.custom_table_div2{
	width: 100%;
	height: 66vh;
	overflow: auto;
	padding: 0 14px;
}

.custom_table_div3{
	width: 100%;
	height: 70vh;
	overflow: auto;
	padding: 0 14px;
}
   .table-container {
            max-height: 345px; /* Adjust as needed */
            overflow-y: auto;
            border-radius: 4px;
            position: relative;
        }

        .table-container thead {
            position: sticky;
            top: 0;
            background-color: #f8f9fa; /* Light background for the header */
            z-index: 1; /* Ensure the header is above the scrolling content */
        }

        .table-container::-webkit-scrollbar {
            width: 5px; /* Width of the scrollbar */
        }

        .table-container::-webkit-scrollbar-track {
            background:#edeef5; /* Track color */
        }

        .table-container::-webkit-scrollbar-thumb {
            background: #888; /* Scrollbar color */
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: #555; /* Hover color */
        }
        .form-label{
        	font-size: 0.9rem;
        }
       .centered-table th, .centered-table td {
	        text-align: center;
	        vertical-align: middle;
	    }
	    /* Custom select container */
		.select-container {
		  position: relative;
		  display: inline-block;
		}
		
		/* Hide default arrow */
		.select-container select {
		  appearance: none;
		  -webkit-appearance: none;
		  -moz-appearance: none;
		  background: transparent;
		  padding-right: 2.5rem; /* Adjust based on the size of the arrow */
		}
		#employeeTable th {
	        vertical-align: middle; /* Ensures consistent vertical alignment */
	        text-align:center;
	        background-color:#E9EAEC;
	       
	    }
		/* Custom arrow icon */
		.select-container::after {
		  content: "";
		  position: absolute;
		  top: 50%;
		  right: 0.5rem; /* Adjust based on the size of the arrow */
		  transform: translateY(-50%);
		  width: 2rem; /* Adjust based on the size of the arrow */
		  height: 0.8rem; /* Adjust based on the size of the arrow */
		  background: url('assets/img/down-arrow.png') no-repeat center center;
		  background-size: contain;
		  pointer-events: none;
		}
		
		/* Optional: Add focus style to the select element */
		.select-container select:focus {
		  outline: none;
		}
		/* Create a custom column class for 5 cards per row on large screens */
		@media (min-width: 1200px) {
		    .col-lg-2-4 {
		        flex: 0 0 20%; /* Set width to 20% */
		        max-width: 20%;
		    }
		}
		/* CSS for clickable card */
		.clickable-card {
		    transition: transform 0.2s ease, box-shadow 0.2s ease;
		}
		
		.clickable-card:hover {
		    transform: translateY(-5px);
		    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
		    text-decoration: none; /* Ensure no underline on hover */
		}
		
		/* Fullscreen overlay with dim background */
#loadingPopup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5); /* Dim background */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    font-family: Arial, sans-serif;
    color: white; /* Text color for better contrast */
}

/* Spinner animation */
.spinner {
    width: 50px;
    height: 50px;
    border: 6px solid rgba(255, 255, 255, 0.3); /* Semi-transparent border */
    border-top-color: white; /* Bright top border */
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

/* Loading text */
#loadingPopup p {
    margin-top: 20px;
    font-size: 18px;
    font-weight: bold;
    color: white;
}

/* Spinner keyframe animation */
@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}


.popup-container {
		     position: fixed;
		     top: 0;
		     left: 0;
		     width: 100%;
		     height: 100%;
		     background-color: rgba(0, 0, 0, 0.5);
		     display: flex;
		     justify-content: center;
		     align-items: center;
		     z-index: 1000;
		 }

		 .popup-content {
		     background: white;
		     min-width: 300px; /* Slightly wider minimum width */
		     max-width: 80%; /* Maximum width capped at 70% of the viewport */
		     width: 40%; /* Dynamically adjust based on content */
		     border-radius: 8px;
		     box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
		     padding: 10px;
		     text-align: left;
		 }

		 .popup-header {
		     display: flex;
		     justify-content: space-between;
		     align-items: center;
		     margin-bottom: 15px;
		 }

		 .popup-header h5 {
		     margin: 0;
		 }

		 .close-popup {
		     background: none;
		     border: none;
		     font-size: 1.5rem;
		     cursor: pointer;
		 }
		 .popup-body {
		     max-height: 300px; /* Keep height limited for overflow scenarios */
		     overflow-y: auto;
		 }

		 .popup-footer {
		     text-align: right;
		     margin-top: 15px;
		 }
		
		.list-item {
		    display: flex;
		    justify-content: space-between;
		    align-items: center;
		    border-bottom: 1px solid #ddd;
		}
		
		.list-item span {
		    flex-grow: 1; /* Allows the text to take available space */
		}
		#missingPunchDatesList{
			padding:8px 0;
		}
		
		.time-picker-container {
		    display: flex;
		    align-items: center;
		    gap: 10px;
		    opacity: 0;
		    transform: translateY(-10px);
		    transition: all 0.3s ease-in-out;
		}
		
  </style>
</head>

<body>

   <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center" th:if="${empDetailsByEmpId.deptId > 0}">

   <!--  <div class="app-branding" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="logo-icon" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				</div> --><!-- End Logo -->
	
		   <div class="d-flex align-items-center logo-container" style="width:45%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/userDashboard}>
				        <img class="d-none d-lg-block" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				    <!-- <i class="bi bi-chevron-double-left toggle-sidebar-btn" onclick="toggleIconRotation()"></i> -->
			</div>	
    <!--  <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div> --><!-- End Search Bar -->

       <!-- Include the header fragment -->
   <div th:replace="fragments/header :: header"></div>

  </header><!-- End Header -->
   
   <!-- =======Super Admin Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center" th:if="${empDetailsByEmpId.deptId == 0}">

    <div class="d-flex align-items-center logo-container" style="width:45%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/navbar}>
				        <img class="d-none d-lg-block" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				    <!-- <i class="bi bi-chevron-double-left toggle-sidebar-btn" onclick="toggleIconRotation()"></i> -->
	</div><!-- End Logo -->

    <!-- <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div> --><!-- End Search Bar -->

    <div th:replace="fragments/superAdminHeader :: header"></div>

  </header><!-- End Header -->

  <!-- ======= Sidebar ======= -->
  
<aside id="sidebar" class="sidebar">

    <ul class="sidebar-nav" id="sidebar-nav">
		 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/userDashboard}">
                <i class="bi bi-grid"></i>
                <span>Dashboard</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link " th:href="@{/navbar}">
		        <i class="bi bi-grid"></i>
		        <span>Dashboard</span>
		    </a>
	    </li>
	    <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
			<a class="nav-link" th:href="@{/Departmentdoc}">
				<i class="bi bi-journal-bookmark"></i>
				<span>MSPL DocVault</span>
			</a>
		</li>
		
		<li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
			<a class="nav-link" th:href="@{/Departmentdoc}">
				<i class="bi bi-journal-bookmark"></i>
				<span>MSPL DocVault</span>
			</a>
		</li>   
		<li class="nav-item" th:if="${session.permissions.dispatch && empDetailsByEmpId.deptId==0}">
            <a class="nav-link" th:href="@{/dispatchIframe}">
                <i class="bi bi-truck"></i>
                <span>Dispatched Details</span>
            </a>
        </li>
         <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link"  th:href="@{/viewAdminProfile(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-person"></i>
                 <span>My Profile</span>
            </a>
        </li>  
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/attendanceLive(email=${empDetailsByEmpId.email})}">
                <i class="bi bi-calendar3"></i>
                <span>Attendence</span>
            </a> 
        </li>      
       <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/groupMailId}">
                <i class="bi bi-telephone"></i>
                <span>Employee Contacts</span>
            </a>
        </li>
        <!-- <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link " th:href="@{/InterCommDetails}">
                <i class="bi bi-telephone"></i>
                <span>InterComm Details</span>
            </a>
        </li> -->
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/adminHoliday}">
                <i class="bi bi-calendar4-week"></i>
                <span>Holiday List</span>
            </a>
        </li>
        
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
		    <a class="nav-link active" th:href="@{/employee}">
		        <i class="bi bi-people"></i>	
		        <span>Employee</span>
		    </a>
	  </li> 
        
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminLeaves(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-card-text"></i>
                <span>Team Leaves</span>
            </a>
        </li> 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/events}">
                <i class="bi bi-megaphone"></i>
                <span>Announcement</span>
            </a>
        </li>              
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/asset}">
                <i class="bi bi-wallet"></i>
                <span>Assets</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/ongoingProject}">
                <i class="bi bi-card-heading"></i>
                <span>Projects</span>
            </a>
        </li>   
        <!--  <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminPayslip(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-file-text"></i>
                <span>Payslip</span>
            </a>
        </li>  -->    
         <!-- Loop through the permissions map -->
       <li class="nav-item" th:if="${permissions.interviewAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/moatIframe}">
                <i class="bi bi-vector-pen"></i>
                <span>Interview</span>
            </a>
        </li>
         <li class="nav-item new-feature" th:if="${empDetailsByEmpId.deptId>0}">
			    <a class="nav-link collapsed" data-bs-target="#presales-submenu" data-bs-toggle="collapse" href="#">
			        <i class="bi bi-layout-text-window-reverse"></i>
			        <span>Pre-sales</span>
			        <i class="bi bi-chevron-down ms-auto"></i>
			    </a> 
			    <ul id="presales-submenu" class="nav-content collapse" data-bs-parent="#sidebar-nav">
			        <li>
			            <a th:href="@{/crm}">
			                <i class="bi bi-circle"></i><span>Activity</span>
			            </a>
			        </li>
			        <li>
			            <a th:href="@{/deals}">
			                <i class="bi bi-circle"></i><span>Pipedrive</span>
			            </a>
			        </li>
			    </ul>
			</li>
        <li class="nav-item" th:if="${permissions.sales && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/sales}">
                <i class="bi bi-cart3"></i>
                <span>Sales</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.accountsAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/accounts}">
                <i class="bi bi-person-vcard"></i>
                <span>Accounts</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/store}">
                <i class="bi bi-shop-window"></i>
                <span>Store</span>
            </a>
        </li>
        
        
	    <!-- <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link" th:href="@{/attendanceLive(email=${empDetailsByEmpId.email})}">
                <i class="bi bi-calendar3"></i>
                <span>Attendence</span>
            </a>
        </li>  -->
         <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/adminHoliday}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Holiday List</span>
		    </a>
	 </li>	
	 
	<li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		     <a class="nav-link" th:href="@{/addInterComm}">
                <i class="bi bi-telephone"></i>
                <span>Communication</span>
            </a>
	 </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		     <a class="nav-link" th:href="@{/groupMailId}">
                <i class="bi bi-envelope-open"></i>
                <span>Group Mail Id</span>
            </a>
	 </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		<a class="nav-link" th:href="@{/hikeRatingForm}">
			<i class="bi bi-arrow-up-circle"></i><span>Appraisal Ratings</span>
		</a>
	</li>
	<li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		<a class="nav-link" th:href="@{/apprisalEmployee}">
			<i class="bi bi-check-square"></i><span>Submitted Appraisals</span>
		</a>
	</li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
          <a class="nav-link" href="hrActivity">
	        <i class="bi bi-file-lock"></i><span>Permissions</span>
	    </a>
      </li>
	  <!-- <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/InterCommDetails}">
                <i class="bi bi-telephone"></i>
                <span>InterComm Details</span>
            </a>
      </li> -->
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/viewAdminLeaves(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Employee Leaves</span>
		    </a>
	 </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/events}">
		        <i class="bi bi-megaphone"></i>
		        <span>Announcement</span>
		    </a>
	 </li> 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/addDepartment}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Department</span>
		    </a>
	   </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/addRole}">
		        <i class="bi bi-receipt"></i>
		        <span>Role</span>
		    </a>
	 </li>
	 
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:classappend="${empDetailsByEmpId.deptId==0} ? ' active'" th:href="@{/employee}">
		        <i class="bi bi-people"></i>
		        <span>Employee</span>
		    </a>
	 </li> 
	
       
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/ongoingProject}">
                <i class="bi bi-calendar3"></i>
                <span>Projects</span>
            </a>
      </li>  
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/asset}">
                <i class="bi bi-wallet"></i>
                <span>Assets</span>
            </a>
      </li> 
       <li class="nav-item" th:if="${permissions.interviewAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/moatIframe}">
                <i class="bi bi-vector-pen"></i>
                <span>Interview</span>
            </a>
        </li>
              <li class="nav-item new-feature" th:if="${empDetailsByEmpId.deptId==0}">
			    <a class="nav-link collapsed" data-bs-target="#interview-summary-submenu" data-bs-toggle="collapse" href="#">
			        <i class="bi bi-layout-text-window-reverse"></i>
			        <span>Interview Summary</span>
			        <i class="bi bi-chevron-down ms-auto"></i>
			    </a> 
			    <ul id="interview-summary-submenu" class="nav-content collapse" data-bs-parent="#sidebar-nav">
			        <li>
		            <a href="totalCandidatesList">
		              <i class="bi bi-circle"></i><span>Total Candidates</span>
			            </a>
			          </li>
			        <li>
		            <a href="selectedCandidatesList">
		              <i class="bi bi-circle"></i><span>Selected Candidates</span>
		            </a>
		          </li>
		          <li>
		            <a href="rejectedCandidatesList">
		              <i class="bi bi-circle"></i><span>Rejected Candidates</span>
		            </a>
		          </li>
			    </ul>
			</li>
         <li class="nav-item new-feature" th:if="${empDetailsByEmpId.deptId==0}">
			    <a class="nav-link collapsed" data-bs-target="#presales-submenu" data-bs-toggle="collapse" href="#">
			        <i class="bi bi-layout-text-window-reverse"></i>
			        <span>Pre-sales</span>
			        <i class="bi bi-chevron-down ms-auto"></i>
			    </a> 
			    <ul id="presales-submenu" class="nav-content collapse" data-bs-parent="#sidebar-nav">
			        <li>
			            <a th:href="@{/crm}">
			                <i class="bi bi-circle"></i><span>Activity</span>
			            </a>
			        </li>
			        <li>
			            <a th:href="@{/deals}">
			                <i class="bi bi-circle"></i><span>Pipedrive</span>
			            </a>
			        </li>
			    </ul>
			</li>
        <li class="nav-item" th:if="${permissions.sales && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/sales}">
                <i class="bi bi-cart3"></i>
                <span>Sales</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.accountsAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/accounts}">
                <i class="bi bi-person-vcard"></i>
                <span>Accounts</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/store}">
                <i class="bi bi-shop-window"></i>
                <span>Store</span>
            </a>
        </li>  
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
			    <a class="nav-link" href="feedbackReports">
			        <i class="bi bi-chat-square-text"></i>
			        <span>Feedback Reports</span>
			    </a>
		 </li>
        <li class="nav-item" th:if="${permissions.apprisalAccess}">
		    <a class="nav-link" id="apprisalLink" th:href="@{/apprisal(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-file-text"></i>
		        <span>Appraisal</span>
		    </a>
		</li>
		<li class="nav-item">
		    <a class="nav-link" id="apprisalLink" th:href="@{/employeeApprisal(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-file-text"></i>
		        <span>Employee Appraisal</span>
		    </a>
		</li>
		<li class="nav-item">
				<a class="nav-link" th:href="@{/my-favorites}">
					<i class="bi bi-layout-text-window-reverse"></i>
					<span>To-Chat & Remind</span><span id="unreadCountBadge" class="badge bg-primary" style="display: none;"></span>
				</a>
		</li>
		<li class="nav-item new-feature" >
					    <a class="nav-link" th:href="@{/releasenotes}">
					        <i class="bi bi-layout-text-window-reverse"></i>
					        <span class="release-note-text">
					            Release Note 
					            <span class="version-number">(Policy Update)</span>
					        </span>
					    </a>
		</li>
    </ul>
</aside>

  <!-- End Sidebar-->
<div id="loadingPopup">
    <div class="spinner"></div>
    <p>Loading, please wait...</p>
</div>

  <main id="main" class="main">
  
  <input type="hidden" id="loggedAdminEmpId2" th:value="${session.loggedAdminEmpId}">
  <input type="hidden" id="loggedAdminEmailId2" th:value="${session.email}">
  
  <div class="chat-app" style="display: none;">
                <div id="plist" class="people-list">
                        <div class="input-group mb-3">
                                <input type="text" id="searchInputModal" class="form-control" placeholder="Search..."
                                        aria-label="Search">
                                <span class="input-group-text">
                                        <i class="bi bi-search"></i>
                                </span>

                        </div>
                        <ul id="employeeNames" class="list-unstyled chat-list mt-2 mb-0">
                                <!-- Employee names will be dynamically populated here -->
                        </ul>
                </div>

                <div class="chat">
                        <div class="chat-header clearfix">
                                <div class="row w-100">

                                        <!-- Employee Photo and Name Section -->
                                        <div class="col-lg-6 d-flex align-items-center">
                                                <div class="chat-about d-flex align-items-center">
                                                        <img id="employeePhoto" class="employee-photo" src="default-avatar.png"
                                                                alt="Employee Photo" />
                                                        <h6 class="m-b-0 ml-2" id="employeeName">Select an Employee</h6>
                                                </div>
                                        </div>
                                        <!-- Right aligned three dots (Vertical) -->
                                        <div class="col-lg-6 text-right">
                                                <div class="dropdown custom-dropdown">
                                                        <button class="btn btn-outline-secondary" type="button" id="dropdownMenuButton"
                                                                data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="fa fa-ellipsis-v"></i>
                                                        </button>
                                                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
                                                                <li><a class="dropdown-item" href="#">Delete Chat</a></li>
                                                                <li><a class="dropdown-item" href="#">Mute</a></li>
                                                                <li><a class="dropdown-item" href="#">Contact Info</a></li>
                                                        </ul>
                                                </div>
                                        </div>
                                </div>
                        </div>
                        <div id="chat-window" class="chat-history">
                                <ul class="m-b-0">
                                        <!-- Chat messages will be populated here dynamically -->

                                </ul>
                                <div id="message-icon-container" class="message-icon" style="display: none;">

                                        <!-- Plain square message icon SVG (behind) -->
                                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                                <g id="SVGRepo_iconCarrier">
                                                        <path
                                                                d="M10 9H17M10 13H17M7 9H7.01M7 13H7.01M21 20L17.6757 18.3378C17.4237 18.2118 17.2977 18.1488 17.1656 18.1044C17.0484 18.065 16.9277 18.0365 16.8052 18.0193C16.6672 18 16.5263 18 16.2446 18H6.2C5.07989 18 4.51984 18 4.09202 17.782C3.71569 17.5903 3.40973 17.2843 3.21799 16.908C3 16.4802 3 15.9201 3 14.8V7.2C3 6.07989 3 5.51984 3.21799 5.09202C3.40973 4.71569 3.71569 4.40973 4.09202 4.21799C4.51984 4 5.0799 4 6.2 4H17.8C18.9201 4 19.4802 4 19.908 4.21799C20.2843 4.40973 20.5903 4.71569 20.782 5.09202C21 5.51984 21 6.0799 21 7.2V20Z"
                                                                stroke="#94b7db" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                </g>
                                        </svg>

                                        <!-- SVG with animation -->
                                        <svg class="animated-icon" viewBox="0 0 374 374" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <g clip-path="url(#clip0)">
                                                        <path
                                                                d="M318.084 132.622C311.339 101.37 287.642 82 256.652 82C238.423 82 217.459 89.3248 197.954 102.509C191.574 106.904 182.642 106.904 176.079 102.672C155.298 88.9992 135.246 82 116.652 82C85.6626 82 61.9647 101.533 55.2199 133.111C44.2824 183.896 80.923 252.26 187.017 291C292.746 251.446 329.204 183.082 318.084 132.622Z" />
                                                        <path
                                                                d="M187.466 0C187.366 0 187.166 0 186.866 0C85.666 0 3.36603 82.3 3.36603 183.5C3.36603 224.8 17.466 264.9 43.266 297.2L16.566 359.3C14.366 364.4 16.766 370.3 21.766 372.4C23.566 373.2 25.566 373.4 27.466 373.1L125.366 355.9C144.966 363 165.566 366.6 186.366 366.5C287.566 366.5 369.866 284.2 369.866 183C370.066 82.1 288.366 0.1 187.466 0ZM192.966 269.8C188.966 271.3 184.666 271.3 180.666 269.8C149.066 257.1 124.466 238.3 109.466 215.4C95.966 194.7 90.766 171.4 94.866 149.9C100.466 121.4 121.866 102.3 148.266 102.3C160.966 102.3 173.866 106.5 186.766 114.7C199.366 106.5 212.466 102.3 225.066 102.3C251.866 102.3 272.866 120.9 278.466 149.6C286.066 188.8 262.666 241.3 192.966 269.8Z" />
                                                </g>
                                                <defs>
                                                        <clipPath id="clip0">
                                                                <rect width="373.232" height="373.232" fill="white" />
                                                        </clipPath>
                                                </defs>
                                        </svg>



                                        <!-- Dots Animation -->
                                        <div class="dots">
                                                <div class="dot"></div>
                                                <div class="dot"></div>
                                                <div class="dot"></div>
                                        </div>




                                </div>


                        </div>
                        <!-- Move the paragraph outside the chat window -->
                        <p id="logo-text"
                                style="text-align: center; font-size: 14px; color: #6c757d; margin-top: 10px; display: none;">
                                "Reach out to your colleagues and stay on top of your projects with quick, seamless communication."
                        </p>
                        <div class="chat-message clearfix">
                                <div class="custom-input-group mb-0">
                                        <input type="text" id="message" class="custom-form-control" placeholder="Enter your message..." />
                                        <div class="custom-input-group-append">
                                                <button class="custom-send-btn" onclick="sendMessage()">
                                                        <i class="ri ri-send-plane-2-fill"></i>
                                                </button>
                                        </div>
                                </div>

                        </div>
                </div>
        </div>
        <input type="hidden" th:value="${empDetailsByEmpId.email}" id="loggedInMail">
		<input type="hidden" id="employeeId1" name="empId" th:value="${empDetailsByEmpId.empid}" />
        <input type="hidden" id="emp_idSessionValue" th:value="${empDetailsByEmpId.empid}">
	    <input type="hidden" id="loggedEmpEmail" th:value="${empDetailsByEmpId.email}">
	    
	    <div class="attendanceListsOuterDiv" id="attendanceListsOuterDiv">
	 <div class="attendanceListsInnerBox">
		<p class="emailFormInnerBoxCloser" style="margin-bottom: 0;"><span onclick="closeAttendanceListsOuterDiv();">&times;</span></p>
		<p style="font-size: 15px; padding-left: 20px; font-weight: bold;">Filter Employee Attendance</p>
		
		<div style="display: flex; justify-content:flex-start; gap: 20px; margin-top: 20px; width: 90%; margin-left: auto; margin-right: auto;">
			<div>
				<input class="form-check-input border border-primary attendanceFilterType" onclick="attendanceFilterTypeChosen(this.value);" checked="checked" value="allAttendance" type="radio" name="attendanceFilterType"><label style="padding-left: 4px; font-weight: bold;">Filter All</label>
		    </div>
		    <div>
				<input class="form-check-input border border-primary attendanceFilterType" onclick="attendanceFilterTypeChosen(this.value);" value="attendanceByEmpName" type="radio" name="attendanceFilterType"><label style="padding-left: 4px; font-weight: bold;">Filter by Employee Name</label>
		    </div>
		</div>
	
		<div style="padding: 10px; width: 90%; margin-left: auto; margin-right: auto; margin-top: 10px;" id="filterAllAttendanceBox">
			<div class="employeeAttendnaceTextFieldsMerger">
				<div class="employeeAttendnaceTextFieldBox">
					<label class="customLabel">From Date</label>
					<input type="date" class="form-control" id="attendanceFilterFromDate" style="font-size: 14px;">
				</div>
				
				<div class="employeeAttendnaceTextFieldBox">
					<label class="customLabel">To Date</label>
					<input type="date" class="form-control" id="attendanceFilterToDate" style="font-size: 14px;">
				</div>
				
				<!-- <div style="width: 30%">
					<label class="customLabel">Select Month and Year</label>
					<input type="month" class="form-control" id="attendanceFilterMonthANdYear" style="font-size: 14px;">
				</div> -->
				
				<div class="employeeAttendnaceButtonBox">
					<input type="button" class="btn btn-outline-success" id="attendanceFilterSubmitBtn" onclick="fetchAllAttendanceReport($('#attendanceFilterFromDate').val(), $('#attendanceFilterToDate').val())" value="Export Excel" style="font-size: 14px;">
				</div>
			</div>
		</div>
		
		<div style="padding: 10px; width: 90%; margin-left: auto; margin-right: auto; margin-top: 10px; display: none;" id="filterAttendanceByEmpNameBox">
			<div class="employeeAttendnaceTextFieldsMerger2">
				<div class="employeeAttendnaceTextFieldBox2">
					<label class="customLabel">Department</label>
					<select style="font-size: 14px;" id="attendanceReportDepatmentListDropdown" class="form-select custom-select browser-default custom_selectfield" onchange="updateEmpNameBasedOnDeptName(this.value)">
				        <option value="" selected>Select Department</option>
				        <option th:each="dept : ${departments}" th:value="${dept.deptName}" th:text="${dept.deptName}"></option>
				    </select>
				</div>
				
				<div class="employeeAttendnaceTextFieldBox2">
					<label class="customLabel">Employee Name</label>
					<select style="font-size: 14px;" class="form-select custom-select browser-default custom_selectfield" id="attendanceFilterEmpName"></select>
				</div>
			
				<div class="employeeAttendnaceTextFieldBox2">
					<label class="customLabel">From Date</label>
					<input type="date" class="form-control" id="attendanceFilterFromDate2" style="font-size: 14px;">
				</div>
				
				<div class="employeeAttendnaceTextFieldBox2">
					<label class="customLabel">To Date</label>
					<input type="date" class="form-control" id="attendanceFilterToDate2" style="font-size: 14px;">
				</div>
				
				<!-- <div style="width: 30%">
					<label class="customLabel">Select Month and Year</label>
					<input type="month" class="form-control" id="attendanceFilterMonthANdYear2" style="font-size: 14px;">
				</div> -->
				
				<div class="employeeAttendnaceButtonBox2">
					<input type="button" class="btn btn-outline-success" id="attendanceFilterSubmitBtn2" onclick="fetchAttendanceReportBasedOnEmpId($('#attendanceFilterEmpName').val(), $('#attendanceFilterFromDate2').val(), $('#attendanceFilterToDate2').val())" value="Export Excel" style="font-size: 14px;">
				</div>
			</div>
		</div>
		
			<!-- <div class="attendanceReportTableBox mt-4" id="attendanceReportTableBox" style="display: none;"></div> -->
		</div>
	</div>
          
		<div th:if="${message}" class="alert alert-success alert-dismissible fade show" role="alert">
                <span th:text=${message}></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                <span th:text=${error}></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
  
    <div class="pagetitle d-flex mb-0"   th:if="${empDetailsByEmpId.deptId>0}">
    
	     <i class="bi bi-chevron-double-left toggle-sidebar-btn mb-1" onclick="toggleIconRotation()" style="font-size:24px;color:#2F73B9;padding:0 10px;margin-left:-10px;margin-top:-10px"></i>
      
		      <nav>
		        <ol class="breadcrumb">
		          <li class="breadcrumb-item"><a th:href="@{/userDashboard}">Home</a></li>
		          <li class="breadcrumb-item active">Employees</li>
		        </ol>
		      </nav>
	       
    </div><!-- End Page Title -->
	<div class="pagetitle d-flex"   th:if="${empDetailsByEmpId.deptId==0}">
	       <i class="bi bi-chevron-double-left toggle-sidebar-btn mb-1" onclick="toggleIconRotation()" style="font-size:24px;color:#2F73B9;padding:0 10px;margin-left:-10px;margin-top:-10px"></i>
      
		      <nav>
		        <ol class="breadcrumb">
		          <li class="breadcrumb-item"><a th:href="@{/navbar}">Home</a></li>
		          <li class="breadcrumb-item active">Employees</li>
		        </ol>
		      </nav>
    </div><!-- End Page Title -->
    
    <div class="leaveBalanceListsOuterDiv" id="leaveBalanceListsOuterDiv">
	 <div class="leaveBalanceListsInnerBox">
		<p class="emailFormInnerBoxCloser" style="margin-bottom: 0;"><span onclick="closeLeaveBalanceListsOuterDiv();">&times;</span></p>
		
			<div class="d-flex justify-content-between align-items-center">
             	<p style="font-size: 15px; padding-left: 20px; font-weight: bold;">Leave Balance Details</p>
			      
			      <div class="d-flex justify-content-between align-items-center" style="gap: 10px;">
               		<div class="search-box mx-2">
				        <button class="btn-search3" title="Search"><i class="bi bi-search"></i></button>
				        <input type="text" oninput="searchTableForLeaveBalance();" class="input-search3" placeholder="Search...">
				     </div>
               	
              	 	<button style="font-size: 14px; margin-right: 20px;" onclick="openLeaveBalanceUpdateOuterDiv();" class="btn btn-outline-primary">Update Leave Balance</button>
              	</div>
            </div>
		
			<div class="custom_table_div mt-3">
				<table id="holidayTable" style="font-size: 14px;" class="table table-hover mb-0 text-center">
				    <thead class="fixTHead" style="position: sticky; top: 0;">
				        <tr>
				            <th rowspan="2">SL No</th>
				            <th rowspan="2">Employee Id</th>
				            <th rowspan="2">Employee Name</th>
				            <th rowspan="2">Email</th>
				            <th rowspan="2">Department</th>
				            <th rowspan="2">Designation</th>
				            <th colspan="4">Leave Type</th>
				        </tr>
				        <tr>
				        	<th>Sick Leave</th>
				            <th>Casual Leave</th>
				            <th>Earned Leave</th>
				            <th>Maternity Leave</th>
				        </tr>
				    </thead>
				    <tbody class="tableSearch3" id="viewLeaveBalanceDetailsTBody"></tbody>
				</table>
			</div>
		</div>
	</div>
	
	<div class="leaveBalanceUpdateOuterDiv" id="leaveBalanceUpdateOuterDiv">
	 <div class="leaveBalanceUpdateInnerBox">
		
		<div class="d-flex justify-content-between align-items-center mb-2">
           <p style="font-size: 14px; font-weight: bold; margin: 0; padding-left: 15px;">Update Leave Balance</p>
           <p class="emailFormInnerBoxCloser" style=" margin: 0;"><span onclick="closeLeaveBalanceUpdateOuterDiv();">&times;</span></p>
        </div>
        
		<div class="row jumbotron align-items-center mb-3" style="font-size: 14px; width: 96%; margin-left: auto; margin-right: auto;">
			<div class="col-sm-6 form-group">
				<label class="customLabel">Department</label>
				<select style="font-size: 14px;" id="updateLeaveBalanceDepatmentListDropdown" class="form-select custom-select browser-default custom_selectfield" onchange="updateEmpNameBasedOnDeptName(this.value)">
			        <option value="" selected>Select Department</option>
			        <option th:each="dept : ${departments}" th:value="${dept.deptName}" th:text="${dept.deptName}"></option>
			    </select>
			</div>
			
			<div class="col-sm-6 form-group">
				<label class="customLabel">Employee Name</label>
				<select style="font-size: 14px;" class="form-select custom-select browser-default custom_selectfield" 
					onchange="fetchLeaveBalanceForClickedEmployeeIdInLeaveBalanceUpdatePopup(this.value);" id="updateLeaveBalancePopupEmpName"></select>
			</div>
		</div>
		
		<div class="row jumbotron align-items-center mb-3 p-1" id="updateLeaveBalancePopupLeaveDetailsBox" style="background: #ccd1d1; font-size: 14px; width: 90%; margin-left: auto; margin-right: auto; border-radius: 5px; display: none;">
			<p class="row jumbotron align-items-center" style="font-size: 14px; width: 60%; margin: 0 auto;">
				<span class="col-sm-3 form-group d-flex align-items-center">
					<label><b>SL:</b></label><span style="padding-left: 5px;" id="slRemainingSpanPopup"></span>
				</span>
				<span class="col-sm-3 form-group d-flex align-items-center">
					<label><b>CL:</b></label><span style="padding-left: 5px;" id="clRemainingSpanPopup"></span>
				</span>
				<span class="col-sm-3 form-group d-flex align-items-center">
					<label><b>EL:</b></label><span style="padding-left: 5px;" id="elRemainingSpanPopup"></span>
				</span>
			</p>
		</div>
		
		<div class="row jumbotron align-items-center mb-2" id="updateLeaveBalancePopupLeaveTypeBox" style="font-size: 14px; width: 90%; margin-left: auto; margin-right: auto; display: none;">
			<!-- <div style="width: 40%; padding: 5px;">
				<label class="customLabel mb-2"><b>Select Leave Type</b></label>
				<div class="form-check">
				  <input class="form-check-input" onchange="displayUpdateLeaveBalanceForm(this.id)" type="radio" style="border: 1px solid #85c1e9;" name="leaveTypeInLeaveUpdate" id="sl_Radio_button">
				  <label class="form-check-label" for="sl_Radio_button">Sick Leave</label>
				</div>
				<div class="form-check">
				  <input class="form-check-input" onchange="displayUpdateLeaveBalanceForm(this.id)" type="radio" style="border: 1px solid #85c1e9;" name="leaveTypeInLeaveUpdate" id="cl_Radio_button">
				  <label class="form-check-label" for="cl_Radio_button">Casual Leave</label>
				</div>
				<div class="form-check">
				  <input class="form-check-input" onchange="displayUpdateLeaveBalanceForm(this.id)" type="radio" style="border: 1px solid #85c1e9;" name="leaveTypeInLeaveUpdate" id="el_Radio_button">
				  <label class="form-check-label" for="el_Radio_button">Earned Leave</label>
				</div>
			</div> -->
			
			<div id="updateLeaveBalanceFormBox" style="width: 100%;">
				<div class="row jumbotron align-items-center mb-2" id="updateLeaveBalanceFormInnerBox">
					<div class="leaveBalanceUpdateListDiv" id="updateSickLeaveBalanceBox">
						<label>Sick Leave</label>
						<input type="number" min="0" style="font-size: 14px;" class="form-control" id="sick_leave_updated_balance">
					</div>
					<div class="leaveBalanceUpdateListDiv" id="updateCasualLeaveBalanceBox">
						<label>Casual Leave</label>
						<input type="number" min="0" style="font-size: 14px;" class="form-control" id="casual_leave_updated_balance">
					</div>
					<div class="leaveBalanceUpdateListDiv" id="updateEarnedLeaveBalanceBox">
						<label>Earned Leave</label>
						<input type="number" min="0" style="font-size: 14px;" class="form-control" id="earned_leave_updated_balance">
					</div>
				</div>
				
				<div class="row jumbotron align-items-center mb-3" id="reasonForAddingLeaveBalanceBox">
					<label>Reason for Adding Leave Balance</label>
					<div style="padding-left: 3%;">
						<textarea class="form-control" style="font-size: 14px;" id="reason_for_adding_LeaveBalance" rows="2"></textarea>
					</div>
				</div>
				
				<button style="font-size: 14px; float: right; margin-right: 4px;" disabled="disabled" id="updateLeaveBalancePopupBtn" onclick="updateLeaveBalanceToBackend($('#sick_leave_updated_balance').val(), $('#casual_leave_updated_balance').val(), $('#earned_leave_updated_balance').val(), $('#reason_for_adding_LeaveBalance').val())" class="btn btn-outline-primary">Update</button>
			</div>
		</div>
		
	</div>
</div>
    
    <section class="section dashboard">
      <div class="row">

        <!-- Left side columns -->
        <!-- <div class="col-lg-8">
          <div class="row">
		  <div class="col-lg-12">

          <div class="card">
		    <div class="card-body">
		        <h5 class="card-title">Employees List</h5>
		        Small tables
		        <div class="table-container">
		          <table class="table table-sm" style="font-size: 0.9rem;">
				    <thead>
				        <tr>
				            <th scope="col">#</th>
				            <th scope="col">Role Name</th>
				            <th scope="col">Department</th>
				            <th scope="col">Role Description</th>
				            <th scope="col">Action</th>
				        </tr>
				    </thead>
				    <tbody>
				        Iterating over departments using Thymeleaf
				        <tr th:each="role, iterStat : ${roles}">
				            <th scope="row" th:text="${iterStat.count}">1</th>
				            <td th:text="${role.roleName}">Role Name</td>
				            <td th:text="${role.deptName}">Department Name</td>
				            <td th:text="${role.description}">Role Description</td>
				            <td colspan=2> Flexbox for horizontal alignment
				                <a href="#" class="text-primary" title="Edit">
				                    <i class="bi bi-pencil-square"></i>
				                </a>&nbsp;
				                <a href="#" class="text-danger" title="Delete">
				                    <i class="bi bi-trash"></i>
				                </a>
				            </td>
				        </tr>
				    </tbody>
				</table>
		        </div>
		        End small tables
		    </div>
</div> -->


          <!-- <div class="card">
            <div class="card-body">
              <h5 class="card-title">No Labels / Placeholders as labels Form</h5>

              No Labels Form
              <form class="row g-3">
                <div class="col-md-12">
                  <input type="text" class="form-control" placeholder="Your Name">
                </div>
                <div class="col-md-6">
                  <input type="email" class="form-control" placeholder="Email">
                </div>
                <div class="col-md-6">
                  <input type="password" class="form-control" placeholder="Password">
                </div>
                <div class="col-12">
                  <input type="text" class="form-control" placeholder="Address">
                </div>
                <div class="col-md-6">
                  <input type="text" class="form-control" placeholder="City">
                </div>
                <div class="col-md-4">
                  <select id="inputState" class="form-select">
                    <option selected>Choose...</option>
                    <option>...</option>
                  </select>
                </div>
                <div class="col-md-2">
                  <input type="text" class="form-control" placeholder="Zip">
                </div>
                <div class="text-center">
                  <button type="submit" class="btn btn-primary">Submit</button>
                  <button type="reset" class="btn btn-secondary">Reset</button>
                </div>
              </form>End No Labels Form

            </div>
          </div> -->

          <!-- <div class="card">
            <div class="card-body">
              <h5 class="card-title">Floating labels Form</h5>

              Floating Labels Form
              <form class="row g-3">
                <div class="col-md-12">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingName" placeholder="Your Name">
                    <label for="floatingName">Your Name</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating">
                    <input type="email" class="form-control" id="floatingEmail" placeholder="Your Email">
                    <label for="floatingEmail">Your Email</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating">
                    <input type="password" class="form-control" id="floatingPassword" placeholder="Password">
                    <label for="floatingPassword">Password</label>
                  </div>
                </div>
                <div class="col-12">
                  <div class="form-floating">
                    <textarea class="form-control" placeholder="Address" id="floatingTextarea" style="height: 100px;"></textarea>
                    <label for="floatingTextarea">Address</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="col-md-12">
                    <div class="form-floating">
                      <input type="text" class="form-control" id="floatingCity" placeholder="City">
                      <label for="floatingCity">City</label>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-floating mb-3">
                    <select class="form-select" id="floatingSelect" aria-label="State">
                      <option selected>New York</option>
                      <option value="1">Oregon</option>
                      <option value="2">DC</option>
                    </select>
                    <label for="floatingSelect">State</label>
                  </div>
                </div>
                <div class="col-md-2">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingZip" placeholder="Zip">
                    <label for="floatingZip">Zip</label>
                  </div>
                </div>
                <div class="text-center">
                  <button type="submit" class="btn btn-primary">Submit</button>
                  <button type="reset" class="btn btn-secondary">Reset</button>
                </div>
              </form>End floating Labels Form

            </div>
          </div> -->

        </div>
            <!-- Sales Card -->
            <!-- <div class="col-xxl-4 col-md-6">
              <div class="card info-card sales-card">

                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body">
                  <h5 class="card-title">Sales <span>| Today</span></h5>

                  <div class="d-flex align-items-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <i class="bi bi-cart"></i>
                    </div>
                    <div class="ps-3">
                      <h6>145</h6>
                      <span class="text-success small pt-1 fw-bold">12%</span> <span class="text-muted small pt-2 ps-1">increase</span>

                    </div>
                  </div>
                </div>

              </div>
            </div> --><!-- End Sales Card -->

            <!-- Revenue Card -->
            <!-- <div class="col-xxl-4 col-md-6">
              <div class="card info-card revenue-card">

                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body">
                  <h5 class="card-title">Revenue <span>| This Month</span></h5>

                  <div class="d-flex align-items-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <i class="bi bi-currency-dollar"></i>
                    </div>
                    <div class="ps-3">
                      <h6>$3,264</h6>
                      <span class="text-success small pt-1 fw-bold">8%</span> <span class="text-muted small pt-2 ps-1">increase</span>

                    </div>
                  </div>
                </div>

              </div>
            </div> --><!-- End Revenue Card -->

            <!-- Customers Card -->
            <!-- <div class="col-xxl-4 col-xl-12">

              <div class="card info-card customers-card">

                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body">
                  <h5 class="card-title">Customers <span>| This Year</span></h5>

                  <div class="d-flex align-items-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <i class="bi bi-people"></i>
                    </div>
                    <div class="ps-3">
                      <h6>1244</h6>
                      <span class="text-danger small pt-1 fw-bold">12%</span> <span class="text-muted small pt-2 ps-1">decrease</span>

                    </div>
                  </div>

                </div>
              </div>

            </div> --><!-- End Customers Card -->

            <!-- Reports -->
            <!-- <div class="col-12">
              <div class="card">

                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body">
                  <h5 class="card-title">Reports <span>/Today</span></h5>

                  Line Chart
                  <div id="reportsChart"></div>

                  <script>
                    document.addEventListener("DOMContentLoaded", () => {
                      new ApexCharts(document.querySelector("#reportsChart"), {
                        series: [{
                          name: 'Sales',
                          data: [31, 40, 28, 51, 42, 82, 56],
                        }, {
                          name: 'Revenue',
                          data: [11, 32, 45, 32, 34, 52, 41]
                        }, {
                          name: 'Customers',
                          data: [15, 11, 32, 18, 9, 24, 11]
                        }],
                        chart: {
                          height: 350,
                          type: 'area',
                          toolbar: {
                            show: false
                          },
                        },
                        markers: {
                          size: 4
                        },
                        colors: ['#4154f1', '#2eca6a', '#ff771d'],
                        fill: {
                          type: "gradient",
                          gradient: {
                            shadeIntensity: 1,
                            opacityFrom: 0.3,
                            opacityTo: 0.4,
                            stops: [0, 90, 100]
                          }
                        },
                        dataLabels: {
                          enabled: false
                        },
                        stroke: {
                          curve: 'smooth',
                          width: 2
                        },
                        xaxis: {
                          type: 'datetime',
                          categories: ["2018-09-19T00:00:00.000Z", "2018-09-19T01:30:00.000Z", "2018-09-19T02:30:00.000Z", "2018-09-19T03:30:00.000Z", "2018-09-19T04:30:00.000Z", "2018-09-19T05:30:00.000Z", "2018-09-19T06:30:00.000Z"]
                        },
                        tooltip: {
                          x: {
                            format: 'dd/MM/yy HH:mm'
                          },
                        }
                      }).render();
                    });
                  </script>
                  End Line Chart

                </div>

              </div>
            </div> --><!-- End Reports -->

            <!-- Recent Sales -->
            <!-- <div class="col-12">
              <div class="card recent-sales overflow-auto">

                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body">
                  <h5 class="card-title">Recent Sales <span>| Today</span></h5>

                  <table class="table table-borderless datatable">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Customer</th>
                        <th scope="col">Product</th>
                        <th scope="col">Price</th>
                        <th scope="col">Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row"><a href="#">#2457</a></th>
                        <td>Brandon Jacob</td>
                        <td><a href="#" class="text-primary">At praesentium minu</a></td>
                        <td>$64</td>
                        <td><span class="badge bg-success">Approved</span></td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#">#2147</a></th>
                        <td>Bridie Kessler</td>
                        <td><a href="#" class="text-primary">Blanditiis dolor omnis similique</a></td>
                        <td>$47</td>
                        <td><span class="badge bg-warning">Pending</span></td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#">#2049</a></th>
                        <td>Ashleigh Langosh</td>
                        <td><a href="#" class="text-primary">At recusandae consectetur</a></td>
                        <td>$147</td>
                        <td><span class="badge bg-success">Approved</span></td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#">#2644</a></th>
                        <td>Angus Grady</td>
                        <td><a href="#" class="text-primar">Ut voluptatem id earum et</a></td>
                        <td>$67</td>
                        <td><span class="badge bg-danger">Rejected</span></td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#">#2644</a></th>
                        <td>Raheem Lehner</td>
                        <td><a href="#" class="text-primary">Sunt similique distinctio</a></td>
                        <td>$165</td>
                        <td><span class="badge bg-success">Approved</span></td>
                      </tr>
                    </tbody>
                  </table>

                </div>

              </div>
            </div> --><!-- End Recent Sales -->

            <!-- Top Selling -->
            <!-- <div class="col-12">
              <div class="card top-selling overflow-auto">

                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>

                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>

                <div class="card-body pb-0">
                  <h5 class="card-title">Top Selling <span>| Today</span></h5>

                  <table class="table table-borderless">
                    <thead>
                      <tr>
                        <th scope="col">Preview</th>
                        <th scope="col">Product</th>
                        <th scope="col">Price</th>
                        <th scope="col">Sold</th>
                        <th scope="col">Revenue</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row"><a href="#"><img src="assets/img/product-1.jpg" alt=""></a></th>
                        <td><a href="#" class="text-primary fw-bold">Ut inventore ipsa voluptas nulla</a></td>
                        <td>$64</td>
                        <td class="fw-bold">124</td>
                        <td>$5,828</td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#"><img src="assets/img/product-2.jpg" alt=""></a></th>
                        <td><a href="#" class="text-primary fw-bold">Exercitationem similique doloremque</a></td>
                        <td>$46</td>
                        <td class="fw-bold">98</td>
                        <td>$4,508</td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#"><img src="assets/img/product-3.jpg" alt=""></a></th>
                        <td><a href="#" class="text-primary fw-bold">Doloribus nisi exercitationem</a></td>
                        <td>$59</td>
                        <td class="fw-bold">74</td>
                        <td>$4,366</td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#"><img src="assets/img/product-4.jpg" alt=""></a></th>
                        <td><a href="#" class="text-primary fw-bold">Officiis quaerat sint rerum error</a></td>
                        <td>$32</td>
                        <td class="fw-bold">63</td>
                        <td>$2,016</td>
                      </tr>
                      <tr>
                        <th scope="row"><a href="#"><img src="assets/img/product-5.jpg" alt=""></a></th>
                        <td><a href="#" class="text-primary fw-bold">Sit unde debitis delectus repellendus</a></td>
                        <td>$79</td>
                        <td class="fw-bold">41</td>
                        <td>$3,239</td>
                      </tr>
                    </tbody>
                  </table>

                </div>

              </div>
            </div> --><!-- End Top Selling -->
          </div>
        </div><!-- End Left side columns -->
		
						<!-- Feedback Modal -->
						<input type="hidden" id="loggedInDeptName" th:value="${empDetailsByEmpId.deptName}">
			<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
			    <div class="modal-dialog">
			        <div class="modal-content rounded-4 shadow-lg">
			            <div class="modal-header border-0">
			                <h5 class="modal-title" id="feedbackModalLabel">Feedback Form</h5>
			                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			            </div>
			            <div class="modal-body">
			                <form id="feedbackForm" method="post" enctype="multipart/form-data">
			                    <div class="mb-3" style="display: none;">
			                        <label for="feedbackName" class="form-label fw-bold">Your Name</label>
			                        <input type="text" class="form-control" id="feedbackName" name="name" th:value="${empDetailsByEmpId.fullName}" readonly>
			                    </div>
			                    <div class="mb-3" style="display: none;">
			                        <label for="feedbackEmail" class="form-label fw-bold">Your Email</label>
			                        <input type="email" class="form-control" id="feedbackEmail" name="email" th:value="${empDetailsByEmpId.email}" readonly>
			                    </div>
			                    <div class="mb-3">
			                        <label for="feedbackEmailyy" class="form-label fw-bold">To</label>
			                        <div class="to-field-container">
			                            <span class="to-field rounded-pill px-3 py-2 shadow-sm">bugs_msplconnect@melangesystems.com</span>
			                        </div>
			                    </div>
								<div class="mb-3">
								    <label for="bugType" class="form-label fw-bold">Bug Type</label>
								    <select class="form-control" id="bugType" name="bugType" required>
								        <option value="About Application">About Application</option>
								        <option value="New Feature">New Feature</option>
								    </select>
								</div>

			                    <div class="mb-3">
			                        <label for="feedbackMessage" class="form-label fw-bold">Message</label>
			                        <textarea class="form-control" id="feedbackMessage" name="message" rows="4" placeholder="Enter your feedback here..." required></textarea>
			                    </div>
			                    <div class="mb-3">
			                        <label for="feedbackAttachment" class="form-label fw-bold">Attachment (optional)</label>
			                        <input type="file" class="form-control" id="feedbackAttachment" name="attachment" accept=".png, .jpg, .jpeg" multiple>
			                        <small class="text-muted">Max size: 5MB. You can upload multiple images.</small>
			                    </div>
			                    <button type="submit" class="btn btn-primary w-100 mt-3 py-2 shadow-sm" id="submitFeedbackBtn">Submit Feedback</button>
			                </form>
			            </div>
			        </div>
			    </div>
			</div>
			
			<div class="permissionListsOuterDiv" id="permissionListsOuterDiv">
	 <div class="permissionListsInnerBox">
		<p class="emailFormInnerBoxCloser" style="margin-bottom: 0;"><span onclick="closePermissionListsOuterDiv();">&times;</span></p>
		
		<div class="d-flex justify-content-between align-items-center">
             <p style="font-size: 15px; padding-left: 20px; font-weight: bold;">Permission Lists</p>
              <div class="search-box mx-5">
			     <button class="btn-search4" title="Search"><i class="bi bi-search"></i></button>
			     <input type="text" oninput="searchTableForPermissionList();" class="input-search4" placeholder="Search...">
			   </div>
         </div>
		
			<div class="custom_table_div mt-3">
				<table id="holidayTable" style="font-size: 14px;" class="table table-hover mb-0 text-center">
				    <thead class="fixTHead" style="position: sticky; top: 0;">
				        <tr>
				            <th rowspan="2">SL No</th>
				            <th rowspan="2">Employee Id</th>
				            <th rowspan="2">Employee Name</th>
				            <th colspan="7">Permissions</th>
				        </tr>
				        <tr>
				            <th>Interview</th>
				            <th>Pre-Sales</th>
				            <th>Sales</th>
				            <th>Store</th>
				            <th>Accounts</th>
				            <th>MSPL Attendance</th>
				            <th>Appraisal</th>
				            <!-- <th>Others</th> -->
				        </tr>
				    </thead>
				    <tbody class="tableSearch4" id="viewPermissionDetailsTBody"></tbody>
				</table>
			</div>
		</div>
	</div>
	
	
	<div class="filterDetails_outerBox" id="filterDetails_outerBox">
	<div class="marksDetails_outerBox_closeBox" style="display: flex; align-items: center; justify-content: space-between; padding-right: 30px;">
		<div class="filterBoxHeadingMerger">
			<span class="close_FilterDetails_outerBox_span" onclick="closeFilterPopup();">&times;</span>
			<!-- <label style="padding-left: 280px; font-size: 18px; font-weight: bold;">Filter <i class="bi bi-funnel-fill"></i></label> -->
			
			<div style="padding-left: 200px;">
				<select class="form-select custom-select browser-default" id="filterTypeOptions" onchange="displayAttendanceFilterPopup(this.value);" style="font-size: 14px;">
					<option style="font-size: 14px;" value="Employee Data">Employee Data</option>
					<option style="font-size: 14px;" value="Employee Attendance">Employee Attendance</option>
				</select>
			</div>
			<i style="padding-left: 5px; font-size: 20px; font-weight: bold;" class="bi bi-funnel-fill innerFilterIcon"></i>
		</div>
		
		<i class="bi bi-arrow-counterclockwise" style="font-size: 24px; color: #000; font-weight: bold; cursor: pointer;" title="Reset" onclick="resetFilterPopup();"></i>
	</div>
	
	<div class="filterDetails_InnerBox" id="filterDetails_InnerBox">
		<!-- <h5 class="card-title">Category</h5> -->
		
		<div class="row">
			<h5 class="card-title">Employee Type</h5>
			
			<div style="display: flex; justify-content:space-between;margin-top: 10px; align-items: center;">
				<div style="display: flex; justify-content:flex-start; gap: 20px;">
					<div>
						<input class="form-check-input border border-primary employeeType" value="Active" type="checkbox"><label style="padding-left: 4px; font-weight: bold;">Active</label>
				    </div>
				    <div>
						<input class="form-check-input border border-primary employeeType" value="In-active" type="checkbox"><label style="padding-left: 4px; font-weight: bold;">In-Active</label>
				    </div>
				</div>
				
				<div>
					<!-- <select class="form-select custom-select browser-default" id="exportOption" style="font-size: 14px;">
						<option style="font-size: 14px;" value="">Export as</option>
						<option style="font-size: 14px;" value="Excel">Excel</option>
					</select> -->
					<button type="button" class="btn btn-outline-success" id="exportOption" style="font-size: 14px; padding: 5px;">Export Excel</button>
				</div>
			</div>
		</div>
		
		<div class="filterPopupDepartmentBox row mt-2">
			<h5 class="card-title">Department(s)</h5>
			<div th:each="dept : ${departments}" class="col-md-6">
		       <input class="form-check-input border border-primary deptType" type="checkbox" th:value="${dept.deptName}" /><label style="padding-left: 4px; font-weight: bold;" th:text="${dept.deptName}"></label>
		    </div>
		</div>
		
		<div class="row">
			<h5 class="card-title">Gender</h5>
			<div style="display: flex; justify-content:flex-start; gap: 20px; margin-top: 10px;">
				<div>
					<input class="form-check-input border border-primary genderType" value="Male" type="radio" name="gender"><label style="padding-left: 4px; font-weight: bold;">Male</label>
			    </div>
			    <div>
					<input class="form-check-input border border-primary genderType" value="Female" type="radio" name="gender"><label style="padding-left: 4px; font-weight: bold;">Female</label>
			    </div>
			</div>
		</div>
		
		<div class="filterPopupDepartmentBox row mt-2">
			<h5 class="card-title">Fresher/Experience</h5>
			<div style="display: flex; justify-content:flex-start; gap: 20px; margin-top: 10px;">
				<div>
			       <input class="form-check-input border border-primary expType" type="checkbox" value="Fresher" /><label style="padding-left: 4px; font-weight: bold;">Fresher</label>
			    </div>
				<div>
			       <input class="form-check-input border border-primary expType" type="checkbox" value="Experience" /><label style="padding-left: 4px; font-weight: bold;">Experience</label>
			    </div>
		    </div>
		</div>
		
		<div class="row">
			<h5 class="card-title">Date Filter</h5>
			<div style="display: flex; justify-content:flex-start; gap: 20px; margin-top: 10px;">
				<div>
					<input class="form-check-input border border-primary dateFilterType" value="DOB" type="radio" name="dateType"><label style="padding-left: 4px; font-weight: bold;">DOB</label>
			    </div>
			    <div>
					<input class="form-check-input border border-primary dateFilterType" value="DOJ" type="radio" name="dateType"><label style="padding-left: 4px; font-weight: bold;">DOJ</label>
			    </div>
			    <div>
					<input class="form-check-input border border-primary dateFilterType" value="Probation" type="radio" name="dateType"><label style="padding-left: 4px; font-weight: bold;">Probation Completed</label>
			    </div>
			    <div>
					<input class="form-check-input border border-primary dateFilterType" value="Last Working" type="radio" name="dateType"><label style="padding-left: 4px; font-weight: bold;">Last Working Day</label>
			    </div>
			</div>
			<div class="row mt-2">
				<div class="col-md-6">
					<label>From</label>
			        <input type="date" class="form-control custom_date">			    
			     </div>
			     <div class="col-md-6">
			     	<label>To</label>
			        <input type="date" class="form-control custom_date">			    
			     </div>
			</div>
		</div>
		
	</div>
</div>
	
			
						<!-- Popup Div for Missing Punch Dates -->
						<div id="missingPunchDatesPopup" class="popup-container" style="display: none;">
						    <div class="popup-content">
						        <div class="popup-header">
						            <h5><b>Missed Punch Dates</b></h5>
						        </div>
						        <div class="popup-body">
						            <ul id="missingPunchDatesList">
						                <!-- Dynamically populated list will appear here -->
						                <!-- If no missed punches, the following message will be shown -->
						            </ul>
						            <p id="noMissedPunchesMessage" style="display: none; text-align: center;">No missed punches.</p>
						        </div>
						        <div class="popup-footer">
						            <button class="btn btn-secondary" onclick="closePopup()">Close</button>
						        </div>
						    </div>
						</div>
						
			<div class="col-lg-12" style="text-align: right; margin-top: -10px;" th:if="${empDetailsByEmpId.deptId==0}">
		      <i class="bi bi-funnel-fill filterIcon" title="Filter" onclick="openFilterPopup();"></i>
			  <i class="leaveBalanceIcon bi bi-info-square-fill" title="Leave Balance Lists" onclick="openLeaveBalancePopup();"></i> 
			  <i class="permissionListsIcon ri ri-shield-keyhole-fill" title="Permission Lists" onclick="openPermissionListPopup();"></i>
	      	</div>
	      
	      <input type="hidden" id="selectedCandidateIdValue" th:value="${selected_Candidate_Id}">
						
        <!-- Right side columns -->
         <div class="col-lg-12">
		 <div class="card" id="addRole" style="display:none;">
            <div class="card-body">
		             
		             <!-- <div class="d-flex justify-content-between">
		               <h5 class="card-title">Employee Form</h5>
		              	 <div>
						    <button type="button" class="btn btn-primary mt-3" style="padding: 5px; font-size: 14px;" id="listButton" onclick="toggleView()">View List</button>
						</div>  
		              </div> -->
		              
		              	<h5 class="card-title">Employee Form</h5>
			             <div class="p-1" style="display: flex; justify-content: flex-end;">
			               	<div>
			               		<button type="button" class="btn btn-primary mt-3 mb-2" id="empJourneyViewButton" onclick="toggleEmpJourney22()">Emp Journey</button>
							    <button type="button" class="btn btn-primary mt-3 mb-2" id="listButton" onclick="toggleView22()">View List</button>
							</div>
			              </div>
		              			<!-- Vertical Form -->
		              			<form class="addEmployeeForm addEmployeeFormWithValidation mt-3"
										th:action="@{/saveEmployee}" method="post"
										enctype="multipart/form-data" onsubmit="showLoadingPopup();">
										<div class="row jumbotron box8">
											<div class="col-sm-3 form-group mb-4">
												<label class="customLabel">Employee Id<span>*</span></label>
												<input type="text" onblur="checkEmpIdPresentOrNot($('#empId').val())" class="form-control custom_textfield"
													name="empId" id="empId" required>
												<span id="empId_error"></span>
											</div>
											
											<div class="col-sm-3 form-group dept_position_box mb-4 select-container" >
											<label class="customLabel">Select Department<span>*</span></label>
											    <select style="font-size: 14px;"
											        class="form-select custom-select browser-default custom_selectfield"
											        name="deptId" id="deptId" required
											        onchange="fetchDesignations(this.value)">
											        <option value="" selected>Select Department</option>
											        <option th:each="dept : ${departments}" th:value="${dept.dept_id}" th:text="${dept.deptName}"></option>
											    </select> 
											    <span id="dept_error"></span>
											</div>
											
											<div class="col-sm-3 form-group mb-4 select-container">
											<label class="customLabel">Select Sub Department</label>
												<select style="font-size: 14px;"
													class="form-select custom-select browser-default custom_selectfield"
													 name="sub_dept_name" id="sub_dept_name">
													<option value="" selected>Select Sub Department</option>
												</select> <span id="subDept_error"></span>
											</div>
											
											<div class="col-sm-3 form-group mb-4 select-container">
											<label class="customLabel">Select Designation<span>*</span></label>
												<select style="font-size: 14px;"
													class="form-select custom-select browser-default custom_selectfield"
													onchange="toggleUsertype(document.getElementById('roleId').value);"
													name="roleId" id="roleId" required>
													<option value="" selected>Select Designation</option>
												</select> <span id="designation_error"></span>
											</div>
											
											<div class="col-sm-4 form-group dept_position_box mb-4 select-container" >
											<label class="customLabel">Select Employee Type<span>*</span></label>
											    <select style="font-size: 14px;"
											        class="form-select custom-select browser-default custom_selectfield"
											        name="usertype" id="usertype" required>
											        <option value="">Select Employee Type</option>
											        <option id="adminUsertype" value="Admin">Admin</option>
											        <option id="userUsertype" value="User">User</option>
											        <option id="hrUsertype" value="HR">HR</option>
											    </select> 
											    <span id="userType_error"></span>
											</div>
		
											<div class="col-sm-4 form-group mb-4 select-container">
											<label class="customLabel">Select Reporting Manager-1</label>
												<select style="font-size: 14px;"
													class="form-select custom-select browser-default custom_selectfield"
													name="team_lead_name" id="team_lead_name">
													<option value="">Select Reporting Manager-1</option>
													<option th:each="data : ${empNamesAndEmpIdLists}" th:value="${data.empid}" th:text="${data.team_lead_name}"></option>
												</select> <span id="teamLead_error"></span>
											</div>
											
											<div class="col-sm-4 form-group mb-4 select-container">
											<label class="customLabel">Select Reporting Manager-2</label>
												<select style="font-size: 14px;"
													class="form-select custom-select browser-default custom_selectfield"
													name="team_co_name" id="team_co_name">
													<option value="">Select Reporting Manager-2</option>
													<option th:each="data : ${empNamesAndEmpIdLists}" th:value="${data.empid}" th:text="${data.team_lead_name}"></option>
												</select> <span id="teamco_error"></span>
											</div>
											
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">First Name<span>*</span></label>
												<input type="text" class="form-control custom_textfield"
													maxlength="20" onblur="validateEmpRegisterFormForOnBlur()" name="firstName" id="first_name"
													required> <span
													id="firstName_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Last Name</label>
												<input type="text" class="form-control custom_textfield"
													maxlength="10" onblur="validateEmpRegisterFormForOnBlur()" name="lastName" id="last_name"> <span
													id="lastName_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Mobile No<span>*</span></label>
												<input type="text" class="form-control custom_textfield"
													maxlength="10" onblur="validateEmpRegisterFormForOnBlur()" name="mobileNo" id="mobile_no"
													required> <span
													id="mobile_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Personal E-mail</label>
												<input type="email" class="form-control custom_emailfield"
													name="personal_email" id="personal_email">
												<span id="email_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Father Name</label>
												<input type="text" onblur="validateEmpRegisterFormForOnBlur()" class="form-control custom_textfield"
													name="father_name" id="father_name">
												<span id="fatherName_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Mother Name</label>
												<input type="text" onblur="validateEmpRegisterFormForOnBlur()" class="form-control custom_textfield"
													name="mother_name" id="mother_name">
												<span id="motherName_error"></span>
											</div>
											<div class="col-sm-6 form-group mb-4">
											<label class="customLabel">Current Address</label>
												<textarea class="form-control" name="corr_address" style="font-size: 14px;"
													id="corr_address" rows="3"
													></textarea>
												<span id="corrAddress_error"></span>
											</div>
											<div class="col-sm-6 form-group mb-4">
											<label class="customLabel">Permanent Address<span>*</span></label>
												<textarea class="form-control" name="address" style="font-size: 14px;"
													id="address" rows="3"
													required></textarea>
												<span id="address_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
												<label for="Date" class="customLabel">Date Of Birth<span>*</span></label> <input type="date"
													name="dob" class="form-control custom_date"
													id="dob" required> <span id="dob_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
												<label for="Date" class="customLabel">Date Of Joining<span>*</span></label> <input type="date"
													name="doj" class="form-control custom_date"
													id="doj" required> <span id="doj_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
												<label for="Date" class="customLabel">Probation Completed Date<span>*</span></label> <input type="date"
													name="probation_completed_date" class="form-control custom_date"
													id="probation_completed_date" required> <span id="probation_completed_date_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4 select-container">
											<label class="customLabel">Select Gender<span>*</span></label>
												<select style="font-size: 14px;"
													class="form-select custom-select browser-default custom_selectfield"
													name="gender" id="gender" required>
													<option value="" selected>Select Gender</option>
													<option value="Male">Male</option>
													<option value="Female">Female</option>
													<option value="Other">Other</option>
												</select> <span id="gender_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Aadhaar No</label>
												<input type="text" onblur="validateEmpRegisterFormForOnBlur()" class="form-control custom_textfield"
													maxlength="12" name="adharNo" id="aadhar"
													> <span
													id="aadhar_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Pan No</label>
												<input type="text" class="form-control custom_textfield"
													name="panCard" id="pan">
												<span id="pan_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
												<label for="Date" class="customLabel">Alternate Saturday Leaves From</label> 
												<input type="date" name="alternative_saturday_effective_from" class="form-control custom_date" id="alternative_saturday_effective_from"> 
												<span id="alternative_saturday_effective_from_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Official E-mail<span>*</span></label>
												<input type="email" class="form-control custom_emailfield"
													name="email" id="email" required>
												<span id="email_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Password<span>*</span></label>
												<input type="text" name="password"
													class="form-control custom_passwordfield" id="pass1"
													required> <span
													id="password_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4 select-container">
											<label class="customLabel">Select Blood Group</label>
												<select style="font-size: 14px;"
													class="form-select custom-select browser-default custom_selectfield"
													name="blood_group" id="blood_group">
													<option value="">Select Blood Group</option>
													<option value="A+">A+</option>
													<option value="A1+">A1+</option>
													<option value="A2+">A2+</option>
													<option value="A1B+">A1B+</option>
													<option value="A2B+">A2B+</option>
													<option value="A-">A-</option>
													<option value="A1-">A1-</option>
													<option value="A2-">A2-</option>
													<option value="A1B-">A1B-</option>
													<option value="A2B-">A2B-</option>
													<option value="B+">B+</option>
													<option value="B-">B-</option>
													<option value="O+">O+</option>
													<option value="O-">O-</option>
													<option value="AB+">AB+</option>
													<option value="AB-">AB-</option>
												</select> 
												<span id="blood_group_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Twitter Link</label>
												<input type="text" name="twitter_link"
													class="form-control custom_passwordfield" id="twitter_link"
													> <span
													id="twitter_error"></span>
											</div>
											<div class="col-sm-4 form-group mb-4">
											<label class="customLabel">Linked-in Link</label>
												<input type="text" name="linkedin_link"
													class="form-control custom_passwordfield" id="linkedin_link"
													> <span
													id="linkedIn_error"></span>
											</div>
											
											<div class="col-sm-6 form-group mb-4">
												<div class="form-group border" style="border-radius: 5px; padding: 10px;">
													<p>Academic Details</p>
													<div class="employeeFormAcademicBtnDiv">
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn tenthButton" onclick="displayHiddenAcademicBlocks('10th', this);">10th</button>
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn pucBtn" onclick="displayHiddenAcademicBlocks('PUC', this);">PUC</button>
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn ugBtn" onclick="displayHiddenAcademicBlocks('UG', this);">UG</button>
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn pgBtn" onclick="displayHiddenAcademicBlocks('PG', this);">PG</button>
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn otherBtn" onclick="displayHiddenAcademicBlocks('Other', this);">Other</button>
													</div>
													<div class="hiddenTenthDetailBox border">
														<p class="hiddenAcademicHeading">10th</p>
															<input type="hidden" value="10th" name="qualification_tenth">
															<div class="hiddenTextFieldsDiv1">
																<input type="text" name="tenth_school_name" style="font-size: 14px;"
																	class="form-control custom_passwordfield" id="tenth_school_name"
																	placeholder="School name">
																	
																<input type="text" name="tenth_board_name" style="font-size: 14px;"
																	class="form-control custom_passwordfield" id="tenth_board_name"
																	placeholder="Board name">
															</div>
															<div class="hiddenTextFieldsDiv2">
																<div>
																	<label style="font-size: 14px;">Percentage</label>
																		<input type="number" name="tenth_percentage" style="font-size: 14px;" min="0.01" step="0.01"
																			class="form-control custom_passwordfield" id="tenth_percentage">
																</div>
																<div>
																	<label style="font-size: 14px;">Completed Date</label>
																	<input type="month" name="tenth_completed_date" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="tenth_completed_date">
																</div>
															</div>
														</div>
														<div class="hiddenPucDetailBox border">
															<p class="hiddenAcademicHeading">PUC</p>
															<input type="hidden" value="PUC" name="qualification_puc">
																<div class="hiddenTextFieldsDiv1">
																	<input type="text" name="puc_college_name" style="font-size: 14px;"
																		class="form-control custom_passwordfield" id="puc_college_name"
																		placeholder="College name">
																		
																	<input type="text" name="puc_board_name" style="font-size: 14px;"
																		class="form-control custom_passwordfield" id="puc_board_name"
																		placeholder="Board name">
																</div>
																<div class="hiddenTextFieldsDiv2">
																	<div>
																		<label style="font-size: 14px;">Percentage</label>
																			<input type="number" name="puc_percentage" style="font-size: 14px;" min="0.01" step="0.01"
																				class="form-control custom_passwordfield" id="puc_percentage">
																	</div>
																	<div>
																		<label style="font-size: 14px;">Completed Date</label>
																		<input type="month" name="puc_completed_date" style="font-size: 14px;"
																				class="form-control custom_passwordfield" id="puc_completed_date">
																	</div>
																</div>
															</div>
															<div class="hiddenUGDetailBox border">
																<p class="hiddenAcademicHeading">UG</p>
																<input type="hidden" value="UG" name="qualification_ug">
																	<div class="hiddenTextFieldsDiv1">
																		<input type="text" name="ug_college_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="ug_college_name"
																			placeholder="College name">
																			
																		<input type="text" name="ug_degree_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="ug_degree_name"
																			placeholder="Degree name">
																			
																		<input type="text" name="ug_university_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="ug_university_name"
																			placeholder="University name">
																	</div>
																<div class="hiddenTextFieldsDiv3">
																	<div>
																		<label style="font-size: 14px;">Type</label>
																		<select
																			class="form-select custom-select browser-default custom_selectfield" style="font-size: 14px;"
																			name="ug_type" id="ug_type">
																			<option value=""></option>
																			<option value="Regular">Regular</option>
																			<option value="Lateral">Lateral</option>
																			<option value="Part-time">Part-time</option>
																		</select>
																	</div>
																	<div>
																		<label style="font-size: 14px;">Percentage/CGPA</label>
																		<input type="number" name="ug_percentage" style="font-size: 14px;" min="0.01" step="0.01"
																				class="form-control custom_passwordfield" id="ug_percentage">
																	</div>
																	<div>
																		<label style="font-size: 14px;">Completed Date</label>
																		<input type="month" name="ug_completed_date" style="font-size: 14px;"
																				class="form-control custom_passwordfield" id="ug_completed_date">
																	</div>
																</div>
															</div>
															
															<div class="hiddenPGDetailBox border">
																<p class="hiddenAcademicHeading">PG</p>
																<input type="hidden" value="PG" name="qualification_pg">
																	<div class="hiddenTextFieldsDiv1">
																		<input type="text" name="pg_college_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="pg_college_name"
																			placeholder="College name">
																			
																		<input type="text" name="pg_degree_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="pg_degree_name"
																			placeholder="Degree name">
																			
																		<input type="text" name="pg_university_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="pg_university_name"
																			placeholder="University name">
																	</div>
																<div class="hiddenTextFieldsDiv3">
																	<div>
																		<label style="font-size: 14px;">Type</label>
																		<select
																			class="form-select custom-select browser-default custom_selectfield" style="font-size: 14px;"
																			name="pg_type" id="pg_type">
																			<option value=""></option>
																			<option value="Regular">Regular</option>
																			<option value="Lateral">Lateral</option>
																			<option value="Part-time">Part-time</option>
																		</select>
																	</div>
																	<div>
																		<label style="font-size: 14px;">Percentage/CGPA</label>
																		<input type="number" name="pg_percentage" style="font-size: 14px;" min="0.01" step="0.01"
																				class="form-control custom_passwordfield" id="pg_percentage">
																	</div>
																	<div>
																		<label style="font-size: 14px;">Completed Date</label>
																		<input type="month" name="pg_completed_date" style="font-size: 14px;"
																				class="form-control custom_passwordfield" id="pg_completed_date">
																	</div>
																</div>
															</div>
															
															<div class="hiddenOtherDetailBox border">
																<p class="hiddenAcademicHeading">Other</p>
																<input type="hidden" value="Other" name="qualification_other">
																	<div class="hiddenTextFieldsDiv1">
																		<input type="text" name="other_college_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="other_college_name"
																			placeholder="College name">
																			
																		<input type="text" name="other_degree_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="other_degree_name"
																			placeholder="Degree name">
																			
																		<input type="text" name="other_university_name" style="font-size: 14px;"
																			class="form-control custom_passwordfield" id="other_university_name"
																			placeholder="University name">
																	</div>
																<div class="hiddenTextFieldsDiv3">
																	<div>
																		<label style="font-size: 14px;">Type</label>
																		<select
																			class="form-select custom-select browser-default custom_selectfield" style="font-size: 14px;"
																			name="other_type" id="other_type">
																			<option value=""></option>
																			<option value="Regular">Regular</option>
																			<option value="Lateral">Lateral</option>
																			<option value="Part-time">Part-time</option>
																		</select>
																	</div>
																	<div>
																		<label style="font-size: 14px;">Percentage/CGPA</label>
																		<input type="number" name="other_percentage" style="font-size: 14px;" min="0.01" step="0.01"
																				class="form-control custom_passwordfield" id="other_percentage">
																	</div>
																	<div>
																		<label style="font-size: 14px;">Completed Date</label>
																		<input type="month" name="other_completed_date" style="font-size: 14px;"
																				class="form-control custom_passwordfield" id="other_completed_date">
																	</div>
																</div>
															</div>
													</div>
												</div>
											
											<div class="col-sm-6 form-group mb-4">
												<div class="form-group border" style="border-radius: 5px; padding: 10px;">
													<p>Candidate Type</p>
													<div class="employeeFormCandidateTypeDiv">
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn candidateTypeBtn fresherBtn" onclick="displayHiddenCandidateTypeBlocks('Fresher', this);">Fresher</button>
														<button type="button" class="btn btn-outline-primary employeeFormCustomBtn candidateTypeBtn expBtn" onclick="displayHiddenCandidateTypeBlocks('Experience', this);">Experience</button>
													</div>
													<div class="hiddenfresherDetailBox border">
														<p class="hiddenCandidateTypeHeading">Fresher</p>
														<input type="hidden" name="candidate_type" id="candidate_type">
															<div class="hiddenTextFieldsDiv4">
																<div>
																	<label style="font-size: 14px;">Expected Salary(LPA)</label>
																	<input type="number" name="fresher_expected_salary" style="font-size: 14px;" min="0.1" step="0.1"
																			class="form-control custom_passwordfield mb-3" id="fresher_expected_salary">
																			
																	<label style="font-size: 14px;">Current Salary(LPA)</label>
																	<input type="number" style="font-size: 14px;" min="0.1" step="0.1" onchange="insertCurrentSalaryToHiddenInput($('#fresher_current_salary').val())"
																			class="form-control custom_passwordfield" id="fresher_current_salary">
																</div>
															</div>
														</div>
													<div class="hiddenExperienceDetailBox border">
														<p class="hiddenCandidateTypeHeading">Experience</p>
														<!-- <input type="hidden" name="candidate_type" id="candidate_type"> -->
															<div class="hiddenTextFieldsDiv1">
																<div>
																	<label style="font-size: 14px;">Years of Experience</label>
																	<input type="number" name="experience_total_years" style="font-size: 14px;" min="0.1" step="0.1"
																			class="form-control custom_passwordfield" id="experience_total_years">
																</div>
																<div>
																	<label style="font-size: 14px;">Expected Salary(LPA)</label>
																	<input type="number" name="experience_expected_salary" style="font-size: 14px;" min="0.1" step="0.1"
																			class="form-control custom_passwordfield" id="experience_expected_salary">
																</div>
																<div>
																	<label style="font-size: 14px;">Current Salary(LPA)</label>
																	<input type="number" style="font-size: 14px;" min="0.1" step="0.1" onchange="insertCurrentSalaryToHiddenInput($('#exp_current_salary').val())"
																			class="form-control custom_passwordfield" id="exp_current_salary">
																</div>
															</div>
														</div>
													</div>
												</div>
												
											<div class="col-sm-4 form-group photo_div mb-5 profilePicDiv" style="width: 150px; height: 100px; display: none;">
										    	<img id="profilePic" width="100%" height="100%" src="" alt="Profile Picture" />
										    	<label class="mb-4">Profile Pic</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 panPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<img id="panPic" width="100%" height="100%" src="" alt="Pan Picture" />
										    	<label>Pan Pic</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 aadharPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="aadharPic" width="100%" height="100%" src="" alt="Aadhar Picture" /> -->
										    	<iframe id="aadharPic" width="100%" height="100%"></iframe>
										    	<label>Aadhar Pic</label>
										    </div>
										    
										    <!-- <div class="col-sm-3 form-group photo_div mb-4 voterIdPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<img id="voterIdPic" width="100%" height="100%" src="" alt="Voter-Id Picture" />
										    	<label>Voter id Pic</label>
										    </div> -->
										    
										    <div class="col-sm-4 form-group photo_div mb-4 tenthPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="tenthPic" width="100%" height="100%" src="" alt="Tenth Picture" /> -->
										    	<iframe id="tenthPic" width="100%" height="100%"></iframe>
										    	<label>Tenth</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 pucPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="pucPic" width="100%" height="100%" src="" alt="PUC Picture" /> -->
										    	<iframe id="pucPic" width="100%" height="100%"></iframe>
										    	<label>PUC</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 degreePicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="degreePic" width="100%" height="100%"></iframe>
										    	<label>UG</label>
										    </div>
										    
										    
										    
										    <div class="col-sm-4 form-group photo_div mb-4 pgPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="tenthPic" width="100%" height="100%" src="" alt="Tenth Picture" /> -->
										    	<iframe id="pgPic" width="100%" height="100%"></iframe>
										    	<label>PG</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-5 expLetterPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="pucPic" width="100%" height="100%" src="" alt="PUC Picture" /> -->
										    	<iframe id="expLetterPic" width="100%" height="100%"></iframe>
										    	<label>Experience Letter</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 payslipPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="payslipPic" width="100%" height="100%"></iframe>
										    	<label>Payslip</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 diplomaPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="diplomaPic" width="100%" height="100%"></iframe>
										    	<label>Diploma</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 bankOrChequePicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="bankOrChequePic" width="100%" height="100%"></iframe>
										    	<label>Bank/Cheque Leaf</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 othersPicDiv" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="othersPic" width="100%" height="100%"></iframe>
										    	<label>Others1</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 othersPicDiv2" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="othersPic2" width="100%" height="100%"></iframe>
										    	<label>Others2</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 othersPicDiv3" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="othersPic3" width="100%" height="100%"></iframe>
										    	<label>Others3</label>
										    </div>
										    
										    <div class="col-sm-4 form-group photo_div mb-4 othersPicDiv4" style="width: 150px; height: 100px; display: none;">
										    	<!-- <img id="degreePic" width="100%" height="100%" src="" alt="Degree Picture" /> -->
										    	<iframe id="othersPic4" width="100%" height="100%"></iframe>
										    	<label>Others4</label>
										    </div>
										    
										    
										    <!-- <input type="hidden" id="profilePicPathValue" name="profilePicPath"> -->
										    <textarea style="display: none;" class="col-lg-12" id="profilePicPathValue" name="profilePicPath"></textarea>
										    <input type="hidden" id="panPicPathValue" name="panPicPath">
										    <input type="hidden" id="aadharPicPathValue" name="aadhar_pic">
										    <!-- <input type="hidden" id="voterIdPicPathValue" name="voter_id_pic"> -->
										    <input type="hidden" id="tenthPicPathValue" name="tenth_pic">
										    <input type="hidden" id="pucPicPathValue" name="puc_pic">
										    <input type="hidden" id="degreePicPathValue" name="degree_pic">
										    
										    <input type="hidden" id="pgPicPathValue" name="pg_pic">
										    <input type="hidden" id="expLetterPicPathValue" name="exp_letter_pic">
										    <input type="hidden" id="payslipPicPathValue" name="payslip_pic">
										    
										    <input type="hidden" id="diplomaPicPathValue" name="diploma_pic">
										    <input type="hidden" id="bankOrChequePicPathValue" name="bank_check_pic">
										    <input type="hidden" id="othersPicPathValue" name="other_pic">
										    <input type="hidden" id="othersPicPathValue2" name="other_pic2">
										    <input type="hidden" id="othersPicPathValue3" name="other_pic3">
										    <input type="hidden" id="othersPicPathValue4" name="other_pic4">
										    
										    <input type="hidden" id="current_salary_in_hidden_input" name="current_salary">
										    <input type="hidden" value="1" name="employee_type">
										    
											<!-- <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="photo">Profile Pic (Png/Jpg)</label>
										        <input type="file" id="photo" class="form-control" name="profilePic">
										    </div> -->
										
										    <!-- <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="panDoc">Pancard Doc (Png/Jpg)</label>
										        <input type="file" id="panDoc" class="form-control" name="panPic">
										    </div>
										    
										    <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="aadharDoc">Aadhar Doc (Png/Jpg)</label>
										        <input type="file" id="aadharDoc" class="form-control" name="aadharPic">
										    </div>
										    
										    <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="voterIdDoc">Voter-id Doc (Png/Jpg)</label>
										        <input type="file" id="voterIdDoc" class="form-control" name="voterIdPic">
										    </div>
										    
										    
										    <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="tenthDoc">10th Doc (Png/Jpg)</label>
										        <input type="file" id="tenthDoc" class="form-control" name="tenthPic">
										    </div>
										    
										    <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="pucDoc">PUC Doc (Png/Jpg)</label>
										        <input type="file" id="pucDoc" class="form-control" name="pucPic">
										    </div>
										    
										    <div class="col-sm-3 form-group photo_div mb-4">
										        <label for="degreeDoc">Degree Doc (Png/Jpg)</label>
										        <input type="file" id="degreeDoc" class="form-control" name="degreePic">
										    </div> -->
										    
										     <!-- <div class="col-sm-3 form-group mb-4">
										     	<label class="customLabel" style="padding-left: 8px;">Employee Type<span>*</span></label>
											    <div class="employee_type_btn_div">
											    	<button type="button" onclick="setEmployeeTypeStatus('active');" class="btn btn-outline-success activeBtn">Active</button>
											    	<button type="button" onclick="setEmployeeTypeStatus('inactive');" class="btn btn-outline-danger inActiveBtn">In-active</button>
											    </div>
										    </div> -->
										    
											<div class="col-sm-12 form-group mb-0 customize_btn_div mb-4 text-end">
												<button type="submit" style="font-size: 14px;" id="empDetailsSubmitBtn" class="btn btn-primary">Submit</button>
												<!-- <button type="reset" style="font-size: 14px;" class="btn btn-light">Clear</button> -->
											</div>
										</div>
									</form><!-- Vertical Form -->
					            </div>
          					</div>
          					
          					
          					
          <div class="card" id="empListId" th:if="${empDetailsByEmpId.deptId>0}">
            <div class="card-body">
              <div class="d-flex justify-content-between">
               <h5 class="card-title">Employee List</h5>
               
              	 <div class='d-flex'>
              	    <div id="searchUnapproved" class="search-box m-1 mt-3">
				 			<button class="btn-search searchUnprovedTable" title="Search" ><i class="bi bi-search"></i></button>
							<input type="text" oninput="searchUnprovedTable();" class="input-search searchUnprovedTable_inputSearch" placeholder="Search...">
					</div>
					<!-- <button type="button" class="btn btn-primary mt-3 mb-2" id="empJourneyViewButton" th:if="${empDetailsByEmpId.deptId==0}" onclick="toggleEmpJourney22()">Emp Journey</button> -->
              	    <button type="button" class="btn btn-primary mt-3 mb-2 mx-1" id="listImageViewButton" onclick="toggleEmpCards()">Image View</button>
				    <!-- <button type="button" class="btn btn-primary mt-3" id="toggleButton" onclick="toggleAdd()">Add</button>  -->
				    <!-- <button type="button" class="btn btn-primary mt-3" id="toggleAddButton" onclick="toggleAdd()">Add</button> -->
					<!-- <button type="button" class="btn btn-primary mt-3 mb-2" id="toggleAddButton" th:if="${empDetailsByEmpId.deptId==0}" onclick="toggleAdd22()">Add</button> -->
				</div>  
              </div>	
					<div  id="tableView" style="overflow-x: auto; max-height: 80vh;">
		            <table class="table table-hover centered-table" id="employeeTable" style="font-size: 14px;">
		                <thead style="position: sticky; top: 0; z-index: 2; background-color: #f8f9fa;"	>
		                    <tr>
		                        <th scope="col">Sl No</th>
		                        <th scope="col">Attendence</th>	                       
		                        <th scope="col">Profile</th>
		                        <th scope="col">Emp Id</th>
		                        <th scope="col" style="text-align:left;">Name</th>		                        
		                        <th scope="col" style="text-align:left;">Email</th>
		                        <th scope="col">Department</th>
		                        <th scope="col">Role</th>
		                         <th scope="col">Missed Punch</th>
		                        <th scope="col">Emmergency Contanct</th>
		                        <th scope="col">Blood Group</th>
		                       
		                        
		                    </tr>
				   </thead>
					  <tbody>
					  		<tr th:if="${employeeWithDeptName.size() == 0}">
					  			<td colspan=7 class="text-center">No data Available</td>
					  		</tr>
					        <tr th:each="emp,iterStat:${employeeWithDeptName}" th:unless="${employeeWithDeptName.size() == 0}">
					            <td th:text="${iterStat.count}">1</td>
					            <td>
					            	<a th:href="@{/attendanceLive(email=${emp.email})}" title="Edit">
		                       			View
		                			</a>
		                		</td>		
					            <td> 
					            	<a th:href="@{/viewProfile(empid=${emp.empid})}" title="Edit">
		                       			<i class="ri-eye-line" style="font-size: 18px;"></i>
		                			</a>
		                		</td>
					            <td th:text=${emp.empid}></td>
					            <td th:text=${emp.fullName} style="text-align:left;"></td>
					            <td th:text=${emp.email} style="text-align:left;"></td>
					            <td th:text=${emp.deptName}></td>
					            <td th:text=${emp.roleName}></td>
					            <td style="color:blue;cursor:pointer;">
					            	<a  th:onclick="openPopup([[${emp.empid}]])" title="Edit" th:text=${emp.misspunch_count} ></a>
		                		</td>
					            <td th:text="${emp.primary_emergency_contact_number != null and emp.primary_emergency_contact_number != ''} ? ${emp.primary_emergency_contact_number} : '-'"></td>
								<td th:text="${emp.blood_group} ?: '-'"></td>

					           <!--  <td>
					            	<a  th:onclick="openPopup([[${emp.empid}]])" title="Edit">
		                       			View
		                			</a>
		                		</td> -->
		                		
		                		 
					            
					        </tr>					      
					    </tbody>
					</table>
					</div>
					<div id="imageView" class="container" style="display:none">
					    <div class="row justify-content-center mt-2" id="employeeList">
					        <div th:each="emp, iterStat : ${employeeWithDeptName}" class="col-sm-6 col-md-3 col-lg-2-4 mb-2 d-flex">
					            <a th:href="@{/viewProfile(empid=${emp.empid})}" class="card flex-fill text-decoration-none clickable-card">
					                <div class="card-body text-center mt-3">
					                    <img th:src="@{${emp.profilePicPath}}" alt="Profile" class="rounded-circle" style="width: 70px; height: 70px;">
					                    <h6 class="card-title h6 h5-md h4-lg text-center p-2" th:text="${emp.fullName}"></h6>
					                    <p class="card-subtitle text-muted" th:text="${emp.roleName}">Role</p>
					                </div>
					            </a>
					        </div>
					    </div>
					</div>
		        </div>
            </div>
            
            
            <div class="card" id="empListId2" th:if="${empDetailsByEmpId.deptId==0}">
		            <div class="card-body">
		            
		            <div class="d-flex justify-content-between align-items-center">
	               		<h5 class="card-title" id="employeeListHeading">Employee List</h5>
		               	  <div class="search-box">
					        <button class="btn-search" title="Search"><i class="bi bi-search"></i></button>
					        <input type="text" oninput="searchTableForEmpList();" class="input-search" placeholder="Search...">
					      </div>
	              	</div>
		            
		              <div class="d-flex justify-content-between mt-1">
		               		<div>
			              	 	<!-- <button type="button" class="btn btn-primary" style="font-size: 14px; padding: 5px; background: #0d6efd; color: #fff;" id="toggleDisablePermissionsButton" onclick="openPopupToDisablePermissions()">Disable Permissions</button> -->
		               		</div>
		               		
			               	<div>
			              	 	<!-- <button type="button" class="btn btn-primary" style="font-size: 14px; padding: 5px;" id="toggleAttendanceButton" onclick="openPopupToInsertAttendanceData()">Enable Attendance</button>
			              	 	<button type="button" class="btn btn-primary" style="font-size: 14px; padding: 5px; display: none;" id="toggleAppraisalButton" onclick="openPopupToInsertAppraisalData()">Enable Appraisal</button> -->
			              	 	<button type="button" class="btn btn-primary" style="font-size: 14px; padding: 5px;" id="empJourneyViewButton" onclick="toggleEmpJourney22()">Emp Journey</button>
			              	    <button type="button" class="btn btn-primary" style="font-size: 14px; padding: 5px;" id="listImageViewButton2" onclick="toggleEmpCardsSA()">Image View</button>
							    <button type="button" class="btn btn-primary" style="font-size: 14px; padding: 5px;" id="toggleAddButton" onclick="toggleAddSA()">Add</button>
							</div>
		              	</div>	
		              		<div class="custom_table_div2 mt-1">
								<div id="tableView2">
					            	<table class="table table-hover text-center tableSearch" id="customTable" style="font-size: 14px;">
						                <thead class="fixTHead">
						                    <tr>
						                    	<!-- <th>
						                        	<label class="form-check-label" for="selectAllCheck">Enable<br> Appraisal</label><br>
						                        	<input class="form-check-input border border-primary" type="checkbox" id="selectAllCheck" onclick="toggleSelectAll(this)">
							            		</th> --> 
						                        <th scope="col">#</th>
							            		<th scope="col" colspan="2">More</th>
						                        <th scope="col">Employee Status</th>
						                        <th scope="col">Emp Id</th>
						                        <th scope="col">Department</th>
						                        <th scope="col">Role</th>
						                        <th scope="col">Name</th>
						                        <th scope="col">Email</th>
						                        <th scope="col">DOB</th>
						                        <th scope="col">DOJ</th>
						                        <th scope="col">Gender</th>
						                        <th scope="col">Experience/Fresher</th>
						                        <th scope="col">Probation Completion Date</th>
						                        <th scope="col">Last Working Day</th>
						                        <!-- <th scope="col">Resignation Date</th> -->
						                        <!-- <th style="display: none;" scope="col">Mobile No</th> -->
						                        <!-- <th style="display: none;" scope="col">Current Salary</th> -->
						                    </tr>
								   </thead>
									  <tbody>
									  		<tr th:if="${employeeWithDeptName.size() == 0}">
									  			<td colspan=7 class="text-center">No data Available</td>
									  		</tr>
									        <tr th:each="emp,iterStat:${employeeWithDeptName}" th:unless="${employeeWithDeptName.size() == 0}">
									        	<!-- <td>
									            	<input class="form-check-input border border-primary employeeCheckbox" type="checkbox" id="flexCheckDefault" data-emp-id="${emp.empid}" data-employee-type="${emp.employee_type}">
					                            </td> -->
									            <td th:text="${iterStat.count}">1</td>
					                            <td> 
									            	<a style="color: #4154f1;" th:href="@{/viewProfile(empid=${emp.empid})}" title="View">
						                       			<i class="bi bi-eye-fill" style="font-size: 16px;"></i>
						                			</a>
						                		</td>
						                		<td> 
									            	<a th:if="${emp.attendance_link}" style="color: #4154f1;" th:href="@{/attendanceLive(email=${emp.email})}" title="Attendance">
						                       			<i class="bi bi-calendar2-check-fill" style="font-size: 16px;"></i>
						                			</a>
						                		</td>
						                		<!-- <td>
												    <a href="javascript:void(0);" th:onclick="confirmDelete([[${emp.empid}]])" title="Delete">
												        <i class="bi bi-trash-fill" style="font-size: 16px;"></i>
												    </a>
												</td> -->
									            <td data-column="empType" style="min-width: 150px;"><span style="font-weight: bold; padding: 2px 8px; border-radius: 50px;" th:text="${emp.employee_type == '1' ? 'Active' : 'In-active'}" 
    												th:class="${emp.employee_type == '1' ? 'text-primary border border-primary' : 'text-danger border border-danger'}"></span></td>
									            <td id="empIdForApprisal" style="min-width: 70px;" th:text=${emp.empid}></td>
									            <td data-column="deptName" id="empDeptNameForApprisal" th:text=${emp.deptName}></td>
									            <td th:text=${emp.roleName}></td>
									            <td th:text=${emp.fullName}></td>
									            <td id="empEmailForApprisal" th:text=${emp.email}></td>
									            <td data-column="dob" style="min-width: 90px;" class="dateColumn dateFormatter" th:text=${emp.dob}></td>
									            <td data-column="doj" style="min-width: 90px;" class="dateColumn dateFormatter" th:text=${emp.doj}></td>
									            <td data-column="gender" th:text=${emp.gender}></td>
									            <td data-column="candidateType" th:text=${emp.candidate_type}></td>
									            <td data-column="probation" style="min-width: 210px;" class="dateColumn dateFormatter" 
												    th:text="${emp.probation_completed_date != null ? emp.probation_completed_date : '-'}">
												</td>
												<td data-column="lastWorking" style="min-width: 140px;"
												    th:text="${emp.last_working_date != null ? emp.last_working_date : '-'}">
												</td>
												<!-- <td data-column="resignation" class="dateColumn dateFormatter" 
												    th:text="${emp.resignation_date != null ? emp.resignation_date : '-'}">
												</td> -->
									            <!-- <td style="display: none;" th:text=${emp.mobileNo}></td> -->
									            <!-- <td style="display: none;" th:text=${emp.current_salary}></td> -->
									          </tr>					      
									    </tbody>
									</table>
								</div>
								
								<div id="imageView2" class="col-lg-12" style="display:none">
								    <div class="row custom_table_div2" id="employeeList">
								        <div th:each="emp, iterStat : ${employeeWithDeptName}" class="col-sm-6 col-md-3 col-lg-2-4 mb-2 d-flex">
								            <a th:href="@{/viewProfile(empid=${emp.empid})}" class="card flex-fill text-decoration-none clickable-card">
								                <div class="card-body text-center mt-3">
								                    <img th:src="${emp.profilePicPath}"
													     alt="Profile"
													     class="rounded-circle"
													     th:classappend="${emp.employee_type == '1' ? ' border-custom-success' : ' border-custom-danger'}"
													     style="width: 70px; height: 70px;">
								                    <!-- <p style="margin: 0; padding: 0; font-weight: bold;" th:text="${emp.employee_type == '1' ? 'Active' : 'In Active'}"
													      th:classappend="${emp.employee_type == '1' ? ' text-primary' : ' text-danger'}">
													</p> -->
								                    <h6 class="card-title h6 h5-md h4-lg text-center p-2" th:text="${emp.fullName}"></h6>
								                    <p class="card-subtitle text-muted" th:text="${emp.roleName}">Role</p>
								                </div>
								            </a>
								        </div>
								    </div>
								</div>
								
							</div>
				        </div>
		            </div>
            
            
            <div class="card col-lg-12" th:if="${empDetailsByEmpId.deptId==0}" id="employeeJourneyDiv" style="display:none;">
			            <div class="card-body">
			            
			            <div class="d-flex justify-content-between align-items-center">
		               		<h5 class="card-title">Employee Journey</h5>
			               	  <div class="search-box">
						        <button class="btn-search2" title="Search"><i class="bi bi-search"></i></button>
						        <input type="text" oninput="searchTableForEmpJourney();" class="input-search2" placeholder="Search...">
						      </div>
		              	</div>
			            
			             <div class="p-1" style="display: flex; justify-content: flex-end;">
			               	<div>
			               		<button type="button" class="btn btn-primary mt-3 mb-2" id="listButton2" onclick="toggleView22()">View List</button>
							    <button type="button" class="btn btn-primary mt-3 mb-2" id="toggleAddButton" onclick="toggleAddSA()">Add</button>
							</div>
			              </div>
					            
				            <div class="custom_table_div2">
								<table class="table table-hover mb-0 text-center tableSearch2" id="customTable2" style="font-size: 14px;">
									<thead class="fixTHead" style="position: sticky; top: 0;">
										<tr>
											<th scope="col">#</th>
											<th scope="col">Employee Type</th>
					                        <th scope="col">Emp Id</th>
					                        <th scope="col">Department</th>
					                        <th scope="col">Role</th>
					                        <th scope="col">Name</th>
					                        <th scope="col">Employment Journey</th>
					                        <th scope="col">DOJ</th>
					                        <th scope="col">Last Working Day</th>
					                        <th scope="col">Inactive Reason</th>
										</tr>
									</thead>
									<tbody id="viewEmpJourneyTBody"></tbody>
								</table>
							</div>
					               
			            </div>
	         		 </div>
            
          </div>
       <!-- <div class="container">
		    <div class="row" id="employeeList">
		        <div th:each="emp, iterStat : ${employeeWithDeptName}" class="col-md-3 mb-4">
		            <div class="card">
		                <div class="card-body">
		                    <h5 class="card-title" th:text="${emp.empid}">Employee ID</h5>
		                    <h6 class="card-subtitle mb-2 text-muted" th:text="${emp.roleName}">Role</h6>
		                </div>
		            </div>
		        </div>
		    </div>
		</div> -->
		
          <!-- <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filter</h6>
                </li>

                <li><a class="dropdown-item" href="#">Today</a></li>
                <li><a class="dropdown-item" href="#">This Month</a></li>
                <li><a class="dropdown-item" href="#">This Year</a></li>
              </ul>
            </div>

            <div class="card-body">
              <h5 class="card-title">Recent Activity <span>| Today</span></h5>

              <div class="activity">

                <div class="activity-item d-flex">
                  <div class="activite-label">32 min</div>
                  <i class='bi bi-circle-fill activity-badge text-success align-self-start'></i>
                  <div class="activity-content">
                    Quia quae rerum <a href="#" class="fw-bold text-dark">explicabo officiis</a> beatae
                  </div>
                </div> End activity item

                <div class="activity-item d-flex">
                  <div class="activite-label">56 min</div>
                  <i class='bi bi-circle-fill activity-badge text-danger align-self-start'></i>
                  <div class="activity-content">
                    Voluptatem blanditiis blanditiis eveniet
                  </div>
                </div> End activity item

                <div class="activity-item d-flex">
                  <div class="activite-label">2 hrs</div>
                  <i class='bi bi-circle-fill activity-badge text-primary align-self-start'></i>
                  <div class="activity-content">
                    Voluptates corrupti molestias voluptatem
                  </div>
                </div> End activity item 

                <div class="activity-item d-flex">
                  <div class="activite-label">1 day</div>
                  <i class='bi bi-circle-fill activity-badge text-info align-self-start'></i>
                  <div class="activity-content">
                    Tempore autem saepe <a href="#" class="fw-bold text-dark">occaecati voluptatem</a> tempore
                  </div>
                </div>!-- End activity item 

                <div class="activity-item d-flex">
                  <div class="activite-label">2 days</div>
                  <i class='bi bi-circle-fill activity-badge text-warning align-self-start'></i>
                  <div class="activity-content">
                    Est sit eum reiciendis exercitationem
                  </div>
                </div>!-- End activity item 

                <div class="activity-item d-flex">
                  <div class="activite-label">4 weeks</div>
                  <i class='bi bi-circle-fill activity-badge text-muted align-self-start'></i>
                  <div class="activity-content">
                    Dicta dolorem harum nulla eius. Ut quidem quidem sit quas
                  </div>
                </div>!-- End activity item

              </div>

            </div>
          </div> --><!-- End Recent Activity -->

         <!--  Budget Report -->
          <!-- <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filter</h6>
                </li>

                <li><a class="dropdown-item" href="#">Today</a></li>
                <li><a class="dropdown-item" href="#">This Month</a></li>
                <li><a class="dropdown-item" href="#">This Year</a></li>
              </ul>
            </div>

            <div class="card-body pb-0">
              <h5 class="card-title">Budget Report <span>| This Month</span></h5>

              <div id="budgetChart" style="min-height: 400px;" class="echart"></div>

              <script>
                document.addEventListener("DOMContentLoaded", () => {
                  var budgetChart = echarts.init(document.querySelector("#budgetChart")).setOption({
                    legend: {
                      data: ['Allocated Budget', 'Actual Spending']
                    },
                    radar: {
                      // shape: 'circle',
                      indicator: [{
                          name: 'Sales',
                          max: 6500
                        },
                        {
                          name: 'Administration',
                          max: 16000
                        },
                        {
                          name: 'Information Technology',
                          max: 30000
                        },
                        {
                          name: 'Customer Support',
                          max: 38000
                        },
                        {
                          name: 'Development',
                          max: 52000
                        },
                        {
                          name: 'Marketing',
                          max: 25000
                        }
                      ]
                    },
                    series: [{
                      name: 'Budget vs spending',
                      type: 'radar',
                      data: [{
                          value: [4200, 3000, 20000, 35000, 50000, 18000],
                          name: 'Allocated Budget'
                        },
                        {
                          value: [5000, 14000, 28000, 26000, 42000, 21000],
                          name: 'Actual Spending'
                        }
                      ]
                    }]
                  });
                });
              </script>

            </div>
          </div> --><!-- End Budget Report -->

         <!--  Website Traffic -->
          <!-- <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filter</h6>
                </li>

                <li><a class="dropdown-item" href="#">Today</a></li>
                <li><a class="dropdown-item" href="#">This Month</a></li>
                <li><a class="dropdown-item" href="#">This Year</a></li>
              </ul>
            </div>

            <div class="card-body pb-0">
              <h5 class="card-title">Website Traffic <span>| Today</span></h5>

              <div id="trafficChart" style="min-height: 400px;" class="echart"></div>

              <script>
                document.addEventListener("DOMContentLoaded", () => {
                  echarts.init(document.querySelector("#trafficChart")).setOption({
                    tooltip: {
                      trigger: 'item'
                    },
                    legend: {
                      top: '5%',
                      left: 'center'
                    },
                    series: [{
                      name: 'Access From',
                      type: 'pie',
                      radius: ['40%', '70%'],
                      avoidLabelOverlap: false,
                      label: {
                        show: false,
                        position: 'center'
                      },
                      emphasis: {
                        label: {
                          show: true,
                          fontSize: '18',
                          fontWeight: 'bold'
                        }
                      },
                      labelLine: {
                        show: false
                      },
                      data: [{
                          value: 1048,
                          name: 'Search Engine'
                        },
                        {
                          value: 735,
                          name: 'Direct'
                        },
                        {
                          value: 580,
                          name: 'Email'
                        },
                        {
                          value: 484,
                          name: 'Union Ads'
                        },
                        {
                          value: 300,
                          name: 'Video Ads'
                        }
                      ]
                    }]
                  });
                });
              </script>

            </div>
          </div> --><!-- End Website Traffic -->

          <!-- News & Updates Traffic -->
          <!-- <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filter</h6>
                </li>

                <li><a class="dropdown-item" href="#">Today</a></li>
                <li><a class="dropdown-item" href="#">This Month</a></li>
                <li><a class="dropdown-item" href="#">This Year</a></li>
              </ul>
            </div>

            <div class="card-body pb-0">
              <h5 class="card-title">News &amp; Updates <span>| Today</span></h5>

              <div class="news">
                <div class="post-item clearfix">
                  <img src="assets/img/news-1.jpg" alt="">
                  <h4><a href="#">Nihil blanditiis at in nihil autem</a></h4>
                  <p>Sit recusandae non aspernatur laboriosam. Quia enim eligendi sed ut harum...</p>
                </div>

                <div class="post-item clearfix">
                  <img src="assets/img/news-2.jpg" alt="">
                  <h4><a href="#">Quidem autem et impedit</a></h4>
                  <p>Illo nemo neque maiores vitae officiis cum eum turos elan dries werona nande...</p>
                </div>

                <div class="post-item clearfix">
                  <img src="assets/img/news-3.jpg" alt="">
                  <h4><a href="#">Id quia et et ut maxime similique occaecati ut</a></h4>
                  <p>Fugiat voluptas vero eaque accusantium eos. Consequuntur sed ipsam et totam...</p>
                </div>

                <div class="post-item clearfix">
                  <img src="assets/img/news-4.jpg" alt="">
                  <h4><a href="#">Laborum corporis quo dara net para</a></h4>
                  <p>Qui enim quia optio. Eligendi aut asperiores enim repellendusvel rerum cuder...</p>
                </div>

                <div class="post-item clearfix">
                  <img src="assets/img/news-5.jpg" alt="">
                  <h4><a href="#">Et dolores corrupti quae illo quod dolor</a></h4>
                  <p>Odit ut eveniet modi reiciendis. Atque cupiditate libero beatae dignissimos eius...</p>
                </div>

              </div>End sidebar recent posts

            </div>
          </div> --><!-- End News & Updates -->

        </div> <!-- End Right side columns -->

      </div>
    </section>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="copyright">
      &copy; Copyright <strong><span>Melange System pvt ltd</span></strong>. All Rights Reserved
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/chart.js/chart.umd.js"></script>
  <script src="assets/vendor/echarts/echarts.min.js"></script>
  <script src="assets/vendor/quill/quill.js"></script>
  <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="assets/vendor/tinymce/tinymce.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>


  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
<!-- script to enable and disable the addEmployee Form -->
<script>
function toggleAdd() { 
	
    var addRoleDiv = document.getElementById('addRole');
    var tableViewDiv = document.getElementById('empListId');
    
    var button = document.getElementById('toggleAddButton');

    if (addRoleDiv.style.display === 'none' || addRoleDiv.style.display === '') {
        addRoleDiv.style.display = 'block';
        tableViewDiv.style.display = 'none';
    } else {
        addRoleDiv.style.display = 'none';
        tableViewDiv.style.display = 'block';
    } 
    
}

function toggleView() {
    var addRoleDiv = document.getElementById('addRole');
    var tableViewDiv = document.getElementById('tableView');
    var button = document.getElementById('toggleAddButton');
    var empListDiv = document.getElementById('empListId');
    var imageView = document.getElementById('imageView');
    
    addRoleDiv.style.display = 'none';
    empListDiv.style.display = 'block'
    tableViewDiv.style.display = 'block';
    imageView.style.display="none";
}
</script>
<!-- script to enable and disable the list view and image view -->
<script>
function toggleEmpCards() {
    var imageView = document.getElementById('imageView');
    var tableView = document.getElementById('tableView');
    var listImageViewButton = document.getElementById('listImageViewButton');
    
    if (imageView.style.display === 'none' || imageView.style.display === '') {
        imageView.style.display = 'block';
        tableView.style.display = 'none';
        listImageViewButton.textContent = 'List View';
    } else {
        imageView.style.display = 'none';
        tableView.style.display = 'block';
        listImageViewButton.textContent = 'Image View';
    }
}

function toggleEmpCardsSA() {
    var imageView = document.getElementById('imageView2');
    var tableView = document.getElementById('tableView2');
    var listImageViewButton = document.getElementById('listImageViewButton2');
    
    if (imageView.style.display === 'none' || imageView.style.display === '') {
        imageView.style.display = 'block';
        tableView.style.display = 'none';
        listImageViewButton.textContent = 'List View';
    } else {
        imageView.style.display = 'none';
        tableView.style.display = 'block';
        listImageViewButton.textContent = 'Image View';
    }
}
</script>







<script>
function toggleAdd22() {
    var addRoleDiv = document.getElementById('addRole');
    var tableViewDiv = document.getElementById('empListId');
    
    var button = document.getElementById('toggleAddButton');
    
    $('#employeeJourneyDiv').hide();

    if (addRoleDiv.style.display === 'none' || addRoleDiv.style.display === '') {
        addRoleDiv.style.display = 'block';
        tableViewDiv.style.display = 'none';
    } else {
        addRoleDiv.style.display = 'none';
        tableViewDiv.style.display = 'block';
    }
    
    $('#empId_error').text("");
	$('#empDetailsSubmitBtn').prop('disabled', false);
    
    $.ajax({
        type: 'GET', 
        url: 'fetchLastInsertedEmpIdValue', 
        success: function(data) {
	        	// Extract the numeric part from the data
	            let match = data.match(/(\D+)(\d+)/); // Extract prefix and number
	            if (match) {
	                let prefix = match[1]; // "MS"
	                let number = parseInt(match[2], 10) + 1; // Convert number to integer and increment
	                let newEmpId = prefix + number; // Concatenate prefix with incremented number
	                $('#empId').val(newEmpId); // Set the incremented value
	            }
			},
        error: function(xhr, status, error) {
            console.error('Error fetching last inserted empid data:', error);
            console.log('Error fetching last inserted empid data. Please try again.');
        }
    });
}

function toggleAddSA() {
    var addRoleDiv = document.getElementById('addRole');
    var tableViewDiv = document.getElementById('empListId2');
    
    var button = document.getElementById('toggleAddButton');
    
    $('#employeeJourneyDiv').hide();

    if (addRoleDiv.style.display === 'none' || addRoleDiv.style.display === '') {
        addRoleDiv.style.display = 'block';
        tableViewDiv.style.display = 'none';
    } else {
        addRoleDiv.style.display = 'none';
        tableViewDiv.style.display = 'block';
    }
    
    $('#empId_error').text("");
	$('#empDetailsSubmitBtn').prop('disabled', false);
    
    $.ajax({
        type: 'GET', 
        url: 'fetchLastInsertedEmpIdValue', 
        success: function(data) {
	        	// Extract the numeric part from the data
	            let match = data.match(/(\D+)(\d+)/); // Extract prefix and number
	            if (match) {
	                let prefix = match[1]; // "MS"
	                let number = parseInt(match[2], 10) + 1; // Convert number to integer and increment
	                let newEmpId = prefix + number; // Concatenate prefix with incremented number
	                $('#empId').val(newEmpId); // Set the incremented value
	            }
			},
        error: function(xhr, status, error) {
            console.error('Error fetching last inserted empid data:', error);
            console.log('Error fetching last inserted empid data. Please try again.');
        }
    });
}

function toggleView22() {
    var addRoleDiv = document.getElementById('addRole');
    var tableViewDiv = document.getElementById('tableView2');
    var button = document.getElementById('toggleAddButton');
    var empListDiv = document.getElementById('empListId2');
    var imageView = document.getElementById('imageView2');
    
    $('#search-bar1').show();
	$('#search-bar2').hide();
    
    addRoleDiv.style.display = 'none';
    empListDiv.style.display = 'block'
    tableViewDiv.style.display = 'block';
    imageView.style.display="none";
    $('#employeeJourneyDiv').hide();
}
</script>
<!-- script to enable and disable the list view and image view -->
<script>
function toggleEmpCards22() {
    var imageView = document.getElementById('imageView');
    var tableView = document.getElementById('tableView');
    var listImageViewButton = document.getElementById('listImageViewButton');
    
    $('#employeeJourneyDiv').hide();
    
    if (imageView.style.display === 'none' || imageView.style.display === '') {
        imageView.style.display = 'block';
        tableView.style.display = 'none';
        listImageViewButton.textContent = 'List View';
        $('#toggleAttendanceButton').hide();
        $('#toggleDisablePermissionsButton').hide();
        $('#toggleAppraisalButton').hide();
    } else {
        imageView.style.display = 'none';
        tableView.style.display = 'block';
        listImageViewButton.textContent = 'Image View';
        $('#toggleAttendanceButton').show();
        $('#toggleDisablePermissionsButton').show();
        $('#toggleAppraisalButton').hide();
    }
}


function toggleEmpJourney22(){
	$('#employeeJourneyDiv').show();
	$('#empListId2').hide();
	$('#addRole').hide();
	
	$('#search-bar1').hide();
	$('#search-bar2').show();
	
	document.getElementById('loadingPopup').style.display = 'flex';
	$.ajax({
        url: '/fetchAllEmployeeDetails', // Your backend URL for saving the CTC offer
        type: 'GET',
        success: function (response) {
      	  updateEmployeeJourneyDetailsData(response);
      	document.getElementById('loadingPopup').style.display = 'none';
        },
        error: function (xhr, status, error) {
            alert('Failed to fetch Employee journey Lists: ' + error);
            document.getElementById('loadingPopup').style.display = 'none';
        }
    });
}


function updateEmployeeJourneyDetailsData(data){
	var viewEmpJourneyTBody = document.getElementById('viewEmpJourneyTBody');
	
	var formattedDate;
	  
	viewEmpJourneyTBody.innerHTML = ''; 
	  
	  if (data && data.length > 0) {
	      for (var i = 0; i < data.length; i++) {
	    	  
	    	  var empType, empTypeStyle, lastWorkingDay, journeyYears = '-', journeyYearTextStyle, inActiveReason = '-';
	    	  
	    	  if(data[i].employee_type === '1'){
	    		  empType = 'Active';
	    		  empTypeStyle = 'text-primary border border-primary';
	    		  journeyYearTextStyle = 'text-success';
	    	  }else{
	    		  empType = 'In-active';
	    		  empTypeStyle = 'text-danger border border-danger';
	    		  journeyYearTextStyle = 'text-danger';
	    	  }
	    	  
	    	  if(data[i].in_active_reason){
	    		  inActiveReason = data[i].in_active_reason;
	    	  }
	    	  
	    	  if(data[i].last_working_date){
	    		  lastWorkingDay = data[i].last_working_date;
	    	  }else{
	    		  lastWorkingDay = '-';
	    	  }
	    	  
	    	  if (data[i].doj) {
	                var doj = new Date(data[i].doj);
	                var endDate = data[i].last_working_date ? new Date(data[i].last_working_date) : new Date();
	                
	                //console.log("doj = "+doj);
	                //console.log("endDate = "+endDate);

	                var years = endDate.getFullYear() - doj.getFullYear();
	                var months = endDate.getMonth() - doj.getMonth();
	                var days = endDate.getDate() - doj.getDate();
	                
	                //console.log("years = "+years);
	                //console.log("months = "+months);
	                //console.log("days = "+days);

	                if (days < 0) {
	                    months -= 1;
	                    days += new Date(endDate.getFullYear(), endDate.getMonth(), 0).getDate();
	                    
	                    //console.log("months in days < 0 = "+months);
		                //console.log("days in days < 0 = "+days);
	                }

	                if (months < 0) {
	                    years -= 1;
	                    months += 12;
	                    
	                    //console.log("years in months < 0 = "+years);
		                //console.log("months in months < 0 = "+months);
	                }
	                
	                //console.log("(years + months / 12) = "+(years + months / 12));
	                //console.log("(years + months / 12).toFixed(1) = "+(years + months / 12).toFixed(1));

	                //journeyYears = (years + months / 12).toFixed(1); // Calculate precise years with months
	                
	                journeyYears = years + " year(s), " + months + " month(s), " + days +" day(s)";
	                
	                //console.log("journeyYears = "+journeyYears);
	            }
	    	  
	          var row = "<tr class='custom_tr'>" +
		              	"<td>" + (i+1) + "</td>" +
		              	"<td style='min-width: 150px;'><span class='" + empTypeStyle + "' style='font-weight: bold; padding: 2px 8px; border-radius: 50px;'>" + empType + "</span></td>" +
		              	"<td>" + data[i].empid + "</td>" +
		              	"<td>" + data[i].deptName + "</td>" +
		              	"<td>" + data[i].roleName + "</td>" +
		              	"<td>" + data[i].fullName + "</td>" +
		              	"<td class='" + journeyYearTextStyle + "' style='min-width: 240px;'>" + journeyYears + "</td>" +
		              	"<td style='min-width: 100px;' class='dateColumn dateFormatter'>" + data[i].doj + "</td>" +
		              	"<td style='min-width: 150px;' class='dateColumn dateFormatter'>" + lastWorkingDay + "</td>" +
		              	"<td style='min-width: 200px;'>" + inActiveReason + "</td>" +
		              	"</tr>";

		              	viewEmpJourneyTBody.innerHTML += row; //Append row HTML
	      }
	      
	   	  // Format dates after all rows are appended
	      formatDates22();
	      
	  } else {
	      var noDataRow = "<tr><td colspan='12'>No data available</td></tr>";
	      viewEmpJourneyTBody.innerHTML = noDataRow; // Display 'No data available'
	  }
}


function formatDates22() {
    var dateElements = document.querySelectorAll('.dateFormatter');
    dateElements.forEach(function(dateElement) {
        var dateStr = dateElement.innerText; // Get the date string in yyyy-mm-dd format
        var dateParts = dateStr.split('-'); // Split the date string into parts
        
        // Format the date as dd-mm-yyyy
        if(dateParts.length === 3) {
            var formattedDate = dateParts[2] + '-' + dateParts[1] + '-' + dateParts[0];
            // Update the text of the date element
            dateElement.innerText = formattedDate;
        }
    });
}

</script>










<!-- script to fetch the designation based on selected department -->
<!-- <script>
function fetchDesignations(deptId) {
     if(deptId) {
    	 alert(deptId);
        fetch(`/getDesignations?deptId=${deptId}`)
            .then(response => response.json())
            .then(data => {
            	alert(JSON.stringify(data));
                let designationSelect = document.getElementById('roleId');
                designationSelect.innerHTML = '<option value="" selected>Select Designation</option>';
                data.forEach(designation => {
                    let option = document.createElement('option');
                    option.value = designation.role_id;
                    option.text = designation.roleName;
                    designationSelect.add(option);
                });
            })
            .catch(error => console.error('Error fetching designations:', error));
    }
     fetchSubDepartment(deptId);
}
function fetchSubDepartment(deptId) {
    if(deptId) {
       fetch(`/getSubDepartment?deptId=${deptId}`)
           .then(response => response.json())
           .then(data => {
           	console.log(data);
           })
           .catch(error => console.error('Error fetching designations:', error));
   }
}
</script> -->


<!-- script to notification -->
<!-- script to notification -->
<!-- <script>
// Function to fetch flag value from the backend
function fetchFlag() {
    $.get("/flag", function(response) {
        var leaveRequestCountValue = response; 
        console.log(leaveRequestCountValue);
        // If total notification count is greater than 0, show the bell icon and notifications
        if (leaveRequestCountValue.leaveRequestFlagCount > 0) {
            $("#notificationBellIcon").show();  // Show bell icon
            $("#leaveRequestNotification").show();  // Show specific notification
            
            $("#leaveRequestMessage").text(leaveRequestCountValue.leaveRequestFlagCount + " leave request(s)");
            $(".badge-number").text(leaveRequestCountValue.leaveRequestFlagCount);
            $("#leaveRequestFlagCount").text(leaveRequestCountValue.leaveRequestFlagCount);
        }  
        
        //display the asset notifu=ication based on asset count value
        if(leaveRequestCountValue.asseteRequestFlagCount>0){
        	 
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#assetRequestNotification").show();  // Show specific notification
             
             $("#assetRequestMessage").text(leaveRequestCountValue.asseteRequestFlagCount + " asset request(s)");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#asseteRequestFlagCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        	 	
        }      
        
        //display the new project notification based on asset count value
        if(leaveRequestCountValue.newPrjectValueCount>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#newProjectNotification").show();  // Show specific notification
             
             $("#newProjectMessage").text(leaveRequestCountValue.newPrjectValueCount + " project request(s)");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
        
        //display the appraisal from HR notification
        if(leaveRequestCountValue.appraisalCount>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#hrAppraisal").show();  // Show specific notification
             
             $("#newProjectMessage").text(leaveRequestCountValue.appraisalCount + " Appraisal Form");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
        
        //display the appraisal from employee notification 
        if(leaveRequestCountValue.empAppraisalflag>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#empAppraisal").show();  // Show specific notification
             
             $("#apprisalempNotification").text(leaveRequestCountValue.empAppraisalflag + " employees sent appraisal");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
        
        //display the appraisal Due date notification 
        if(leaveRequestCountValue.adminAppraisalDuedate>0){
        	 $("#dueAppraisal").show();  // Show bell icon
             $("#empAppraisal").show();  // Show specific notification
             
             $("#apprisalDueNotification").text("Tomorrow is the due date for submit appraisal");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
    });
}

// Periodically fetch flag value every second (adjust as needed)
setInterval(fetchFlag, 1000);

</script>

  script to notification link redirect
<script th:inline="javascript">
    function redirectToLeaveRequest() {
        var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
        window.location.href = '/viewAdminLeaves?empid=' + empid;
    }
    function redirectToAsset() {
        //var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
        window.location.href = '/asset';
    }
    function redirectToProject() {
        //var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
        window.location.href = '/ongoingProject';
    }
    function redirectToAppraisal() {
    	var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
    	window.location.href = '/apprisal?empid=' + empid;
    }
    function redirectToemployeeAppraisal() {
		var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
		window.location.href = '/employeeApprisal?empid=' + empid;
	}
</script> -->





<!-- script for profile pic -->
<script>
$.ajax({
    type: "GET",
    url: "fetchEmployeeDocumentDetailsOnlyByEmpId",
    data: {
        "emp_id": $('#emp_idSessionValue').val()
    },
    success: function(data) {
    	console.log("++++data"+JSON.stringify(data));
        $('#dynamicProfilePic').attr('src', `${data.profilePicPath}`);
    },
    error: function(xhr, status, error) {
        console.error("Error invoking data:", error);
    }
});
</script>

<!-- script for spinner -->
<script>
window.addEventListener('load', function () {
    const loadingPopup = document.getElementById('loadingPopup');
    const mainContent = document.getElementById('mainContent');
    
    // Add a fade-out effect for the loading popup
    loadingPopup.style.transition = 'opacity 0.5s ease';
    loadingPopup.style.opacity = '0';
    
    setTimeout(() => {
        loadingPopup.style.display = 'none'; // Hide the popup after fade-out
        mainContent.style.display = 'block'; // Show the main content
    }, 500); // Match the transition duration
});
</script>


<!-- script to search box for unapproved text box -->
<script>

document.querySelector('.searchUnprovedTable').addEventListener('click', function () {
    document.querySelector('.searchUnprovedTable_inputSearch').focus();
  });

    function searchUnprovedTable() {
        
    	var input, filter, table, tr, td, i, j, txtValue;
        
        input = document.querySelector(".searchUnprovedTable_inputSearch");
        filter = input.value.toUpperCase();
        
        //table = document.getElementById("customTable");
        table = document.querySelector("#employeeTable");
        if (!table) return;
        
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
            tr[i].style.display = "none";
            td = tr[i].getElementsByTagName("td");
            for (j = 0; j < td.length; j++) {
                if (td[j]) {
                    txtValue = td[j].textContent || td[j].innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                        break;
                    }
                }
            }
        }
    }    
</script>

<!-- Script to search table -->
<script>

document.querySelector('.btn-search').addEventListener('click', function () {
    document.querySelector('.input-search').focus();
  });

    function searchTableForEmpList() {
        
    	var input, filter, table, tr, td, i, j, txtValue;
        
        input = document.querySelector(".input-search");
        filter = input.value.toUpperCase();
        
        //table = document.getElementById("customTable");
        table = document.querySelector(".tableSearch");
        if (!table) return;
        
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
            tr[i].style.display = "none";
            td = tr[i].getElementsByTagName("td");
            for (j = 0; j < td.length; j++) {
                if (td[j]) {
                    txtValue = td[j].textContent || td[j].innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                        break;
                    }
                }
            }
        }
    }
    
    
    document.querySelector('.btn-search2').addEventListener('click', function () {
        document.querySelector('.input-search2').focus();
      });

        function searchTableForEmpJourney() {
            
        	var input, filter, table, tr, td, i, j, txtValue;
            
            input = document.querySelector(".input-search2");
            filter = input.value.toUpperCase();
            
            //table = document.getElementById("customTable");
            table = document.querySelector(".tableSearch2");
            if (!table) return;
            
            tr = table.getElementsByTagName("tr");
            for (i = 1; i < tr.length; i++) {
                tr[i].style.display = "none";
                td = tr[i].getElementsByTagName("td");
                for (j = 0; j < td.length; j++) {
                    if (td[j]) {
                        txtValue = td[j].textContent || td[j].innerText;
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                            tr[i].style.display = "";
                            break;
                        }
                    }
                }
            }
        }
        
        
        document.querySelector('.btn-search3').addEventListener('click', function () {
            document.querySelector('.input-search3').focus();
          });

            function searchTableForLeaveBalance() {
                
            	var input, filter, table, tr, td, i, j, txtValue;
                
                input = document.querySelector(".input-search3");
                filter = input.value.toUpperCase();
                
                //table = document.getElementById("customTable");
                table = document.querySelector(".tableSearch3");
                if (!table) return;
                
                tr = table.getElementsByTagName("tr");
                for (i = 1; i < tr.length; i++) {
                    tr[i].style.display = "none";
                    td = tr[i].getElementsByTagName("td");
                    for (j = 0; j < td.length; j++) {
                        if (td[j]) {
                            txtValue = td[j].textContent || td[j].innerText;
                            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                tr[i].style.display = "";
                                break;
                            }
                        }
                    }
                }
            }
            
            
            document.querySelector('.btn-search4').addEventListener('click', function () {
                document.querySelector('.input-search4').focus();
              });

                function searchTableForPermissionList() {
                    
                	var input, filter, table, tr, td, i, j, txtValue;
                    
                    input = document.querySelector(".input-search4");
                    filter = input.value.toUpperCase();
                    
                    //table = document.getElementById("customTable");
                    table = document.querySelector(".tableSearch4");
                    if (!table) return;
                    
                    tr = table.getElementsByTagName("tr");
                    for (i = 1; i < tr.length; i++) {
                        tr[i].style.display = "none";
                        td = tr[i].getElementsByTagName("td");
                        for (j = 0; j < td.length; j++) {
                            if (td[j]) {
                                txtValue = td[j].textContent || td[j].innerText;
                                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                    tr[i].style.display = "";
                                    break;
                                }
                            }
                        }
                    }
                }
    </script>

<!-- script to open missspunch popup -->
<!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->
  <script src="assets/js/jquery-3.6.4.min.js"></script> 
  
<script>
function openPopup(empId) {
    const dateList = document.getElementById('missingPunchDatesList');
    const noMissedPunchesMessage = document.getElementById('noMissedPunchesMessage');
    
    // Clear any previous list items
    dateList.innerHTML = '';

    // Make AJAX request to get missing punch dates for the employee
    fetch(`/getMispunchDAteByEmid?empid=${empId}`)
        .then(response => response.json())  // Parse JSON response
        .then(missingPunchDates => {
            // Check if there are missing punch dates
            if (missingPunchDates.length === 0) {
                noMissedPunchesMessage.style.display = 'block';
            } else {
            	noMissedPunchesMessage.style.display = 'none';
                // Populate the missing punch dates list
                missingPunchDates.forEach(date => {
                    // Create a new list item
                    const listItem = document.createElement('li');
                    listItem.classList.add('list-item'); // Add a class for styling
                    
                    // Create a span to hold the date
                    const dateSpan = document.createElement('span');
                    dateSpan.textContent = date;

                    // Create a "Fill" button
                    const fillButton = document.createElement('button');
                    fillButton.textContent = 'Fill';
                    fillButton.classList.add('btn', 'btn-primary','m-2'); // Bootstrap classes
                    
                    // Add an event listener for the button
                    fillButton.addEventListener('click', function() {
                    	  fillPunch(date, event,empId);
                    });

                    // Append elements to the list item
                    listItem.appendChild(dateSpan);
                    listItem.appendChild(fillButton);
                    
                    // Append the list item to the date list
                    dateList.appendChild(listItem);
                });
            }
        })
        .catch(error => {
            console.error('Error fetching missing punch dates:', error);
        });

    // Show the popup
    document.getElementById('missingPunchDatesPopup').style.display = 'flex';
}


function closePopup() {
    document.getElementById('missingPunchDatesPopup').style.display = 'none';
}

let previousFillButton = null; // Variable to store the previously clicked "Fill" button

function fillPunch(date, event,empId) {
    if (!event || !event.target) {
        console.error('Event object is undefined.');
        return;
    }

    // Show the previously hidden "Fill" button, if any
    if (previousFillButton) {
        previousFillButton.style.display = 'inline-block';
    }

    // Hide the clicked "Fill" button
    const fillButton = event.target;
    fillButton.style.display = 'none';

    // Update the reference to the currently clicked button
    previousFillButton = fillButton;

    // Remove existing time picker if present
    const existingTimePicker = document.getElementById('timePicker');
    if (existingTimePicker) {
        existingTimePicker.remove();
    }

    // Create a div to hold the time picker and button
    const timePickerContainer = document.createElement('div');
    timePickerContainer.id = 'timePicker';
    timePickerContainer.classList.add('time-picker-container');

    // Create time input field
    const timeInput = document.createElement('input');
    timeInput.type = 'time';
    timeInput.classList.add('form-control', 'm-2');
    timeInput.required = true;

    // Create submit button
    const submitButton = document.createElement('button');
    submitButton.textContent = 'Submit';
    submitButton.classList.add('btn', 'btn-success', 'm-2');

    // Handle submit button click
    submitButton.addEventListener('click', function () {
        const selectedTime = timeInput.value;
        if (!selectedTime) {
            alert('Please select a time!');
            return;
        }
        
         const extractedDate = date.split('|')[0].replace('Date:', '').trim(); 

	     // Convert "dd-mm-yyyy" to "yyyy-mm-dd"
	     const [day, month, year] = extractedDate.split('-');
	     const formattedDate = `${year}-${month}-${day}`;
        sendPunchToBackend(formattedDate, selectedTime, fillButton, timePickerContainer,empId);
        
    });

    // Append input and button to container
    timePickerContainer.appendChild(timeInput);
    timePickerContainer.appendChild(submitButton);

    // Append container below the clicked button's parent
    fillButton.parentElement.appendChild(timePickerContainer);

    // Apply animation
    setTimeout(() => {
        timePickerContainer.style.opacity = 1;
        timePickerContainer.style.transform = 'translateY(0px)';
    }, 50);
}

function sendPunchToBackend(date, time, fillButton, timePickerContainer,empId) {

	 $.ajax({
	        url: '/fillPunch',
	        type: 'POST',
	        contentType: 'application/json',
	        data: JSON.stringify({
	            empId: empId,
	            date: date,
	            time: time
	        }),
	        success: function (data) {
	            if (data.success) {
	                alert('Punch filled successfully for ' + date + ' to ' + time);
	                timePickerContainer.parentElement.remove(); // Remove the entire row (list item)
	            } else {
	                alert('Failed to fill punch: ' + data.message);
	                fillButton.style.display = 'inline-block'; // Show "Fill" button again on failure
	            }
	        },
	        error: function (xhr, status, error) {
	            console.error('Error filling punch:', error);
	            fillButton.style.display = 'inline-block'; // Show "Fill" button again on failure
	        }
	    });
}

</script>
<!-- script to notification on bottom of the page-->
<!--CHAT BOOT-->

		<!-- Include SockJS and Stomp.js libraries -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.3.0/sockjs.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

<!-- script to notification on bottom of the page-->
<script>
		//CODE FOR CHATBOOT NOTIFICATION 
		var stompClient = null;
		var employeeMap = {}; // To store the mapping of employee names to emails
		let employeePhotoMap = {};
		let emailToNameMap = {}; // New map for email -> name lookup
		var email = null;
		var visibilityState = document.visibilityState; // Track tab visibility
		var heartbeatInterval = null; // Track heartbeat interval

		function connectWebSocket() {
			
			var socket = new SockJS('/chat-websocket');
						  stompClient = Stomp.over(socket);

						  var email = document.getElementById('loggedInMail').value;
						  console.log(`Connecting WebSocket as: ${email}`);

						  stompClient.connect({ 'email': email }, function (frame) {
						      console.log('Connected to WebSocket:', frame);

							 // subscribeToTypingEvents();
						      // Mark user as active
						      stompClient.send("/app/userConnected", {}, JSON.stringify({ email }));

						      // Subscribe to active users list
						      stompClient.subscribe('/topic/activeUsers', function (message) {
						          var activeUsers = JSON.parse(message.body);
						          updateActiveUserUI(activeUsers);
						      });
							  // Subscribe to user messages
							        stompClient.subscribe('/user/queue/messages', function (message) {
									//	loadMessages();
									//	alert("po2");
							            console.log('Raw WebSocket Message:11', message);
							            var msg = JSON.parse(message.body);
										//alert(msg);
							            console.log('Parsed Messag111e:', msg);
							            console.log(`Received messagesdsd: ${JSON.stringify(msg)}`);
										//alert("(message.read"+msg.read);
									
							            // Display message if it matches the selected employee
							            if (selectedEmployee === msg.senderEmail || selectedEmployee === msg.recipientEmail) {
											console.log(`New message fromss ${msg.senderEmail}: ${msg.content}`);
											console.log("plk "+selectedEmployee);
											console.log("plk "+msg.senderEmail);
											console.log("plk "+msg.recipientEmail);
											//loadMessages();
							                showMessage(
							                    msg.id,               // Message ID
							                    msg.senderEmail,      // Sender's email
							                    msg.content,          // Message content
							                    msg.recipientEmail,   // Recipient's email
							                    msg.timestamp,        // Message timestamp
							                    email,
												msg.read                    // Logged-in user's email
							                );
							            }
								
										loadEmployees();
										loadMessages();
									 	
							        });

							        // Subscribe to notifications
							        stompClient.subscribe('/user/queue/notifications', function (notification) {
										//alert("00");
							            console.log('New Notification:', notification.body);
							            showToastNotification(notification.body);
										loadEmployees();
										//alert("01");
							        });

									//alert("Subscribing to chat updates...");
									stompClient.subscribe('/user/queue/messages', function (message) {
									    console.log('WebSocket Chat Update Received:', message.body); // Log raw message

									    let parsedMessage = JSON.parse(message.body);
									    console.log('Parsed Message:', parsedMessage); // Log parsed JSON

									    if (Array.isArray(parsedMessage)) {
									        parsedMessage.forEach(msg => {
									            console.log(`Message ID: ${msg.id}, Read: ${msg.read}`);
									            if (msg.read) {
									                updateMessageUI(msg);
									            }
									        });
									    } else {
									        console.log("Unexpected message format:", parsedMessage);
									    }

									    // Refresh messages after a delay
									    setTimeout(() => {
									        console.log("Refreshing messages...");
									        loadMessages();
									    }, 3000);
									});

									stompClient.subscribe('/topic/typing', function (message) {
									    console.log(" Typing notification received:", message.body);

									    let typingData;
									    try {
									        typingData = JSON.parse(message.body);
									        console.log(" Parsed Typing Data:", typingData);
									    } catch (error) {
									        console.error(" Error parsing typing notification message:", error);
									        return;
									    }

									    let loggedInUserEmail = document.getElementById('loggedInMail')?.value;
									    if (!loggedInUserEmail) return;

									    if (loggedInUserEmail === typingData.recipientEmail && typingData.senderEmail === selectedEmployee) {
									        // Fetch actual typing status from the backend
									        fetch(`/getTypingStatus?senderEmail=${typingData.senderEmail}&recipientEmail=${typingData.recipientEmail}`)
									            .then(response => response.json())
									            .then(data => {
									                console.log(" Actual Typing Status from DB:", data.typing);
													console.log(" Actual Typing Status from DB:", data);
													                console.log(" Typing Status (0 or 1):", data.typing);
													                
									                let chatMessages = document.querySelector(".chat-history ul");
									                let chatContainer = document.querySelector(".chat-history"); // The scrollable chat area

									                let typingIndicator = document.getElementById("typingIndicator");
									                
									                if (!typingIndicator) {
									                    typingIndicator = document.createElement("li");
									                    typingIndicator.id = "typingIndicator";
									                    typingIndicator.classList.add("typing-indicator");
									                    typingIndicator.innerHTML = `
									                        <img src="${employeePhotoMap[selectedEmployee] || 'default-profile.jpg'}" alt="User Photo" class="typing-photo">
									                        <span>Typing...</span>
									                    `;
									                    chatMessages.appendChild(typingIndicator);
									                }

									                if (data.typing === 1) { // Ensure it checks the latest typing status
									                    typingIndicator.style.display = "flex";

									                    // Move typing indicator to the bottom
									                    chatMessages.appendChild(typingIndicator);

									                    // Auto-scroll to the bottom
									                    setTimeout(() => {
									                        chatContainer.scrollTop = chatContainer.scrollHeight;
									                    }, 100);
									                } else {
									                    typingIndicator.style.display = "none";
									                }
									            })
									            .catch(error => console.error(" Error fetching typing status:", error));
									    }
									});


						      // Start heartbeat initially
						      heartbeatInterval = setInterval(() => {
						          if (stompClient && stompClient.connected) {
						              stompClient.send("/app/userHeartbeat", {}, JSON.stringify({ email }));
						              console.log("Heartbeat sent for user: " + email);
						          }
						      }, 20000); // 30 seconds

						      // Detect tab visibility change
						  /*    document.addEventListener("visibilitychange", function () {
						          if (document.hidden) {
						              console.log("User switched to another tab. Marking as inactive.");
						              stompClient.send("/app/userInactive", {}, JSON.stringify({ email }));
						              clearInterval(heartbeatInterval); // Stop heartbeat
						              heartbeatInterval = null;
						          } else {
						              console.log("User returned to the application tab. Marking as active.");
						              stompClient.send("/app/userConnected", {}, JSON.stringify({ email }));
						              if (!heartbeatInterval) {
						                  heartbeatInterval = setInterval(() => {
						                      if (stompClient && stompClient.connected) {
						                          stompClient.send("/app/userHeartbeat", {}, JSON.stringify({ email }));
						                          console.log("Heartbeat sent for user: " + email);
						                      }
						                  }, 30000);
						              }
						          }
						      });*/

						      // Detect tab close or WebSocket disconnect
						      socket.onclose = function () {
						          console.log("WebSocket disconnected. Updating user status.");
						          stompClient.send("/app/userDisconnected", {}, JSON.stringify({ email }));
						      };

						      window.addEventListener('beforeunload', function () {
						          stompClient.send("/app/userDisconnected", {}, JSON.stringify({ email }));
						      });

						  });
		}

		function updateActiveUserUI(activeUsers) {
		//	alert("1");
		    const employeeItems = document.getElementById('employeeNames').getElementsByTagName('li');

		    Array.from(employeeItems).forEach(item => {
		        const employeeName = item.querySelector('span').textContent;
		        const email = employeeMap[employeeName]; 
		        const statusIndicator = item.querySelector('.status-indicator'); // Get the status dot

		        if (activeUsers.includes(email)) {
		            item.classList.add('active-user');
		            statusIndicator.style.backgroundColor = '#66cc66'; // Green for active users
		        } else {
		            item.classList.remove('active-user');
		            statusIndicator.style.backgroundColor = '#ff6666'; // Red for inactive users
		        }

		        // If this employee is currently selected, update chat header status
				if (selectedEmployee === email) {
				           const chatStatusIndicator = document.getElementById('chatStatusIndicator');
				           if (activeUsers.includes(email)) {
				               chatStatusIndicator.style.backgroundColor = '#66cc66'; // Green (Online)
				           } else {
				               chatStatusIndicator.style.backgroundColor = '#ff6666'; // Red (Offline)
				           }
				       }
		    });
		}


		// Select an employee to chat with
		function selectEmployee(employeeName) {
			selectedEmployee = employeeMap[employeeName]; // Get the email from the map
			console.log(`Employee selected: ${selectedEmployee}`);

			// Highlight the selected employee
			var employeeItems = document.querySelectorAll('#employeeNames li');
			employeeItems.forEach(function (item) {
				item.classList.remove('active');
			});
			var selectedItem = Array.from(employeeItems).find(item => item.innerHTML === employeeName);
			if (selectedItem) {
				selectedItem.classList.add('active');
			}

			// Update chat header with employee name and photo
			document.querySelector('.chat-about h6').innerText = employeeName;
			document.querySelector('#employeePhoto').src = employeePhotoMap[selectedEmployee] || 'default-profile.jpg';

			// Hide the message icon and dots when an employee is selected
			document.getElementById('message-icon-container').style.display = 'none';
			// Hide the paragraph when an employee is selected
			document.getElementById('logo-text').style.display = 'none';

			// Load messages for the selected employee
			loadMessages();
		}

		function loadEmployees() {
			console.log("Loading employee names...");

			// Fetch employee names from the endpoint
			fetch('/employees/names')
				.then(response => {
					console.log("Response received:", response);
					if (!response.ok) {
						throw new Error(`HTTP error! status: ${response.status}`);
					}
					return response.json();
				})
				.then(data => {
					console.log("Employee data fetched:", data); // Log the raw data

					const employeeList = document.getElementById('employeeNames');
					if (!employeeList) {
						console.error("Element with ID 'employeeNames' not found.");
						return;
					}

					employeeList.innerHTML = ''; // Clear the list before adding new items

					// Iterate through employee data
					data.forEach(employee => {
						console.log("Processing employee:", employee);

						// Create a list item for each employee
						const li = document.createElement('li');
						li.classList.add('d-flex', 'align-items-center', 'employee-item');

						// Handle missing or empty profile photo paths
						const profilePic = employeePhotoMap[employee.email] || '/static/default-profile.jpg';
						console.log(`Profile picture for ${employee.name}: ${profilePic}`);

						li.innerHTML = `
			                    <img src="${profilePic}" 
			                         alt="Employee Photo" 
			                         class="employee-photo mr-2" />
			                    <span>${employee.name}</span>
			                `;

						// Map employee name to email
						employeeMap[employee.name] = employee.email;
						console.log("Mapped employee:", employee.name, "->", employee.email);
						// Add new reverse mapping (email -> name)
						emailToNameMap[employee.email] = employee.name;
						// Add click event to list item
						li.onclick = () => {
							console.log(`Selected employee: ${employee.name}`);
							selectEmployee(employee.name);
						};

						// Append the list item to the employee list
						employeeList.appendChild(li);

					});

					console.log("Employee names loaded successfully. Employee map:", employeeMap);
					// Call the unread messages function after loading employee data
					fetchUnreadMessages();

					// Set interval to check for new messages every 10 seconds
						setInterval(fetchUnreadMessages, 10000);
				})
				.catch(error => {
					console.error("Error loading employees:", error);
				});
		}


		function loadMessages() {
			// alert("Loading messages...");
			// Get the logged-in user's email and selected employee's email
			var loggedInEmail = document.getElementById('loggedInMail').value;
			var selectedEmployeeEmail = selectedEmployee; // Email is already stored in selectedEmployee

			console.log(`Loading messages between: ${loggedInEmail} and ${selectedEmployeeEmail}`);

			fetch(`/messages?loggedInEmail=${encodeURIComponent(loggedInEmail)}&selectedEmployeeEmail=${encodeURIComponent(selectedEmployeeEmail)}`)
				.then(response => response.json())
				.then(data => {
					console.log("Chat messages loaded:", data);
					// Clear the chat window before displaying messages
					var chatWindow = document.getElementById('chat-window').querySelector('ul');
					chatWindow.innerHTML = '';

					// Display messages
					data.forEach(function (msg) {
						// showMessage(msg.senderEmail, msg.content, msg.recipientEmail, loggedInEmail);
						showMessage(msg.id, msg.senderEmail, msg.content, msg.recipientEmail, msg.timestamp, loggedInEmail);
					});
				})
				.catch(error => console.error("Error loading chat messages:", error));
		}
		let activeDeleteDropdown = null;
		function showMessage(id, senderEmail, message, recipientEmail, timestamp, loggedInEmail) {
			console.log("Message ID:", id);
			console.log(`LoggedInEmailrrr: ${loggedInEmail}, SenderEmail: ${senderEmail}`);

			const isSender = senderEmail === loggedInEmail;
			const senderName = isSender ? "Me" : Object.keys(employeeMap).find(name => employeeMap[name] === senderEmail) || senderEmail;
			const senderPhoto = employeePhotoMap[senderEmail] || 'default-avatar.png';
			const formattedTime = new Date(timestamp).toLocaleString(); // Format timestamp

			console.log(`Message ID: ${id}, Time: ${formattedTime}, From: ${senderEmail}, To: ${recipientEmail}, Content: "${message}"`);

			var chatWindow = document.getElementById('chat-window').querySelector('ul');
			var li = document.createElement('li');
			li.className = isSender ? 'clearfix right' : 'clearfix left';

			li.innerHTML = `
					    <div class="message-container" data-message-id="${id}" onclick="toggleDeleteOption(this)">
					        <img class="sender-photo" src="${senderPhoto}" alt="Sender Photo" />
					        <div class="message ${isSender ? 'my-message' : 'other-message'}">
					            <strong>${senderName}:</strong> ${message}
					        </div>
					    </div>
					    <div class="timestamp" style="text-align: ${isSender ? 'right' : 'left'};">
					        ${formattedTime}
					    </div>
					    ${isSender ? `
					        <div class="message-action-dropdown" >
					            <a class="dropdown-item" href="#" onclick="deleteMessage(this, ${id})">Delete Message</a>
					        </div>
					    ` : ''}`;

			chatWindow.appendChild(li);
			chatWindow.scrollTop = chatWindow.scrollHeight;
		}
		
		/*function fetchUnreadMessages() {
			console.log("Fetching unread messages...");
			var loggedInEmail = document.getElementById('loggedInMail').value;

			fetch(`/unread?email=${loggedInEmail}`)
				.then(response => response.json())
				.then(messages => {
					messages.forEach(message => {
						let senderName = emailToNameMap[message.senderEmail] || message.senderEmail;

						// Show notification with sender's email as a parameter
						showToastNotification(`New message from ${senderName}: ${message.content}`, message.senderEmail);
					});
				})
				.catch(error => console.error("Error fetching unread messages:", error));
		}*/

		let displayedMessageIds = new Set(); // Track displayed messages
		let closedMessageIds = new Set(); // Track closed messages

		function fetchUnreadMessages() {
		    console.log("Fetching unread messages...");
		    var loggedInEmail = document.getElementById('loggedInMail').value;

		    fetch(`/unread?email=${loggedInEmail}`)
		        .then(response => response.json())
		        .then(messages => {
		            messages.forEach(message => {
		                console.log("Processing message ID:", message.id); // Print message ID to console
		                
		                // Ignore messages that were previously closed
		                if (!displayedMessageIds.has(message.id) && !closedMessageIds.has(message.id)) {
							//alert(1);
		                    let senderName = emailToNameMap[message.senderEmail] || message.senderEmail;
		                    showToastNotification(`New message from ${senderName}: ${message.content}`, message.id, message.senderEmail);
		                    displayedMessageIds.add(message.id); // Mark message as displayed
		                }
						//alert(2);
		            });
		        })
		        .catch(error => console.error("Error fetching unread messages:", error));
		}
		// Global flag to track if the user manually dismissed notifications
		
		/*function showToastNotification(message, senderEmail) {
			
			var toastContainer = document.createElement('div');
			toastContainer.className = 'toast-notification';

			// Add message and close button
			toastContainer.innerHTML = `<p>${message}</p> <span class="toast-close"></span>`;

			document.body.appendChild(toastContainer);

			// Animate in
			setTimeout(() => {
				toastContainer.classList.add('show');
			}, 100);

			// Auto-hide after 8 seconds
			let autoHideTimeout = setTimeout(() => closeToast(toastContainer), 10000);

			// Prevent opening chat when clicking the close button
			toastContainer.querySelector('.toast-close').addEventListener('click', (event) => {
				event.stopPropagation(); // Prevent click from bubbling to toastContainer
				clearTimeout(autoHideTimeout);
				
				closeToast(toastContainer);
			});

			// Open chat when clicking on the notification
			toastContainer.addEventListener('click', () => {
				openChatWithSender(senderEmail);
				closeToast(toastContainer); // Remove notification when chat opens
			});
		}*/
		function showToastNotification(message, messageId, senderEmail) {
			//alert(1);
		    var toastContainer = document.createElement('div');
		    toastContainer.className = 'toast-notification';
		    toastContainer.innerHTML = `<p>${message}</p> <span class="toast-close"></span>`;

		    document.body.appendChild(toastContainer);

		    // Animate in
		    setTimeout(() => {
		        toastContainer.classList.add('show');
		    }, 100);

		    // Auto-hide after 8 seconds
		    let autoHideTimeout = setTimeout(() => closeToast(toastContainer, messageId), 8000);

		    // Prevent opening chat when clicking the close button
		    toastContainer.querySelector('.toast-close').addEventListener('click', (event) => {
		        event.stopPropagation(); // Prevent click from bubbling to toastContainer
		        clearTimeout(autoHideTimeout);
		        closedMessageIds.add(messageId); // Mark as closed so it won't be shown again
		        closeToast(toastContainer, messageId);
		    });

		    // Open chat when clicking on the notification
		    toastContainer.addEventListener('click', () => {
		        openChatWithSender(senderEmail);
		        closeToast(toastContainer, messageId); // Remove notification when chat opens
		    });
		}

		// Function to handle toast closing
		/*function closeToast(toast) {
			toast.classList.remove('show');
			setTimeout(() => toast.remove(), 300); // Faster fade-out
		}*/
		// Function to handle toast closing and mark as dismissed
		// Function to handle toast closing
		function closeToast(toast, messageId) {
		    toast.classList.remove('show');
		    setTimeout(() => toast.remove(), 300); // Faster fade-out
		}
		/*	function openChatWithSender(senderEmail) {
				console.log("Opening chat with:", senderEmail);
			    
				// Construct the URL for the UserFavorite page with the senderEmail as a query parameter
				const url = `/my-favorites?email=${encodeURIComponent(senderEmail)}`;
			    
				// Redirect to the UserFavorite page
				window.location.href = url;
			}*/

		function openChatWithSender(senderEmail) {
			console.log("Opening chat with:", senderEmail);

			// Store sender email in sessionStorage
			sessionStorage.setItem("chatSenderEmail", senderEmail);

			// Redirect to the UserFavorite page
			window.location.href = `/my-favorites`;
		}

		// Connect to the WebSocket server and load employees when the page is loaded
		document.addEventListener('DOMContentLoaded', function () {
			//fetchUnreadMessages();
			loadEmployees();
			connectWebSocket();
		});

	</script>
	
	<script>
    // Get today's date in the format YYYY-MM-DD
    const today = new Date().toISOString().split('T')[0];
    
    // Set the min attribute of the date input
    document.getElementById("attendanceFilterFromDate").setAttribute("max", today);
    document.getElementById("attendanceFilterToDate").setAttribute("max", today);
    document.getElementById("attendanceFilterFromDate2").setAttribute("max", today);
    document.getElementById("attendanceFilterToDate2").setAttribute("max", today);
    
    function checkEmpIdPresentOrNot(empId){
    	//alert(empId);
    	$.ajax({
            type: 'GET', 
            url: 'isEmpIdAlreadyPresentOrNot', 
            data: {
            	empid: empId
            },
            success: function(data) {
            	//alert(data);
            	if(data === true){
            		$('#empId_error').text("Employee ID already exists!");
            		$('#empDetailsSubmitBtn').prop('disabled', true);
            	}else{
            		$('#empId_error').text("");
            		$('#empDetailsSubmitBtn').prop('disabled', false);
            	}
    		},
            error: function(xhr, status, error) {
                console.error('Error fetching empid is present or not:', error);
                console.log('Error fetching empid is present or not. Please try again.');
            }
        });
    }
</script>

<script>
	function closeLeaveBalanceUpdateOuterDiv(){
		//document.body.style.overflow = 'auto';
		openLeaveBalancePopup();
		$('#leaveBalanceUpdateOuterDiv').hide();
	}
	
	function openLeaveBalanceUpdateOuterDiv(){
		$('#updateLeaveBalanceDepatmentListDropdown').val('');
		$('#updateLeaveBalancePopupEmpName').val('');
		$('#updateLeaveBalancePopupLeaveDetailsBox').hide();
		$('#updateLeaveBalancePopupLeaveTypeBox').hide();
		$('#sl_Radio_button').prop('checked', false);
		$('#cl_Radio_button').prop('checked', false);
		$('#el_Radio_button').prop('checked', false);
		$('#sick_leave_updated_balance').val('');
		$('#casual_leave_updated_balance').val('');
		$('#earned_leave_updated_balance').val('');
		//$('#updateLeaveBalanceFormBox').hide();
		document.body.style.overflow = 'hidden';
		$('#leaveBalanceUpdateOuterDiv').show();
	}
	
	function fetchLeaveBalanceForClickedEmployeeIdInLeaveBalanceUpdatePopup(empId){
		$('#sick_leave_updated_balance').val('');
		$('#casual_leave_updated_balance').val('');
		$('#earned_leave_updated_balance').val('');
		$('#updateLeaveBalancePopupBtn').prop('disabled', true);
		const current_financial_year = getCurrentFinancialYear();
		$.ajax({
            url: '/getEmployeesLeaveBalanceDataByUsingEmpId', 
            type: 'GET',
            data: {
            	current_financial_year: current_financial_year,
            	empId: empId
            	},
            success: function (response) {
            	$('#slRemainingSpanPopup').text(response.sl);
            	$('#clRemainingSpanPopup').text(response.cl);
            	$('#elRemainingSpanPopup').text(response.el);
            	$('#updateLeaveBalancePopupLeaveDetailsBox').show();
            	$('#updateLeaveBalancePopupLeaveTypeBox').show();
            },
            error: function (xhr, status, error) {
                alert('Failed to fetching the Leave Balance details: ' + error);
            }
        });
	}
	
	/* function displayUpdateLeaveBalanceForm(clickedRadioBtn){
		$('#updateLeaveBalanceFormBox').show();
		if(clickedRadioBtn === "sl_Radio_button"){
			$('#casual_leave_updated_balance').val('');
			$('#earned_leave_updated_balance').val('');
			$('#updateEarnedLeaveBalanceBox').hide();
			$('#updateCasualLeaveBalanceBox').hide();
			$('#updateSickLeaveBalanceBox').show();
		}else if(clickedRadioBtn === "cl_Radio_button"){
			$('#sick_leave_updated_balance').val('');
			$('#earned_leave_updated_balance').val('');
			$('#updateEarnedLeaveBalanceBox').hide();
			$('#updateSickLeaveBalanceBox').hide();
			$('#updateCasualLeaveBalanceBox').show();
		}else if(clickedRadioBtn === "el_Radio_button"){
			$('#sick_leave_updated_balance').val('');
			$('#casual_leave_updated_balance').val('');
			$('#updateCasualLeaveBalanceBox').hide();
			$('#updateSickLeaveBalanceBox').hide();
			$('#updateEarnedLeaveBalanceBox').show();
		}
	} */
	
	function updateLeaveBalanceToBackend(sickLeave, casualLeave, earnedLeave, remarks) {
	    let errorMessage = "", validLeaveBalance = {}, validLeaveType = [], validEmpIdValue = "";
	    
	    // Check if the Sick Leave input is visible and validate it
	    /* if ($("#updateSickLeaveBalanceBox").is(":visible")) {
	        let sickLeaveValue = $("#sick_leave_updated_balance").val();
	        if (sickLeaveValue === "" || sickLeaveValue === null) {
	            errorMessage += "Please enter a valid Sick Leave balance\n";
	        }
	        leaveBalanceFetchedValue = $('#slRemainingSpanPopup').text();
	    }

	    // Check if the Casual Leave input is visible and validate it
	    if ($("#updateCasualLeaveBalanceBox").is(":visible")) {
	        let casualLeaveValue = $("#casual_leave_updated_balance").val();
	        if (casualLeaveValue === "" || casualLeaveValue === null) {
	            errorMessage += "Please enter a valid Casual Leave balance\n";
	        }
	        leaveBalanceFetchedValue = $('#clRemainingSpanPopup').text();
	    }

	    // Check if the Earned Leave input is visible and validate it
	    if ($("#updateEarnedLeaveBalanceBox").is(":visible")) {
	        let earnedLeaveValue = $("#earned_leave_updated_balance").val();
	        if (earnedLeaveValue === "" || earnedLeaveValue === null) {
	            errorMessage += "Please enter a valid Earned Leave balance\n";
	        }
	        leaveBalanceFetchedValue = $('#elRemainingSpanPopup').text();
	    }*/

	        if (sickLeave !== "" || sickLeave !== null) {
	        	let sickLeaveBalanceFetchedValue = $('#slRemainingSpanPopup').text();
	        	
	        	if (parseFloat(sickLeave) <= parseFloat(sickLeaveBalanceFetchedValue)) {
	        		errorMessage += "Entered sick leave balance should be greater than the current sick leave balance!\n\n";
	    	    }else {
	                validLeaveType.push("Sick Leave");
	                validLeaveBalance["sick_leave"] = parseFloat(sickLeave);
	            }
	        }
	    
		    if (casualLeave !== "" || casualLeave !== null) {
	        	let casualLeaveBalanceFetchedValue = $('#clRemainingSpanPopup').text();
	        	
	        	if (parseFloat(casualLeave) <= parseFloat(casualLeaveBalanceFetchedValue)) {
	        		errorMessage += "Entered casual leave balance should be greater than the current casual leave balance!\n\n";
	    	    }else {
	                validLeaveType.push("Casual Leave");
	                validLeaveBalance["casual_leave"] = parseFloat(casualLeave);
	            }
	        }
		    
		    if (earnedLeave !== "" || earnedLeave !== null) {
	        	let earnedLeaveBalanceFetchedValue = $('#elRemainingSpanPopup').text();
	        	
	        	if (parseFloat(earnedLeave) <= parseFloat(earnedLeaveBalanceFetchedValue)) {
	        		errorMessage += "Entered earned leave balance should be greater than the current earned leave balance!\n\n";
	    	    }else {
	                validLeaveType.push("Earned Leave");
	                validLeaveBalance["earned_leave"] = parseFloat(earnedLeave);
	            }
	        }
	    
		 	// If there is any validation error, show an alert and stop the function
		    if (errorMessage !== "") {
		        alert(errorMessage);
		        return;
		    }

		    /* if(sickLeave){
		    	validLeaveBalance = sickLeave;
		    	validLeaveType = "Sick Leave";
		    }else if(casualLeave){
		    	validLeaveBalance = casualLeave;
		    	validLeaveType = "Casual Leave";
		    }else if(earnedLeave){
		    	validLeaveBalance = earnedLeave;
		    	validLeaveType = "Earned Leave";
		    }*/
	    
	    validEmpIdValue = $('#updateLeaveBalancePopupEmpName').val();
	    
	    const current_financial_year = getCurrentFinancialYear();
		$.ajax({
            url: 'updateOrInsertLeaveBalanceBasedOnEmpid?empid=' + validEmpIdValue + '&current_financial_year=' + current_financial_year+ '&remarks=' + remarks, 
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({
                clickedLeaveType: validLeaveType,
                validLeaveBalance: validLeaveBalance
            }),
            success: function (response) {
            	fetchLeaveBalanceForClickedEmployeeIdInLeaveBalanceUpdatePopup(validEmpIdValue);
            	alert(response);
            },
            error: function (xhr, status, error) {
                alert('Failed to updating the Leave Balance details: ' + error);
            }
        }); 
	}

</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const form = document.querySelector("#updateLeaveBalanceFormBox");
    const submitButton = document.getElementById("updateLeaveBalancePopupBtn");
    const inputs = form.querySelectorAll("input[type='number']");

    form.addEventListener("input", function() {
        let isAnyFieldFilled = Array.from(inputs).some(input => input.value.trim() !== "");
        if (isAnyFieldFilled) {
            submitButton.removeAttribute("disabled");
        } else {
            submitButton.setAttribute("disabled", "disabled");
        }
    });
});
</script>

<script>
	function showLoadingPopup(){
		displayOnLoadingPopup();
	}
	
	function validateEmpRegisterFormForOnBlur(){
		var submitBtn = document.getElementById('empDetailsSubmitBtn');
		
		const onlyCharPatternWithSpace = /^[a-zA-Z\s]+$/;
		const onlyNumberPattern = /^[0-9]+$/; // Should not contain alphabets or any special characters
		
		var firstName = document.getElementById('first_name').value.trim();
		var firstNameError = document.getElementById('firstName_error');
		
		var lastName = document.getElementById('last_name').value.trim();
		var lastNameError = document.getElementById('lastName_error');
		
		var mobile_no = document.getElementById('mobile_no').value.trim();
		var mobile_error = document.getElementById('mobile_error');
		
		var father_name = document.getElementById('father_name').value.trim();
		var fatherName_error = document.getElementById('fatherName_error');
		
		var mother_name = document.getElementById('mother_name').value.trim();
		var motherName_error = document.getElementById('motherName_error');
		
		var aadhar = document.getElementById('aadhar').value.trim();
		var aadhar_error = document.getElementById('aadhar_error');
		
		var isValid = true; // Track overall form validity
		
		if (firstName.length > 0 && !onlyCharPatternWithSpace.test(firstName)) {
			firstNameError.innerHTML = "Please enter only characters";
			firstNameError.style.fontSize = "14px";
			firstNameError.style.fontWeight = "bold";
			firstNameError.style.color = "#EC7063";
			isValid = false; // Mark form as invalid
		}else {
			firstNameError.innerHTML = ""; // Clear error message if valid
	    }
		
		if (lastName.length > 0 && !onlyCharPatternWithSpace.test(lastName)) {
			lastNameError.innerHTML = "Please enter only characters";
			lastNameError.style.fontSize = "14px";
			lastNameError.style.fontWeight = "bold";
			lastNameError.style.color = "#EC7063";
			isValid = false; // Mark form as invalid
		}else {
			lastNameError.innerHTML = ""; // Clear error message if valid
	    }
		
		if (mobile_no.length > 0 && !onlyNumberPattern.test(mobile_no)) {
			mobile_error.innerHTML = "Please enter only digits without space";
			mobile_error.style.fontSize = "14px";
			mobile_error.style.fontWeight = "bold";
			mobile_error.style.color = "#EC7063";
			isValid = false; // Mark form as invalid
		}else {
			mobile_error.innerHTML = ""; // Clear error message if valid
	    }
		
		if (father_name.length > 0 && !onlyCharPatternWithSpace.test(father_name)) {
			fatherName_error.innerHTML = "Please enter only characters";
			fatherName_error.style.fontSize = "14px";
			fatherName_error.style.fontWeight = "bold";
			fatherName_error.style.color = "#EC7063";
			isValid = false; // Mark form as invalid
		}else {
			fatherName_error.innerHTML = ""; // Clear error message if valid
	    }
		
		if (mother_name.length > 0 && !onlyCharPatternWithSpace.test(mother_name)) {
			motherName_error.innerHTML = "Please enter only characters";
			motherName_error.style.fontSize = "14px";
			motherName_error.style.fontWeight = "bold";
			motherName_error.style.color = "#EC7063";
			isValid = false; // Mark form as invalid
		}else {
			motherName_error.innerHTML = ""; // Clear error message if valid
	    }
		
		if (aadhar.length > 0 && !onlyNumberPattern.test(aadhar)) {
			aadhar_error.innerHTML = "Please enter only digits without space";
			aadhar_error.style.fontSize = "14px";
			aadhar_error.style.fontWeight = "bold";
			aadhar_error.style.color = "#EC7063";
			isValid = false; // Mark form as invalid
		}else {
			aadhar_error.innerHTML = ""; // Clear error message if valid
	    }
		
		// Enable or disable the submit button based on form validity
	    submitBtn.disabled = !isValid;
	}
</script>

<script>
function attendanceFilterTypeChosen(attendanceFilterTypeValue){
	
	if(attendanceFilterTypeValue === "allAttendance"){
		$('#filterAllAttendanceBox').show();
		$('#filterAttendanceByEmpNameBox').hide();
		//$('#attendanceReportTableBox').html("");
		$('#attendanceFilterToDate').val("");
		$('#attendanceFilterFromDate').val("");
		$('#attendanceReportDepatmentListDropdown').val("");
		$('#attendanceFilterEmpName').val("");
		//$('#attendanceFilterMonthANdYear2').val("");
		$('#attendanceFilterToDate2').val("");
		$('#attendanceFilterFromDate2').val("");
	}else{
		$('#filterAllAttendanceBox').hide();
		$('#filterAttendanceByEmpNameBox').show();
		//$('#attendanceReportTableBox').html("");
		//$('#attendanceFilterMonthANdYear').val("");
		$('#attendanceFilterToDate').val("");
		$('#attendanceFilterFromDate').val("");
		$('#attendanceReportDepatmentListDropdown').val("");
		$('#attendanceFilterEmpName').val("");
		//$('#attendanceFilterMonthANdYear2').val("");
		$('#attendanceFilterToDate2').val("");
		$('#attendanceFilterFromDate2').val("");
	}
	
	
	
	/* switch(attendanceFilterTypeValue){	
		case "allAttendance": 
			fetchAllAttendanceReport($('#attendanceFilterMonthANdYear').val());
			break;
		case "attendanceByEmpName":
			fetchAttendanceReportBasedOnEmpId($('#attendanceFilterEmpName').val(), $('#attendanceFilterMonthANdYear2').val());
			break;
		default:
			console.log("attendance report generator condition not matched");
			break;
		} */
	}

attendanceFilterTypeChosen("allAttendance");


function displayAttendanceFilterPopup(data){
	resetFilterPopup();
	
		//$('#attendanceReportTableBox').html("");
		//$('#attendanceFilterMonthANdYear').val("");
		//$('#attendanceReportDepatmentListDropdown').val("");
		//$('#attendanceFilterEmpName').val("");
		//$('#attendanceFilterMonthANdYear2').val("");
	
		//$('#attendanceReportTableBox').html("");
		$('#attendanceFilterToDate').val("");
		$('#attendanceFilterFromDate').val("");
		$('#attendanceReportDepatmentListDropdown').val("");
		$('#attendanceFilterEmpName').val("");
		//$('#attendanceFilterMonthANdYear2').val("");
		$('#attendanceFilterToDate2').val("");
		$('#attendanceFilterFromDate2').val("");
	
	if(data === "Employee Attendance"){
		//console.log("Leave datataattata ==== "+JSON.stringify(leaveRequestDetails));
		
		$('#attendanceListsOuterDiv').show();
	}
	
	/* var today = new Date();
    var maxDate = today.toISOString().split('T')[0];
    var maxMonth = today.toISOString().slice(0, 7);
    
    document.getElementById('attendanceFilterMonthANdYear').setAttribute('max', maxMonth);
    document.getElementById('attendanceFilterMonthANdYear2').setAttribute('max', maxMonth); */
}

function closeAttendanceListsOuterDiv(){
	$('#attendanceListsOuterDiv').hide();
}
</script>

<script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
<script>
let fetchedEmpAttendanceDetails = [];
let fetchedEmpIdsForAttendanceReport = [];
let holidayData = [];
let probationCompletedDatesWithEmpId = [];
let secondSaturdays = [];
let fourthSaturdays = [];
let leaveRequestDetails = [];


async function fetchAttendanceReportBasedOnEmpId(emp_id, attendanceFilterFromDate, attendanceFilterToDate){
	
	fetchedEmpAttendanceDetails = [];
	fetchedEmpIdsForAttendanceReport = [];
	holidayData = [];
	probationCompletedDatesWithEmpId = [];
	secondSaturdays = [];
	fourthSaturdays = [];
	
	//alert(emp_id+" "+monthAndYear);
	
	/* if($('#attendanceReportDepatmentListDropdown').val() === ""){
		alert("Please select department");
		return;
	}
	
	if($('#attendanceFilterEmpName').val() === ""){
		alert("Please select employee name");
		return;
	}
	
	if($('#attendanceFilterMonthANdYear2').val() === ""){
		alert("Please select month and year");
		return;
	}
	
	// Split the 'monthAndYear' string into year and month
    var parts = monthAndYear.split('-');
    var year = parts[0];
    var month = parts[1];
    
 	// Get the number of days in the month dynamically
    var daysInMonth = new Date(year, month, 0).getDate(); */
    
	if($('#attendanceReportDepatmentListDropdown').val() === ""){
		alert("Please select department");
		return;
	}
	
	if($('#attendanceFilterEmpName').val() === ""){
		alert("Please select employee name");
		return;
	}
    
    
	if(attendanceFilterFromDate === ""){
		alert("Please select from date");
		return;
	}
	
	if(attendanceFilterToDate === ""){
		alert("Please select to date");
		return;
	}
    
	
	document.getElementById('loadingPopup').style.display = 'flex';
    
    try {
        const response = await $.ajax({
            url: '/getAllAttendanceReportBasedOnStartAndEndDateAndEmpId',
            type: 'GET',
            data: {
                startDate: attendanceFilterFromDate,
                endDate: attendanceFilterToDate,
                emp_id: emp_id,
            }
        });
        fetchedEmpAttendanceDetails.push(response);
        await updateAttendanceReportTableForAll(response, attendanceFilterFromDate, attendanceFilterToDate);
        document.getElementById('loadingPopup').style.display = 'none';
    } catch (error) {
    	document.getElementById('loadingPopup').style.display = 'none';
        alert('Failed to fetch the attendance report data: ' + error);
    }
    
	
	/* $.ajax({
        url: '/getAttendanceReportByEmpId', 
        type: 'GET',
        data: {
        	month: month,
        	year: year,
        	emp_id: emp_id
        	},
        success: function (response) {
        	//console.log(response);
        	updateAttendanceReportTableByUsingEmpId(response, daysInMonth, monthAndYear);
        },
        error: function (xhr, status, error) {
            alert('Failed to fetching the attendance report data: ' + error);
        }
    }); */
}


async function fetchAllAttendanceReport(fromDate, toDate) {
	
	fetchedEmpAttendanceDetails = [];
	fetchedEmpIdsForAttendanceReport = [];
	holidayData = [];
	probationCompletedDatesWithEmpId = [];
	secondSaturdays = [];
	fourthSaturdays = [];
	
	if(fromDate === ""){
		alert("Please select from date");
		return;
	}
	
	if(toDate === ""){
		alert("Please select to date");
		return;
	}
	
	document.getElementById('loadingPopup').style.display = 'flex';
	
    try {
        const response = await $.ajax({
            url: '/getAllAttendanceReportBasedOnStartAndEndDate',
            type: 'GET',
            data: {
                startDate: fromDate,
                endDate: toDate,
            }
        });
        //alert(JSON.stringify(response));
        fetchedEmpAttendanceDetails.push(response);
        await updateAttendanceReportTableForAll(response, fromDate, toDate);
        document.getElementById('loadingPopup').style.display = 'none';
    } catch (error) {
    	document.getElementById('loadingPopup').style.display = 'none';
        alert('Failed to fetch the attendance report data: ' + error);
    }
}

async function updateAttendanceReportTableForAll(data, fromDate, toDate) {
    const uniqueEmpIdsSet = new Set();

    if (data && data.length > 0) {
        for (let i = 0; i < data.length; i++) {
            uniqueEmpIdsSet.add(data[i].eid);
        }
    }

    fetchedEmpIdsForAttendanceReport = Array.from(uniqueEmpIdsSet);

    await fetchHolidays(); // Wait for holidays to be fetched
    await fetchProbationDate(fromDate, toDate); // Wait for probation dates to be fetched

    if (holidayData != null) {
        generateExcel(fromDate, toDate, fetchedEmpAttendanceDetails[0], holidayData, secondSaturdays, fourthSaturdays);
    }
}

async function fetchHolidays() {
    try {
        const response = await fetch(`/holidayCalendar`);
        const data = await response.json();
        holidayData = data;
        //console.log("Holidays fetched: ", holidayData);
    } catch (error) {
        console.error('Error fetching holidays:', error);
    }
}

async function fetchProbationDate(fromDate, toDate) {
    try {
        const response = await $.ajax({
            url: '/getProbationDateAsAGroup',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(fetchedEmpIdsForAttendanceReport),
        });
        //alert(JSON.stringify(response));
        probationCompletedDatesWithEmpId.push(response);
        calculateSaturdays(fromDate, toDate);
    } catch (error) {
        alert('Failed to fetch probation dates: ' + error);
    }
}


function calculateSaturdays(fromDate, toDate) {
    // Convert fromDate and toDate to Date objects
    const fromDateObj = new Date(fromDate);
    const toDateObj = new Date(toDate);

    // Iterate over each employee in the probationCompletedDatesWithEmpId array
    probationCompletedDatesWithEmpId[0].forEach(emp => {
        const empId = emp.empid;
        const probationDate = new Date(emp.probation_completed_date);

        // Extend probation date by 2 years
        const extendedDate = new Date(probationDate);
        extendedDate.setFullYear(extendedDate.getFullYear() + 2);

        // Debugging the extended probation date
        //console.log(`EmpID: ${empId}, Extended Probation Date: ${extendedDate.toDateString()}`);

        // Generate Saturdays within the range
        for (let year = fromDateObj.getFullYear(); year <= toDateObj.getFullYear(); year++) {
            for (let month = 0; month < 12; month++) {
                // Get all Saturdays in the month
                const saturdays = [];
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                for (let day = 1; day <= daysInMonth; day++) {
                    const currentDate = new Date(year, month, day);
                    if (currentDate.getDay() === 6) { // Saturday
                        saturdays.push(currentDate);
                    }
                }

                // Debugging the found Saturdays
                //console.log(`Saturdays in ${month + 1}/${year}:`, saturdays);

                // Add the second Saturday if it exists and is after the extended probation date
                if (saturdays.length >= 2 && saturdays[1] >= extendedDate) {
                    secondSaturdays.push({ empId, date: saturdays[1].toLocaleDateString('en-GB') });
                }

                // Add the fourth Saturday if it exists and is after the extended probation date
                if (saturdays.length >= 4 && saturdays[3] >= extendedDate) {
                    fourthSaturdays.push({ empId, date: saturdays[3].toLocaleDateString('en-GB') });
                }
            }
        }
    });

    // Debugging the final arrays
    //console.log("Second Saturdays:"+ JSON.stringify(secondSaturdays));
    //console.log("Fourth Saturdays:"+ JSON.stringify(fourthSaturdays));
}



function generateExcel(fromDate, toDate, attendanceData, holidayData, secondSaturdays, fourthSaturdays) {
	// Helper function to format a date to dd-mm-yyyy
    function formatDate(date) {
        const d = new Date(date);
        const day = String(d.getDate()).padStart(2, '0');
        const month = String(d.getMonth() + 1).padStart(2, '0');
        const year = d.getFullYear();
        return `${day}-${month}-${year}`;
    }
	
    // Convert fromDate and toDate to Date objects
    const startDate = new Date(fromDate);
    const endDate = new Date(toDate);

    const headers = ["Employee Name", "EID"];
    let currentDate = new Date(startDate);
    const dateHeaders = [];

    while (currentDate <= endDate) {
        const formattedDate = formatDate(currentDate);
        headers.push(formattedDate);
        dateHeaders.push(formattedDate);
        currentDate.setDate(currentDate.getDate() + 1);
    }
    
    headers.push("Total Days");
    headers.push("Total Leaves");
    headers.push("Total LOP");

    // Prepare rows for Excel
    const employeeMap = {};
    let lopMap = {};

    // Map attendance data to employee records
    attendanceData.forEach(record => {
        const { emp_name, eid, pd, punch_in, punch_out } = record;

        if (!employeeMap[eid]) {
            employeeMap[eid] = {
                "Employee Name": emp_name,
                EID: eid,
            };
        }
        
        const formattedDate = formatDate(pd);

        lopMap[eid] = {};  // Initialize LOP map for each employee

        const punchInTime = punch_in ? new Date(`1970-01-01T${punch_in}`) : null;
        const punchOutTime = punch_out ? new Date(`1970-01-01T${punch_out}`) : null;

        // Calculate time difference in hours
        let attendanceStatus = "A";  // Default to Absent if no punch_in/punch_out
        if (punchInTime && punchOutTime) {
            const hoursWorked = (punchOutTime - punchInTime) / (1000 * 60 * 60);
            if (hoursWorked >= 2.5 && hoursWorked <= 6) {
                attendanceStatus = "Half";
            } else if (hoursWorked > 6) {
                attendanceStatus = "P";
            } else if (hoursWorked < 2.5) {
                attendanceStatus = "A";
            }
        }
        
     	// Check for leave overlap and override status if applicable
        leaveRequestDetails.forEach(leave => {
        	// console.log("leave dattaatta === "+JSON.stringify(leave));
            const leaveStart = new Date(leave.from_date);
            const leaveEnd = new Date(leave.to_date);
            const leaveDate = new Date(pd);
            const eidMatch = leave.empid === eid;
            const leaveApproved = leave.approvedstatus === "Approved";
            const isInLeaveRange = leaveDate >= leaveStart && leaveDate <= leaveEnd;
            const leaveType = leave.leave_type;
            
            if (leaveType === "LOP" && leaveApproved && eidMatch) {
            	// console.log("lopDates ===== ");
            	if (!lopMap[eid]) {
                    lopMap[eid] = {}; // Initialize if not already present
                }
            	
            	let currentDate = new Date(leaveStart); // Start from the beginning of the leave

                while (currentDate <= leaveEnd) {
                    const formattedDate = formatDate(currentDate);
                    // console.log("lopDates ===== "+formattedDate);
                    lopMap[eid][formattedDate] = "LOP";

                    // Move to next day
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            }
            
            if (eidMatch && leaveApproved && isInLeaveRange) {
            	if (leave.leave_duration === "Full Day") {
                    if (!punch_in || !punch_out) {
                        attendanceStatus = "A";
                    } else {
                        const hoursWorked = (punchOutTime - punchInTime) / (1000 * 60 * 60);
                        if (hoursWorked >= 2.5 && hoursWorked <= 6) {
                            attendanceStatus = "Half";
                        } else if (hoursWorked > 6) {
                            attendanceStatus = "P";
                        } else {
                            attendanceStatus = "A";
                        }
                    }
                } else if (leave.leave_duration === "Half Day") {
                    attendanceStatus = "Half";
                }
            }
        });

        // Store attendance status for the specific day
        employeeMap[eid][formattedDate] = attendanceStatus;
    });
    
    //console.log("lopMap dattaatta === "+JSON.stringify(lopMap));
    
 	// Handle holidays, Sundays, and Second Saturdays
    const holidayDates = holidayData.map(date => new Date(date.date).toDateString());

    Object.keys(employeeMap).forEach(eid => {
        
        const secondSaturdayDates = secondSaturdays
        .filter(entry => entry.empId === eid)
        .map(entry => parseDateForSSAndFS(entry.date).toDateString());
            
        const fourthSaturdayDates = fourthSaturdays
        .filter(entry => entry.empId === eid)
        .map(entry => parseDateForSSAndFS(entry.date).toDateString());

        for (let i = 0; i < dateHeaders.length; i++) {
            const currentDay = new Date(startDate);
            currentDay.setDate(currentDay.getDate() + i);
            const currentDayString = currentDay.toDateString();
            const formattedDate = dateHeaders[i];

            // Check and assign special cases
            if (holidayDates.includes(currentDayString)) {
                employeeMap[eid][formattedDate] = "MSPL Holiday"; // Holiday
            }

            if (currentDay.getDay() === 0) {
                employeeMap[eid][formattedDate] = "S"; // Sunday
            }

            if (secondSaturdayDates.includes(currentDayString)) {
                employeeMap[eid][formattedDate] = "SS"; // Second Saturday
            }

            if (fourthSaturdayDates.includes(currentDayString)) {
                employeeMap[eid][formattedDate] = "FS"; // Fourth Saturday
            }

            // If no attendance info and not already marked, mark as Absent
            if (!employeeMap[eid][formattedDate]) {
                employeeMap[eid][formattedDate] = "A";
            }
        }
        
    });
    
    const totalDaysCount = Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;

    const rows = Object.keys(employeeMap).map(eid => {
        const record = employeeMap[eid];
        const row = [];
        let totalLeaves = 0;
        let totalLop = 0;
        
        //console.log("lopMap === "+JSON.stringify(lopMap));

        headers.forEach(header => {
            if (header === "Total Days") {
                row.push(totalDaysCount);
            } else if (header === "Total Leaves") {
                row.push(totalLeaves);
            } else if (header === "Total LOP") {
                row.push(totalLop);
            } else {
                let value = record[header] || "";

                // Check LOP from LOP map
                if (lopMap[eid] && lopMap[eid][header] === "LOP") {
                	value = "LOP";
                    totalLop += 1;
                }

                if (value === "A") {
                    totalLeaves += 1;
                } else if (value === "Half") {
                    totalLeaves += 0.5;
                }

                row.push(value);
            }
        });
        return row;
    });
    
    // Include headers as the first row
    rows.unshift(headers);

    // Create a workbook and add the data
/*     const workbook = XLSX.utils.book_new();
    const worksheet = XLSX.utils.aoa_to_sheet(rows);

    const range = XLSX.utils.decode_range(worksheet['!ref']);

    for (let R = 1; R <= range.e.r; ++R) { // Skip header row
        for (let C = 2; C <= range.e.c - 3; ++C) { // Customize range as needed
            const cellRef = XLSX.utils.encode_cell({ r: R, c: C });
            const cell = worksheet[cellRef];

            if (!cell) continue;

            if (cell.v === "S") {
                cell.s = {
                    fill: { patternType: "solid", fgColor: { rgb: "FFA500" } }, // Orange for Sunday
                    font: { color: { rgb: "FFFFFF" }, bold: true }
                };
            } else if (cell.v === "H") {
                cell.s = {
                    fill: { patternType: "solid", fgColor: { rgb: "808080" } }, // Gray for Holiday
                    font: { color: { rgb: "FFFFFF" }, bold: true }
                };
            } else if (cell.v === "SS" || cell.v === "FS") {
                cell.s = {
                    fill: { patternType: "solid", fgColor: { rgb: "87CEEB" } }, // Light blue for Saturdays
                    font: { color: { rgb: "000000" }, bold: true }
                };
            } else if (cell.v === "A") {
                cell.s = {
                    fill: { patternType: "solid", fgColor: { rgb: "FF0000" } }, // Red for Absent
                    font: { color: { rgb: "FFFFFF" }, bold: true }
                };
            }
        }
    }
    
    XLSX.utils.book_append_sheet(workbook, worksheet, "Attendance Report");
    // Export the workbook as an Excel file
    XLSX.writeFile(workbook, `Attendance_Report_${fromDate}_to_${toDate}.xlsx`); */
    
    
    const workbook = new ExcelJS.Workbook();
    const worksheet = workbook.addWorksheet('Attendance Report');

    // Add headers
    worksheet.addRow(headers);
    
    worksheet.getRow(1).eachCell(cell => {
        cell.alignment = { horizontal: 'center', vertical: 'middle' };
    });

    // Add rows
    rows.slice(1).forEach(rowData => {
        worksheet.addRow(rowData);
    });
    
    // Apply styles
    worksheet.eachRow((row, rowNumber) => {
        if (rowNumber === 1) return; // Skip header row
        row.eachCell((cell, colNumber) => {
        	cell.alignment = { horizontal: 'center', vertical: 'middle' };
            if (colNumber > 2 && colNumber < row.cellCount - 2) { // date cells only
            	// Apply center alignment
                switch (cell.value) {
                    case "S": // Sunday
                        cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FF0000' }
                        };
                        cell.font = { bold: true, color: { argb: 'FFFFFF' } };
                        break;
                    case "MSPL Holiday": // Holiday
                        /* cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'ffffcc' }
                        }; */
                        cell.font = { bold: true, color: { argb: '009900' } };
                        break;
                    case "SS":
                    case "FS":
                        /* cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: '87CEEB' }
                        }; */
                        cell.font = { bold: true, color: { argb: '0000FF' } };
                        break;
                    case "A":
                        /* cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FF0000' }
                        }; */
                        cell.font = { bold: true, color: { argb: 'FF0000' } };
                        break;
                    case "Half":
                        /* cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FF0000' }
                        }; */
                        cell.font = { bold: true, color: { argb: 'FF0000' } };
                        break;
                    case "LOP":
                        /* cell.fill = {
                            type: 'pattern',
                            pattern: 'solid',
                            fgColor: { argb: 'FF0000' }
                        }; */
                        cell.font = { bold: true, color: { argb: 'FFA500' } };
                        break;
                }
            }
        });
    });

    // Export file
    workbook.xlsx.writeBuffer().then((buffer) => {
        const blob = new Blob([buffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `Attendance_Report_${fromDate}_to_${toDate}.xlsx`;
        link.click();
    });
}

function parseDateForSSAndFS(dateString) {
    const [day, month, year] = dateString.split("/").map(Number);
    // JavaScript months are 0-based, so subtract 1 from the month
    return new Date(year, month - 1, day);
}

/* function updateAttendanceReportTableByUsingEmpId(response, daysInMonth, monthAndYear){
	 // Dynamically create the table
    var tableHtml = '<table class="table table-hover" id="attendanceReportTable2"><thead class="fixTHead"><tr><th>Emp Name</th>';
    
    // Create the table header with day numbers based on the number of days in the month
    for (var i = 1; i <= daysInMonth; i++) {
        tableHtml += '<th>' + i + '</th>';
    }
    tableHtml += '</tr></thead><tbody>';

        tableHtml += '<tr><td>' + response.emp_name + '</td>';
        
        // Loop through each day (1 to daysInMonth) and display attendance status (A or P)
        for (var i = 1; i <= daysInMonth; i++) {
            var dayKey = 'day' + i;
            var status = response[dayKey] || 'N/A';  //If no status, show 'N/A'
            tableHtml += '<td>' + status + '</td>';
        }
        tableHtml += '</tr>';

    tableHtml += '</tbody></table>';

    // Append the generated table to the 'attendanceReportTableBox' div
    $('#attendanceReportTableBox').html(tableHtml);
    
    const filenameInput = prompt("Enter a filename to export data");
    const filename = filenameInput && filenameInput.trim() ? filenameInput : 'EmployeeAttendanceData';
    
    exportAttendanceReportTableToExcel('attendanceReportTable2', filename);
} */



function exportAttendanceReportTableToExcel(tableID, filename) {
    // Get the table element by its ID
    const table = document.getElementById(tableID);
    const rows = Array.from(table.rows);

    // Extract table data into a 2D array
    const data = rows.map(row => 
        Array.from(row.cells).map(cell => cell.innerText)
    );

    // Create a workbook
    const ws = XLSX.utils.aoa_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Attendance Report');

    // Save the workbook
    XLSX.writeFile(wb, `${filename}.xlsx`);
}
	
</script>

<!-- script to fetch the designation based on selected department -->
<script>
function fetchDesignations(deptId) {
	//alert(deptId);
     if(deptId) {
        fetch(`/getDesignation?deptId=${deptId}`)
            .then(response => response.json())
            .then(data => {
            	//alert(JSON.stringify(data));
                let designationSelect = document.getElementById('roleId');
                designationSelect.innerHTML = '<option value="" selected>Select Designation</option>';
                data.forEach(designation => {
                    let option = document.createElement('option');
                    option.value = designation.role_id;
                    option.text = designation.roleName;
                    designationSelect.add(option);
                });
            })
            .catch(error => console.error('Error fetching designations:', error));
    }
     fetchSubDepartment(deptId);
     //getTeamCoAndTeamLeadNames(deptId);
     getSubDeptNames(deptId);
}

function fetchSubDepartment(deptId) {
    if(deptId) {
       fetch(`/getSubDepartments?deptId=${deptId}`)
           .then(response => response.json())
           .then(data => {
           	console.log(data);
               
           })
           .catch(error => console.error('Error fetching designations:', error));
   }
}

function getTeamCoAndTeamLeadNames(dept_id){
	/* $.ajax({
        type: "GET",
        url: "/fetchTeamCoNameByUsingDeptId",
        data: { "dept_id": dept_id },
        success: function(data) {
        	//alert(JSON.stringify(data));
        	updateTeamCoNames(data);
        },
        error: function(xhr, status, error) {
        	console.error('Error fetching data:', error);
			console.log('Error fetching data. Please try again.');
        }
    }); */
	
	
	$.ajax({
        type: "GET",
        url: "/fetchTeamLeadNameByUsingDeptId",
        //data: { "dept_id": dept_id },
        success: function(data) {
        	//console.log("Empppppp === "+JSON.stringify(data));
        	updateTeamLeadNames(data);
        	updateTeamCoNames(data);
        },
        error: function(xhr, status, error) {
        	console.error('Error fetching data:', error);
			console.log('Error fetching data. Please try again.');
        }
    });
}

function getSubDeptNames(dept_id){
	$.ajax({
        type: "GET",
        url: "/fetchSubDeptNameByUsingDeptId",
        data: { "dept_id": dept_id },
        success: function(data) {
        	//alert(JSON.stringify(data));
        	updateSubDeptNames(data);
        },
        error: function(xhr, status, error) {
        	console.error('Error fetching data:', error);
			console.log('Error fetching data. Please try again.');
        }
    });
}

/* function updateTeamCoNames(data){
	let teamCoSelect = document.getElementById('team_co_name');
	teamCoSelect.innerHTML = '<option value="" selected>Select Project Coordinator</option>';
    data.forEach(teamCo => {
        let option = document.createElement('option');
        option.value = teamCo.empid;
        option.text = teamCo.team_co_name;
        teamCoSelect.add(option);
    });
} */

function updateTeamCoNames(data){
	let teamCoSelect = document.getElementById('team_co_name');
	teamCoSelect.innerHTML = '<option value="" selected>Select Reporting Manager-2</option>';
    data.forEach(teamCo => {
        let option = document.createElement('option');
        option.value = teamCo.empid;
        option.text = teamCo.team_lead_name;
        teamCoSelect.add(option);
    });
}

function updateTeamLeadNames(data){
	//console.log("yoooooo "+JSON.stringify(data));
	let teamLeadSelect = document.getElementById('team_lead_name');
	teamLeadSelect.innerHTML = '<option value="" selected>Select Reporting Manager-1</option>';
    data.forEach(teamLead => {
        let option = document.createElement('option');
        option.value = teamLead.empid;
        option.text = teamLead.team_lead_name;
        teamLeadSelect.add(option);
    });
}

function updateSubDeptNames(data) {
    let subDeptSelect = document.getElementById('sub_dept_name');
    
    // Clear the current options and add a default option
    subDeptSelect.innerHTML = '<option value="" selected>Select Sub Department</option>';
    
    // Assuming 'data' is an array of objects like [{sub_dept_name: 'Software,Firmware,Testing'}]
    if (data.length > 0 && data[0].sub_dept_name) {
        // Access the sub_dept_name string and split it by commas
        let subDepts = data[0].sub_dept_name.split(',');

        // Loop through the split sub-departments and add them as options
        subDepts.forEach(subDept => {
            let trimmedSubDept = subDept.trim(); // Remove any leading/trailing spaces
            if (trimmedSubDept) {
                let option = document.createElement('option');
                option.value = trimmedSubDept;
                option.text = trimmedSubDept;
                subDeptSelect.add(option);
            }
        });
    }
}

function updateEmpNameBasedOnDeptName(dept_name){
	$('#updateLeaveBalancePopupLeaveDetailsBox').hide();
	$('#updateLeaveBalancePopupLeaveTypeBox').hide();
	$('#reason_for_adding_LeaveBalance').val('');
	$.ajax({
        type: "GET",
        url: "/fetchEmpNamesBasedOnDeptName",
        data: { "dept_name": dept_name },
        success: function(data) {
        	updateEmpNamesInFilterAttendance(data);
        	//alert(JSON.stringify(data));
        	updateEmpNamesForLeaveBalanceUpdates(data);
        },
        error: function(xhr, status, error) {
        	console.error('Error fetching data:', error);
			console.log('Error fetching data. Please try again.');
        }
    });
}

function updateEmpNamesInFilterAttendance(data){
	let empNameSelect = document.getElementById('attendanceFilterEmpName');
	empNameSelect.innerHTML = '<option value="">Select Employee Name</option>';
    data.forEach(empName => {
        let option = document.createElement('option');
        option.value = empName.empid;
        option.text = empName.emp_name;
        empNameSelect.add(option);
    });
}

function updateEmpNamesForLeaveBalanceUpdates(data){
	let empNameSelect = document.getElementById('updateLeaveBalancePopupEmpName');
	empNameSelect.innerHTML = '<option value="">Select Employee Name</option>';
    data.forEach(empName => {
        let option = document.createElement('option');
        option.value = empName.empid;
        option.text = empName.emp_name;
        empNameSelect.add(option);
    });
}

</script>

<script>

function insertCurrentSalaryToHiddenInput(current_salary_value){
	$('#current_salary_in_hidden_input').val(current_salary_value);
}

function displayHiddenAcademicBlocks(clickedData, buttonElement) {
	
    // Toggling the visibility of the section and adding/removing the active class
    if (clickedData === '10th') {
        $('.hiddenTenthDetailBox').toggle();  // Toggle visibility for 10th
        $(buttonElement).toggleClass('active');  // Toggle the active class for the button
    }
    
    if (clickedData === 'PUC') {
        $('.hiddenPucDetailBox').toggle();  // Toggle visibility for PUC
        $(buttonElement).toggleClass('active');  // Toggle the active class for the button
    }
    
    if (clickedData === 'UG') {
        $('.hiddenUGDetailBox').toggle();  // Toggle visibility for UG
        $(buttonElement).toggleClass('active');  // Toggle the active class for the button
    }
    
    if (clickedData === 'PG') {
        $('.hiddenPGDetailBox').toggle();  // Toggle visibility for PG
        $(buttonElement).toggleClass('active');  // Toggle the active class for the button
    }
    
    if (clickedData === 'Other') {
        $('.hiddenOtherDetailBox').toggle();  // Toggle visibility for Other
        $(buttonElement).toggleClass('active');  // Toggle the active class for the button
    }
}

function displayHiddenCandidateTypeBlocks(clickedData, buttonElement) {
    // Check if the clicked button already has the 'active' class
    const isActive = $(buttonElement).hasClass('active');

    // Remove the 'active' class from all buttons
    $('.candidateTypeBtn').removeClass('active');

    if (clickedData === 'Fresher') {
        if (!isActive) {
            // Show Fresher section and add 'active' class
            $('.hiddenfresherDetailBox').show();
            $('.hiddenExperienceDetailBox').hide();
            $(buttonElement).addClass('active'); // Add 'active' class to the Fresher button
            $('#candidate_type').val('Fresher');
        } else {
            // Hide the section and remove 'active' if clicked again
            $('.hiddenfresherDetailBox').hide();
        }
    } else if (clickedData === 'Experience') {
        if (!isActive) {
            // Show Experience section and add 'active' class
            $('.hiddenExperienceDetailBox').show();
            $('.hiddenfresherDetailBox').hide();
            $(buttonElement).addClass('active'); // Add 'active' class to the Experience button
            $('#candidate_type').val('Experience');
        } else {
            // Hide the section and remove 'active' if clicked again
            $('.hiddenExperienceDetailBox').hide();
        }
    }
}
</script>

<script>
	var selectedCandidateId = $('#selectedCandidateIdValue').val();
	
	if(selectedCandidateId){
		
		toggleAdd22();
		
		$.ajax({
		    type: "GET",
		    url: "fetchCandidatesDataUsingId",
		    data: {
		    	"candidate_id": selectedCandidateId
		    },
		    success: function(data) {
                // Check if data is not null and fields exist
               //console.log(JSON.stringify(data));
                if (data) {
                	
					var offeredCtc;
                    
                 // Determine offered CTC
                 if (data.candidate_response_for_first_ctc_offer === "Accepted" && data.first_ctc_offer) {
                     offeredCtc = data.first_ctc_offer;
                 } else if (data.candidate_response_for_second_ctc_offer === "Accepted" && data.second_ctc_offer) {
                     offeredCtc = data.second_ctc_offer;
                 } else if (data.candidate_response_for_third_ctc_offer === "Accepted" && data.third_ctc_offer) {
                     offeredCtc = data.third_ctc_offer;
                 } else {
                     offeredCtc = 0;
                 }
                	
                    // Populate form fields
                    $('#first_name').val(data.first_name || '');
                    $('#last_name').val(data.last_name || '');
                    $('#mobile_no').val(data.mobile_number || '');
                    $('#address').val(data.permanent_address || '');
                    $('#dob').val(data.dob || '');
                    $('#aadhar').val(data.aadhar_number || '');
                    $('#gender').val(data.gender || '');
                    $('#personal_email').val(data.email || '');
                    $('#father_name').val(data.father_name || '');
                    $('#mother_name').val(data.mother_name || '');
                    $('#corr_address').val(data.corresponding_address || '');
                    
                    // To display Image
                    if(data.profile_pic_path){
                    	$('#profilePic').attr('src', `${data.profile_pic_path}`);
                        $('#profilePicPathValue').val(data.profile_pic_path);
                        $('.profilePicDiv').show();
                    }
                    
                    if(data.pan_pic_path){
                    	$('#panPic').attr('src', `${data.pan_pic_path}`);
                        $('#panPicPathValue').val(data.pan_pic_path);
                        $('.panPicDiv').show();
                    }
                    
                    if(data.aadhar_pic){
                    	$('#aadharPic').attr('src', `${data.aadhar_pic}`);
                        $('#aadharPicPathValue').val(data.aadhar_pic);
                        $('.aadharPicDiv').show();
                    }
                    
                    if(data.voter_id_pic){
                    	$('#voterIdPic').attr('src', data.voter_id_pic);
                        $('#voterIdPicPathValue').val(data.voter_id_pic);
                        $('.voterIdPicDiv').show();
                    }
                    
                    if(data.tenth_pic){
                    	$('#tenthPic').attr('src', `${data.tenth_pic}`);
                        $('#tenthPicPathValue').val(data.tenth_pic);
                        $('.tenthPicDiv').show();
                    }
                    
                    if(data.puc_pic){
                    	$('#pucPic').attr('src', `${data.puc_pic}`);
                        $('#pucPicPathValue').val(data.puc_pic);
                        $('.pucPicDiv').show();
                    }
                    
                    if(data.degree_pic){
                    	$('#degreePic').attr('src', `${data.degree_pic}`);
                        $('#degreePicPathValue').val(data.degree_pic);
                        $('.degreePicDiv').show();
                    }
                    
                    if(data.pg_pic){
                    	$('#pgPic').attr('src', `${data.pg_pic}`);
                        $('#pgPicPathValue').val(data.pg_pic);
                        $('.pgPicDiv').show();
                    }
                    
                    if(data.exp_letter_pic){
                    	$('#expLetterPic').attr('src', `${data.exp_letter_pic}`);
                        $('#expLetterPicPathValue').val(data.exp_letter_pic);
                        $('.expLetterPicDiv').show();
                    }
                    
                    if(data.payslip_pic){
                    	$('#payslipPic').attr('src', `${data.payslip_pic}`);
                        $('#payslipPicPathValue').val(data.payslip_pic);
                        $('.payslipPicDiv').show();
                    }
                    
                    if(data.diploma_pic){
                    	$('#diplomaPic').attr('src', `${data.diploma_pic}`);
                        $('#diplomaPicPathValue').val(data.diploma_pic);
                        $('.diplomaPicDiv').show();
                    }
                    
                    if(data.bank_check_pic){
                    	$('#bankOrChequePic').attr('src', `${data.bank_check_pic}`);
                        $('#bankOrChequePicPathValue').val(data.bank_check_pic);
                        $('.bankOrChequePicDiv').show();
                    }
                    
                    if(data.other_pic){
                    	$('#othersPic').attr('src', `${data.other_pic}`);
                        $('#othersPicPathValue').val(data.other_pic);
                        $('.othersPicDiv').show();
                    }
                    
                    if(data.other_pic2){
                    	$('#othersPic2').attr('src', `${data.other_pic2}`);
                        $('#othersPicPathValue2').val(data.other_pic2);
                        $('.othersPicDiv2').show();
                    }
                    
                    if(data.other_pic3){
                    	$('#othersPic3').attr('src', `${data.other_pic3}`);
                        $('#othersPicPathValue3').val(data.other_pic3);
                        $('.othersPicDiv3').show();
                    }
                    
                    if(data.other_pic4){
                    	$('#othersPic4').attr('src', `${data.other_pic4}`);
                        $('#othersPicPathValue4').val(data.other_pic4);
                        $('.othersPicDiv4').show();
                    }
                    
                    if (data.qualification1) {
                    	$('.hiddenTenthDetailBox').toggle();
                        $('.tenthButton').toggleClass('active');
                        
                        $('#tenth_school_name').val(data.college_name1);
                        $('#tenth_board_name').val(data.university_name1);
                        $('#tenth_percentage').val(data.percentage1);
                        $('#tenth_completed_date').val(data.year_select1);
                    }
                    
                    if (data.qualification2) {
                    	$('.hiddenPucDetailBox').toggle();
                        $('.pucBtn').toggleClass('active');
                        
                        $('#puc_college_name').val(data.college_name2);
                        $('#puc_board_name').val(data.university_name2);
                        $('#puc_percentage').val(data.percentage2);
                        $('#puc_completed_date').val(data.year_select2);
                    }
                    
                    if (data.qualification3) {
                    	$('.hiddenUGDetailBox').toggle();
                        $('.ugBtn').toggleClass('active');
                        
                        $('#ug_college_name').val(data.college_name3);
                        $('#ug_degree_name').val(data.degree_name3);
                        $('#ug_university_name').val(data.university_name3);
                        $('#ug_type').val(data.education_completed_type3);
                        $('#ug_percentage').val(data.percentage3);
                        $('#ug_completed_date').val(data.year_select3);
                    }
                    
                    if (data.qualification4) {
                    	$('.hiddenPGDetailBox').toggle();
                        $('.pgBtn').toggleClass('active');
                        
                        $('#pg_college_name').val(data.college_name4);
                        $('#pg_degree_name').val(data.degree_name4);
                        $('#pg_university_name').val(data.university_name4);
                        $('#pg_type').val(data.education_completed_type4);
                        $('#pg_percentage').val(data.percentage4);
                        $('#pg_completed_date').val(data.year_select4);
                    }
                    
                    if (data.qualification5) {
                    	$('.hiddenOtherDetailBox').toggle();
                        $('.otherBtn').toggleClass('active');
                        
                        $('#other_college_name').val(data.college_name5);
                        $('#other_degree_name').val(data.degree_name5);
                        $('#other_university_name').val(data.university_name5);
                        $('#other_type').val(data.education_completed_type5);
                        $('#other_percentage').val(data.percentage5);
                        $('#other_completed_date').val(data.year_select5);
                    }
                    
                    
                    if (data.experience) {
                    	
                    	if(data.experience === 'Fresher'){
                    		// Check if the clicked button already has the 'active' class
                    		const isActive = $('.fresherBtn').hasClass('active');

                    	    // Remove the 'active' class from all buttons
                    	    $('.candidateTypeBtn').removeClass('active');

                    	        if (!isActive) {
                    	            // Show Fresher section and add 'active' class
                    	            $('.hiddenfresherDetailBox').show();
                    	            $('.hiddenExperienceDetailBox').hide();
                    	            $('.fresherBtn').addClass('active'); // Add 'active' class to the Fresher button
                    	            
                    	            $('#fresher_expected_salary').val(data.candidate_expected_salary_in_lpa);
                    	            $('#candidate_type').val('Fresher');
                    	            $('#fresher_current_salary').val(offeredCtc);
                    	            insertCurrentSalaryToHiddenInput(offeredCtc);
                    	            
                    	        } else {
                    	            // Hide the section and remove 'active' if clicked again
                    	            $('.hiddenfresherDetailBox').hide();
                    	        }
                    	        
                    		}else if(data.experience === 'Experience'){
                    			
                    			// Check if the clicked button already has the 'active' class
                        		const isActive = $('.expBtn').hasClass('active');

                        	    // Remove the 'active' class from all buttons
                        	    $('.candidateTypeBtn').removeClass('active');

                        	        if (!isActive) {
                        	            // Show Fresher section and add 'active' class
                        	            $('.hiddenfresherDetailBox').hide();
                        	            $('.hiddenExperienceDetailBox').show();
                        	            $('.expBtn').addClass('active'); // Add 'active' class to the Fresher button
                        	            
                        	            $('#experience_total_years').val(data.year_of_exp1);
                        	            $('#experience_expected_salary').val(data.candidate_expected_salary_in_lpa);
                        	            $('#candidate_type').val('Experience');
                        	            $('#exp_current_salary').val(offeredCtc);
                        	            insertCurrentSalaryToHiddenInput(offeredCtc);
                        	        } else {
                        	            // Hide the section and remove 'active' if clicked again
                        	            $('.hiddenfresherDetailBox').hide();
                        	        }
                    			}
                    		}
                    
                } else {
                    console.error("No data returned from the server");
                }
            },
            error: function(xhr, status, error) {
                console.error("Error invoking data:", error);
            }
        });
    }
</script>

<script>
	function setEmployeeTypeStatus(employeeTypeStatus){
		if (employeeTypeStatus === "active") {
	        $('.activeBtn').addClass('activeBtnStyle');  // Add 'activeBtnStyle' class
	        $('.inActiveBtn').removeClass('inActiveBtnStyle');  // Remove 'inActiveBtnStyle' class, if applied
	    } else if (employeeTypeStatus === "inactive") {
	        $('.inActiveBtn').addClass('inActiveBtnStyle');  // Add 'inActiveBtnStyle' class
	        $('.activeBtn').removeClass('activeBtnStyle');  // Remove 'activeBtnStyle' class, if applied
	    }
	}
	
	function toggleSelectAll(selectAllCheckbox) {
	    const rows = document.querySelectorAll('tbody tr'); // Get all rows in the table body
	    rows.forEach(row => {
	        const empType = row.querySelector('td span').textContent.trim(); // Get the employee type text (Active or In-active)
	        const checkbox = row.querySelector('.employeeCheckbox'); // Get the checkbox in the same row

	        // If employee is active ("Active"), check/uncheck based on the selectAll checkbox
	        if (empType === 'Active') {
	            checkbox.checked = selectAllCheckbox.checked;
	        } else {
	            checkbox.checked = false; // Uncheck for inactive employees
	        }
	    });
	}
	
	function openPopupToInsertAppraisalData() {
	    // Get all the checkboxes with class 'employeeCheckbox'
	    const checkboxes = document.querySelectorAll('.employeeCheckbox');
	    var selectedQuaterValue = $('#quarter_type').val();
	    
	    // Check if at least one checkbox is checked
	    let isChecked = false;

	    checkboxes.forEach((checkbox) => {
	        if (checkbox.checked) {
	            isChecked = true;
				
	            openAppraisalFormOuterDiv();
	            selectedQuarterType(selectedQuaterValue);
	        }
	    });

	    // If no checkbox is selected, show an alert
	    if (!isChecked) {
	        alert("Please check at least one employee to enable appraisal");
	        return; // Stop further execution if no checkbox is selected
	    }
	}
	
	function openPopupToDisablePermissions() {
	    // Get all the checkboxes with class 'employeeCheckbox'
	    const checkboxes = document.querySelectorAll('.employeeCheckbox');
	    
	    // Check if at least one checkbox is checked
	    let isChecked = false;
	    const selectedEmployeeId = [];

	    checkboxes.forEach((checkbox) => {
	        if (checkbox.checked) {
	            isChecked = true;
	            
	            const row = checkbox.closest('tr');
	            const empId = row.querySelector('#empIdForApprisal').textContent;
	            
	            selectedEmployeeId.push({
	            	userId: empId.trim()
	            });
				
	            openDisablePermissionFormOuterDiv(selectedEmployeeId);
	        }
	    });

	    // If no checkbox is selected, show an alert
	    if (!isChecked) {
	        alert("Please check at least one employee to disable permission");
	        return; // Stop further execution if no checkbox is selected
	    }
	    
	    //console.log("Emp id's === "+JSON.stringify(selectedEmployeeId));
	    
	    $('#interviewAccess').prop('checked', false);
	    $('#attendanceAccess').prop('checked', false);
	    $('#appraisalAccess').prop('checked', false);
	    
	    $.ajax({
            url: '/fetchAllPermissionsDetailsBasedOnEmpId', //Your backend URL for saving the CTC offer
            type: 'POST',
            contentType: 'application/json', // Set content type to JSON
	        data: JSON.stringify(selectedEmployeeId), // Convert the array to JSON
            success: function (response) {
            	//console.log("Responsessss=== "+JSON.stringify(response));
            	
            	// Loop through the response and set the checkbox states
                response.forEach(item => {
                    // Check for individual permissions
                    if (item.interviewAccess) {
                        $('#interviewAccess').prop('checked', true);
                    }
                    if (item.attendance) {
                        $('#attendanceAccess').prop('checked', true);
                    }
                    /* if (item.apprisal_link) {
                        $('#appraisalAccess').prop('checked', true);
                    } */
                });
            },
            error: function (xhr, status, error) {
                alert('Failed to fetch permission status values: ' + error);
            }
        });
	    
	}
	
	
function openDisablePermissionFormOuterDiv(selectedEmployeeId){
		// Store the selectedEmployeeIds in a hidden field for further use
    	document.getElementById('selectedEmployeeIds').value = JSON.stringify(selectedEmployeeId);
		
    	// Hide the scroll bar on the body
	    document.body.style.overflow = 'hidden';

		$("#disbalePermissionFormOuterDiv").show();
	}
	
	function closeDisbalePermissionFormOuterDiv(){
		
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'auto';
		
		$("#disbalePermissionFormOuterDiv").hide();
	}
	
	
	function onPermissionToggle(checkbox) {
	    const selectedEmployeeIds = JSON.parse(document.getElementById('selectedEmployeeIds').value);

	    // Prepare data to send to the backend
	    const requestData = selectedEmployeeIds.map((employeeId) => ({
	        userId: employeeId.userId, // Use the employeeId string directly
	        permissionType: checkbox.id,
	        enabled: false // Send the actual state of the checkbox
	    }));

	    //console.log(JSON.stringify(requestData));

	    // Send data to the backend
	    sendPermissionsDataToBackend(requestData);
	    
	    //closeDisbalePermissionFormOuterDiv();
	}

	function sendPermissionsDataToBackend(requestData) {
	    $.ajax({
	        url: "/disablePermissionsAsAGroupList",
	        type: "POST",
	        contentType: "application/json",
	        data: JSON.stringify(requestData),
	        success: function () {
	            console.log("Permissions disabled successfully.");
	        },
	        error: function () {
	            alert("An error occurred while disabling the permissions.");
	        }
	    });
	}
	

	function sendAppraisalData(quarterType, appraisalSubmissionDate, financialMonthYear, appraisalNotificationAutoId, appraisalSubmissionDateForAdmin){
		
		 // Get all the checkboxes with class 'employeeCheckbox'
	    const checkboxes = document.querySelectorAll('.employeeCheckbox');
		 
		 if(!appraisalSubmissionDate){
			 alert("Please give deadline to submit the appraisal form for User");
			 return;
		 }
		 
		 if(!appraisalSubmissionDateForAdmin){
			 alert("Please give deadline to submit the appraisal form for Admin");
			 return;
		 }
	    
	    // Check if at least one checkbox is checked
	    let isChecked = false;
	    const selectedEmployees = []; // Array to hold selected employee data

	    checkboxes.forEach((checkbox) => {
	        if (checkbox.checked) {
	            isChecked = true;

	            // Use querySelector to get the closest <tr> and then find the necessary cells
	            const row = checkbox.closest('tr');
	            const empId = row.querySelector('#empIdForApprisal').textContent; // Ensure you have this ID in your HTML
	            const deptName = row.querySelector('#empDeptNameForApprisal').textContent; // Get the department from the table cell
	            const email = row.querySelector('#empEmailForApprisal').textContent; // Get the email from the table cell
	            
	         // Add selected employee details to the array
	            selectedEmployees.push({
	            	emp_id: empId.trim(),
	            	department: deptName.trim(),
	                email: email.trim(),
	                quarter: quarterType,
	                quarter_month_year: financialMonthYear,
	                apprisal_submit_date: appraisalSubmissionDate,
	                apprisal_submit_date_admin: appraisalSubmissionDateForAdmin
	            });
	        }
	    });

	    // If no checkbox is selected, show an alert
	    if (!isChecked) {
	        alert("Please check at least one employee to enable appraisal");
	        return; // Stop further execution if no checkbox is selected
	    }
	    
	    /*selectedEmployees.forEach(emp => {
	        //console.log(`Emp ID: ${emp.empId}, Department: ${emp.deptName}, Email: ${emp.email}`);
	        console.log("Seeeeee = "+emp.empId, emp.deptName, emp.email, quarterType, appraisalSubmissionDate, financialMonthYear);
	        
	    });*/
	    
	    const currentYear = new Date().getFullYear();
	    
	 // Send the selected employees array in a single AJAX request
	    $.ajax({
	        type: 'POST',
	        url: 'saveAppraisalForHR',
	        contentType: 'application/json', // Send JSON data
	        data: JSON.stringify(selectedEmployees), // Convert the array to JSON
	        success: function(response) {
	            if(response === "Appraisal inserted") {
	            	// Loop through each employee and make a separate AJAX request to update permissions
	            	
	            	$.ajax({
	                    url: '/updateQuarterFlagAndQuarterBtnEnableFlagForHRAfterSubmittingAppraisalDetails', // Your backend URL for saving the CTC offer
	                    type: 'POST',
	                    data: {
	                    	auto_id: appraisalNotificationAutoId,
	                    	currYear: currentYear
	                    },
	                    success: function (response) {
	                        if(response === "Appraisal sent year value is updated"){
	                        	alert("Appraisal enabled successfully for employee");
	                        }else{
	                        	alert("There is a problem in updating the current year value in appraisal notification table for HR");
	                        }
	                    },
	                    error: function (xhr, status, error) {
	                        alert('Failed to update Appraisal status valuesss: ' + error);
	                    }
	                });
	            	
	            } else {
	                alert("Data insertion failed.");
	            }
	            closeAppraisalFormOuterDiv();
	        },
	        error: function(xhr, status, error) {
	            console.error('Error inserting data:', error);
	            alert('An error occurred while inserting the data.');
	        }
	    });
	}
	
	function selectedQuarterType(selectedQuaterValue){
		//alert(selectedQuaterValue);
		var month, year, formattedMonthAndYear;
		var currentYear = new Date().getFullYear(); // Get the current year
		
		if(selectedQuaterValue === "Q1"){
			month = "(Apr - June)";
			year = currentYear;
			formattedMonthAndYear = month+" - "+year;
			$('#quarter_month_duration').val(formattedMonthAndYear);
			$('#appraisalMonthSpan').text(formattedMonthAndYear);
		}else if(selectedQuaterValue === "Q2"){
			month = "(July - Sep)";
			year = currentYear;
			formattedMonthAndYear = month+" - "+year;
			$('#quarter_month_duration').val(formattedMonthAndYear);
			$('#appraisalMonthSpan').text(formattedMonthAndYear);
		}else if(selectedQuaterValue === "Q3"){
			month = "(Oct - Dec)";
			year = currentYear;
			formattedMonthAndYear = month+" - "+year;
			$('#quarter_month_duration').val(formattedMonthAndYear);
			$('#appraisalMonthSpan').text(formattedMonthAndYear);
		}else if(selectedQuaterValue === "Q4"){
			month = "(Jan - March)";
			year = currentYear;
			formattedMonthAndYear = month+" - "+year;
			$('#quarter_month_duration').val(formattedMonthAndYear);
			$('#appraisalMonthSpan').text(formattedMonthAndYear);
		}
	}
	
	function closeAppraisalFormOuterDiv(){
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'auto';
		$("#appraisalFormOuterDiv").hide();
	}
	
	function openAppraisalFormOuterDiv(){
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'hidden';
		$("#appraisalFormOuterDiv").show();
	}
	
	
	function openPopupToInsertAttendanceData() {
	    // Get all the checkboxes with class 'employeeCheckbox'
	    const checkboxes = document.querySelectorAll('.employeeCheckbox');
	    
	    // Check if at least one checkbox is checked
	    let isChecked = false;
	    
	    let selectedEmployees = [];

	    checkboxes.forEach((checkbox) => {
	        if (checkbox.checked) {
	            isChecked = true;
	            
	            const row = checkbox.closest('tr');
	            const empId = row.querySelector('#empIdForApprisal').textContent;
	            
	            selectedEmployees.push({
	                userId: empId,
	                permissionType: "attendanceAccess",
	                enabled: isChecked
	            });
	        }
	    });

	    // If no checkbox is selected, show an alert
	    if (!isChecked) {
	        alert("Please check at least one employee to enable attendance");
	        return; // Stop further execution if no checkbox is selected
	    }
	    
	    $.ajax({
	        type: 'POST',
	        url: 'updatePermissionsAsAGroupList',
	        contentType: 'application/json',
	        data: JSON.stringify(selectedEmployees),
	        success: function(response) {
	        	 alert(response);
	        },
	        error: function(xhr, status, error) {
	            console.error('Error inserting data:', error);
	            alert('An error occurred while enabling the attendance link');
	        }
	    });
	}

</script>

<script>
	function openPermissionListPopup(){
		$.ajax({
            url: '/getAllPermissionsEnabledAndDisabledData', 
            type: 'GET',
            success: function (response) {
            	updatePermissionListDetails(response);
            },
            error: function (xhr, status, error) {
                alert('Failed to fetching the permission details: ' + error);
            }
        });
		
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'hidden';
		
		$('#permissionListsOuterDiv').show();
	}
	
	function closePermissionListsOuterDiv(){
		$('#permissionListsOuterDiv').hide();
		//location.reload();
	}
	
	function updatePermissionListDetails(data){
		var viewPermissionDetailsTBody = document.getElementById('viewPermissionDetailsTBody');
		  
		viewPermissionDetailsTBody.innerHTML = ''; 
		  
		  if (data && data.length > 0) {
		      for (var i = 0; i < data.length; i++) {
		    	  
		    	  var interview, sales, store, account, attendance, appraisal, others, crm;
		    	  var color1, color2, color3, color4, color5, color6, color7, color8;
		    	  
		    	  if(data[i].interview_access === "t"){
		    		  interview = "<i class='bi bi-check-lg'></i>";
		    		  color1 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].interview_access === "f"){
		    		  interview = "<i class='bi bi-x'></i>";
		    		  color1 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  interview = "-";
		    		  color1 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].sales === "t"){
		    		  sales = "<i class='bi bi-check-lg'></i>";
		    		  color2 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].sales === "f"){
		    		  sales = "<i class='bi bi-x'></i>";
		    		  color2 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  sales = "-";
		    		  color2 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].store === "t"){
		    		  store = "<i class='bi bi-check-lg'></i>";
		    		  color3 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].store === "f"){
		    		  store = "<i class='bi bi-x'></i>";
		    		  color3 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  store = "-";
		    		  color3 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].accounts === "t"){
		    		  account = "<i class='bi bi-check-lg'></i>";
		    		  color4 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].accounts === "f"){
		    		  account = "<i class='bi bi-x'></i>";
		    		  color4 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  account = "-";
		    		  color4 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].attendance === "t"){
		    		  attendance = "<i class='bi bi-check-lg'></i>";
		    		  color5 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].attendance === "f"){
		    		  attendance = "<i class='bi bi-x'></i>";
		    		  color5 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  attendance = "-";
		    		  color5 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].apprisal_link === "t"){
		    		  appraisal = "<i class='bi bi-check-lg'></i>";
		    		  color6 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].apprisal_link === "f"){
		    		  appraisal = "<i class='bi bi-x'></i>";
		    		  color6 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  appraisal = "-";
		    		  color6 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].other_permission1 === "t"){
		    		  others = "<i class='bi bi-check-lg'></i>";
		    		  color7 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].other_permission1 === "f"){
		    		  others = "<i class='bi bi-x'></i>";
		    		  color7 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  others = "-";
		    		  color7 = 'color: black';
		    	  }
		    	  
		    	  if(data[i].crm === "t"){
		    		  crm = "<i class='bi bi-check-lg'></i>";
		    		  color8 = 'color: green; font-size: 20px; font-weight: bold;';
		    	  }else if(data[i].crm === "f"){
		    		  crm = "<i class='bi bi-x'></i>";
		    		  color8 = 'color: red; font-size: 20px; font-weight: bold;';
		    	  }else{
		    		  crm = "-";
		    		  color8 = 'color: black';
		    	  }
		    	  
		          var row = "<tr>" +
			              	"<td>" + (i+1) + "</td>" +
			              	"<td>" + data[i].emp_details_table_empid + "</td>" +
			              	"<td>" + data[i].emp_name + "</td>" +
			              	"<td style='" + color1 + "'>" + interview + "</td>" +
			              	"<td style='" + color8 + "'>" + crm + "</td>" +
			              	"<td style='" + color2 + "'>" + sales + "</td>" +
			              	"<td style='" + color3 + "'>" + store + "</td>" +
			              	"<td style='" + color4 + "'>" + account + "</td>" +
			              	"<td style='" + color5 + "'>" + attendance + "</td>" +
			              	"<td style='" + color6 + "'>" + appraisal + "</td>" +
			              	/* "<td style='" + color7 + "'>" + others + "</td>" + */
			              	"</tr>";
	
			     viewPermissionDetailsTBody.innerHTML += row; //Append row HTML
		      }
		      
		      
		  } else {
		      var noDataRow = "<tr><td colspan='16'>No data available</td></tr>";
		      viewPermissionDetailsTBody.innerHTML = noDataRow; // Display 'No data available'
		  }
	}
	
	/* function getCurrentFinancialYear() {
	    // Get the current date
	    const today = new Date();
	    
	    // Get the current year
	    const currentYear = today.getFullYear();
	    
	    // Financial year starts from April 1st
	    if (today.getMonth() + 1 >= 4) { // Months are zero-based in JavaScript
	        // If the current month is April or later, the financial year is currentYear - currentYear + 1
	        return `${currentYear}-${(currentYear + 1).toString().slice(-2)}`; // Takes last 2 digits of the next year
	    } else {
	        // If the current month is before April, the financial year is previous year to currentYear
	        return `${currentYear - 1}-${currentYear.toString().slice(-2)}`; // Takes last 2 digits of the current year
	    }
	} */
	
	function getCurrentFinancialYear() {
	    // Get the current date
	    const today = new Date();
	    
	    // Get the current year and month
	    const currentYear = today.getFullYear();
	    const currentMonth = today.getMonth() + 1; // JavaScript months are zero-based
	    const currentDate = today.getDate();
	    
	    //alert(currentYear+" "+currentMonth+" "+currentDate);
	    
	    // Define the start of the financial year (March 26)
	    const financialYearStart = new Date(currentYear, 2, 26); // March 26
	    
	    //alert(financialYearStart);
	    
	    //alert(today);
	    
	    if (today >= financialYearStart) {
	        // If today is on or after March 26, current financial year is currentYear - (currentYear + 1)
	        return `${currentYear}-${(currentYear + 1).toString().slice(-2)}`;
	    } else {
	        // If today is before March 26, financial year is previousYear - currentYear
	        return `${currentYear - 1}-${currentYear.toString().slice(-2)}`;
	    }
	}

	//alert(getCurrentFinancialYear());
	
	function openLeaveBalancePopup(){
		
		const current_financial_year = getCurrentFinancialYear();
		
		//alert(current_financial_year);
		
		$.ajax({
            url: '/getAllEmployeesLeaveBalanceData', 
            type: 'GET',
            data: {current_financial_year: current_financial_year},
            success: function (response) {
            	updateLeaveBalanceDetails(response);
            },
            error: function (xhr, status, error) {
                alert('Failed to fetching the permission details: ' + error);
            }
        });
		
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'hidden';
		$('#leaveBalanceListsOuterDiv').show();
	}
	
	function closeLeaveBalanceListsOuterDiv(){
		document.body.style.overflow = 'auto';
		$('#leaveBalanceListsOuterDiv').hide();
		//location.reload();
	}
	
	
	function updateLeaveBalanceDetails(data){
		var viewLeaveBalanceDetailsTBody = document.getElementById('viewLeaveBalanceDetailsTBody');
		  
		viewLeaveBalanceDetailsTBody.innerHTML = ''; 
		  
		  if (data && data.length > 0) {
		      for (var i = 0; i < data.length; i++) {
		    	  
		    	  var mlType;
		    	  
		    	  if(data[i].gender === "Male"){
		    		  mlType = "N/A";
		    	  }else if(data[i].gender === "Female"){
		    		  mlType = data[i].ml;
		    	  }
		    	  
		          var row = "<tr>" +
			              	"<td>" + (i+1) + "</td>" +
			              	"<td>" + data[i].empid + "</td>" +
			              	"<td>" + data[i].emp_name + "</td>" +
			              	"<td>" + data[i].email + "</td>" +
			              	"<td>" + data[i].dept_name + "</td>" +
			              	"<td>" + data[i].role_name + "</td>" +
			              	"<td>" + data[i].sl + "</td>" +
			              	"<td>" + data[i].cl + "</td>" +
			              	"<td>" + data[i].el + "</td>" +
			              	"<td>" + mlType + "</td>" +
			              	"</tr>";
	
			              	viewLeaveBalanceDetailsTBody.innerHTML += row; //Append row HTML
		      }
		      
		      
		  } else {
		      var noDataRow = "<tr><td colspan='16'>No data available</td></tr>";
		      viewLeaveBalanceDetailsTBody.innerHTML = noDataRow; // Display 'No data available'
		  }
	}
	
	
	function openFilterPopup(){
		
		leaveRequestDetails = [];
		
		$.ajax({
		      type: 'GET', 
		      url: 'getAllLeaveRequestsDetailsList', 
		      success: function(data) {
		    	  leaveRequestDetails = data;
					},
		      error: function(xhr, status, error) {
		          console.error('Error fetching leave requests details data:', error);
		          console.log('Error fetching leave requests details data. Please try again.');
		      }
		  });
		
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'hidden';
		$('#filterDetails_outerBox').show();
		filterDetails_outerBox.classList.add("active");
	}
	
	function closeFilterPopup(){
		// Hide the scroll bar on the body
	    document.body.style.overflow = 'auto';
		$('#filterDetails_outerBox').hide();
		filterDetails_outerBox.classList.remove("active");
	}
	
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var dateColumns = document.querySelectorAll(".dateColumn");
        dateColumns.forEach(function(column) {
        	
        	if(column != null){
        		var originalDate = column.textContent;
                var formattedDate = formatDate(originalDate);
                column.textContent = formattedDate;
        	}else{
        		column.textContent = "-";
        	}
        });
        
     // Format the date elements
        var dateElements = document.querySelectorAll('.dateFormatter');
        dateElements.forEach(function(dateElement) {
        	
        	if(dateElement != null){
        		var dateStr = dateElement.innerText; // Get the date string in yyyy-mm-dd format
                var dateParts = dateStr.split('-'); // Split the date string into parts

                // Check if the date format is valid
                if (dateParts.length === 3) {
                    // Format the date as dd-mm-yyyy
                    var formattedDate = dateParts[2] + '-' + dateParts[1] + '-' + dateParts[0];
                    // Update the text of the date element
                    dateElement.innerText = formattedDate;
                }
        	}else{
        		dateElement.innerText = "-";
        	}
        });
    });

    function formatDate(dateString) {
        var date = new Date(dateString);
        var day = date.getDate();
        var month = date.getMonth() + 1; // Months are zero-based
        var year = date.getFullYear();
        
        // Ensure two digits for day and month
        if (day < 10) {
            day = '0' + day;
        }
        if (month < 10) {
            month = '0' + month;
        }

        return year + '-' + month + '-' + day;
    }
</script>

<script>

document.addEventListener('DOMContentLoaded', () => {
    const filterBox = document.getElementById('filterDetails_InnerBox');
    const table = document.getElementById('customTable');
    const rows = Array.from(table.querySelectorAll('tbody tr'));

    function filterAndSortTable() {
        const selectedEmpType = Array.from(document.querySelectorAll('.employeeType:checked'))
            .map(input => input.value);
        const selectedDept = Array.from(document.querySelectorAll('.deptType:checked'))
        .map(input => input.value);
        const selectedGender = Array.from(document.querySelectorAll('.genderType:checked'))
        .map(input => input.value);
        const selectedExpOrFresher = Array.from(document.querySelectorAll('.expType:checked'))
        .map(input => input.value);
        const dateFilterType = document.querySelector('.dateFilterType:checked')?.value; // Get the selected date filter type
        const startDate = document.querySelectorAll('.custom_date')[0]?.value; // From date
        const endDate = document.querySelectorAll('.custom_date')[1]?.value;  // To date
        
        rows.forEach(row => {
            const empTypeStatus = row.querySelector('[data-column="empType"]').textContent.trim();
            const deptTypeStatus = row.querySelector('[data-column="deptName"]').textContent.trim();
            const genderTypeStatus = row.querySelector('[data-column="gender"]').textContent.trim();
            const expOrFresherTypeStatus = row.querySelector('[data-column="candidateType"]').textContent.trim();
            
            let matchesEmpTypeStatus = !selectedEmpType.length || selectedEmpType.includes(empTypeStatus);
            let matchesDeptTypeStatus = !selectedDept.length || selectedDept.includes(deptTypeStatus);
            let matchesGenderTypeStatus = !selectedGender.length || selectedGender.includes(genderTypeStatus);
            let matchesExpOrFresherTypeStatus = !selectedExpOrFresher.length || selectedExpOrFresher.includes(expOrFresherTypeStatus);

                let matchesDate = true; // Initialize date matching to true by default
                if (dateFilterType && startDate && endDate) {
              	    let dateValue = null;
              	    switch (dateFilterType) {
              	        case 'DOB':
              	            dateValue = row.querySelector('[data-column="dob"]').textContent.trim(); // DOB column
              	            break;
              	        case 'DOJ':
              	            dateValue = row.querySelector('[data-column="doj"]').textContent.trim(); // DOJ column
              	            break;
              	        case 'Probation':
              	            dateValue = row.querySelector('[data-column="probation"]').textContent.trim(); // Probation Completion Date column
              	            break;
              	        case 'Last Working':
              	            dateValue = row.querySelector('[data-column="lastWorking"]').textContent.trim(); // Last Working Day column
              	            break;
              	    }

              	    if (dateValue) {
              	        // Rearrange all dates to YYYY-MM-DD format for string comparison
              	        const [day, month, year] = dateValue.split('-'); 
              	        const formattedRowDate = `${year}-${month}-${day}`; // Convert DD-MM-YYYY to YYYY-MM-DD

              	        const [startDay, startMonth, startYear] = startDate.split('-');
              	        const formattedFromDate = `${startDay}-${startMonth}-${startYear}`; //Convert DD-MM-YYYY to YYYY-MM-DD

              	        const [endDay, endMonth, endYear] = endDate.split('-');
              	        const formattedToDate = `${endDay}-${endMonth}-${endYear}`; // Convert DD-MM-YYYY to YYYY-MM-DD

              	        /* console.log("Formatted Row Date == " + formattedRowDate + 
              	                    ", From Date == " + formattedFromDate + 
              	                    ", To Date == " + formattedToDate); */

              	        // Compare the rearranged strings directly
              	        matchesDate = formattedRowDate >= formattedFromDate && formattedRowDate <= formattedToDate;
              	    } else {
              	        matchesDate = false; // No matching date value in the row
              	    }
              	}
                
                
             // Show or hide row based on filters
                const shouldShow = matchesEmpTypeStatus && matchesDeptTypeStatus && matchesGenderTypeStatus 
                		&& matchesExpOrFresherTypeStatus && matchesDate;
                
             row.style.display = shouldShow ? '' : 'none';
                              
        });
    }

	 // Attach event listeners to filter inputs to trigger filtering
    const filterInputs = document.querySelectorAll(
        '.employeeType, .deptType, .genderType, .expType, .dateFilterType, .custom_date'
    );
    filterInputs.forEach(input => input.addEventListener('change', filterAndSortTable));

    // Initial filtering on page load
    filterAndSortTable();
});


function resetFilterPopup() {
    // Reset all checkboxes
    document.querySelectorAll('.filterDetails_outerBox input[type="checkbox"]').forEach(checkbox => {
        checkbox.checked = false;
    });

    // Reset all radio buttons
    document.querySelectorAll('.filterDetails_outerBox input[type="radio"]').forEach(radio => {
        radio.checked = false;
    });

    // Clear all date inputs
    document.querySelectorAll('.filterDetails_outerBox input[type="date"]').forEach(dateInput => {
        dateInput.value = '';
    });
    
 // Reset dropdowns
    document.querySelectorAll('.filterDetails_outerBox select').forEach(select => {
        select.selectedIndex = 0; // Sets to the first option
    });    
    
 // Show all rows in the table
    const rows = document.querySelectorAll('#customTable tbody tr');
    rows.forEach(row => {
        row.style.display = ''; // Reset display to show all rows
    });
    
}


//Used to export the table data to excel sheet
document.getElementById('exportOption').addEventListener('click', function () {
	/* const filenameInput = prompt("Enter a filename to export data");
    const filename = filenameInput && filenameInput.trim() ? filenameInput : 'EmployeeData';
    if (this.value === 'Excel') {
        exportTableToExcel('customTable', filename);
        this.value = ''; // Reset dropdown to default
    } */
    
    const filenameInput = prompt("Enter a filename to export data");
    const filename = filenameInput && filenameInput.trim() ? filenameInput : 'EmployeeData';
    exportTableToExcel('customTable', filename);
});

function exportTableToExcel(tableID, filename) {
    // Get the table element
    const table = document.getElementById(tableID);
    const rows = Array.from(table.rows);
    
    // Extract table data, excluding the first 3 headers and first 5 cells per row
    const data = rows
        .filter((row, rowIndex) => row.style.display !== 'none')  // Filter out hidden rows (after filtering)
        .map((row, rowIndex) =>
            Array.from(row.cells)
                .slice(3)  // Exclude the first 3 headers/cells
                .filter((_, cellIndex) => rowIndex === 0 || cellIndex >= 1)  // Keep headers and exclude first 5 cells in rows
                .map(cell => cell.innerText)
        );

    // Create a workbook
    const ws = XLSX.utils.aoa_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');

    // Save the workbook
    XLSX.writeFile(wb, `${filename}.xlsx`);
}

</script>

	<script>
		document.getElementById("feedbackForm").addEventListener("submit", function (event) {
			    event.preventDefault(); // Prevent default form submission

			    $.ajax({
			        url: 'recentlySavedTicketNumber',
			        type: 'GET',
			        success: function (response) {
			            let recentlyInsertedTicketIdData = response;

			            // Get the current date
			            var today = new Date();
			            var year = today.getFullYear();
			            var month = today.getMonth() + 1; // JavaScript months are 0-based

			            // Calculate the financial year
			            var financialYearStart = month >= 4 ? year : year - 1; // Fiscal year starts in April
			            var financialYearEnd = financialYearStart + 1;

			            // Format as FYY-YY
			            var financialYear = `F${financialYearStart % 100}-${financialYearEnd % 100}`;

			            // Department Name
			            var loggedInDeptName = $('#loggedInDeptName').val();

			            let incrementedNumber = "0001"; // Default number if response is empty or null

			            // Check if recentlyInsertedTicketIdData is not empty or null
			            if (recentlyInsertedTicketIdData) {
			                // Extract the last part of the ticket (e.g., 0001)
			                let ticketParts = recentlyInsertedTicketIdData.split("/");
			                let lastPart = ticketParts[ticketParts.length - 1];

			                // Increment the extracted number
			                let numericValue = parseInt(lastPart, 10) + 1;
			                incrementedNumber = numericValue.toString().padStart(4, '0'); // Pad with leading zeros
			            }

			            // Construct the feedback ticket
			            var feedbackTicket = `MSPL/FT/${financialYear}/${loggedInDeptName}/${incrementedNumber}`;

			            // Add feedback ticket to the form data
			            let formData = new FormData(document.getElementById("feedbackForm"));
			            formData.append("id", feedbackTicket);
			            formData.append("emp_id", $('#emp_idSessionValue').val());

			            const submitButton = document.getElementById("submitFeedbackBtn");
			            submitButton.disabled = true; // Disable the submit button to prevent multiple submissions

			            const loadingSwal = Swal.fire({
			                title: 'Submitting feedback...',
			                text: 'Please wait while we submit your feedback.',
			                showConfirmButton: false,
			                allowOutsideClick: false, // Prevent closing when clicking outside
			                            allowEscapeKey: false, // Prevent closing when pressing escape key
			                didOpen: () => {
			                    Swal.showLoading(); // Display the loading spinner
			                }
			            });

			            // Append files to form data
			            let files = document.getElementById("feedbackAttachment").files;
			            if (files.length > 0) {
			                for (let i = 0; i < files.length; i++) {
			                    formData.append(`attachment[${i}]`, files[i]); // Use unique keys
			                }
			            }

			            let bugType = document.getElementById("bugType").value;
			            formData.append("bugTypeff", bugType); // Add the bug type to the form data

			            // Debugging: Log formData entries before the fetch call
			            console.log("Logging formData entries:");
			            for (let [key, value] of formData.entries()) {
			                if (value instanceof File) {
			                    console.log(`Key: ${key}, File Name: ${value.name}, Size: ${value.size}`);
			                } else {
			                    console.log(`Key: ${key}, Value: ${value}`);
			                }
			            }

			            // Make AJAX request to submit feedback
			            fetch("/submitFeedback", {
			                method: "POST",
			                body: formData
			            })
			                .then(response => response.json())
			                .then(data => {
			                    loadingSwal.close();
			                    submitButton.disabled = false; // Re-enable the button
			                    if (data.success) {
			                        $('#feedbackModal').modal('hide');
			                        Swal.fire({
			                            title: 'Success!',
			                            text: 'Your feedback has been submitted successfully.',
			                            icon: 'success',
			                            allowOutsideClick: false, // Prevent closing when clicking outside
			                                        allowEscapeKey: false, // Prevent closing when pressing escape key
			                            customClass: {
			                                popup: 'custom-swal-font'
			                            },
			                            confirmButtonText: 'OK'
			                        }).then((result) => {
			                            if (result.isConfirmed) {
			                                    Swal.fire({
			                                            html: 'We sincerely appreciate your feedback! Please find your feedback ticket details below.<br><br>' + 
			                                    '<strong>' + feedbackTicket + '</strong>', // Display the feedback ticket on a new line
			                                    allowOutsideClick: false, // Prevent closing when clicking outside
			                                                allowEscapeKey: false, // Prevent closing when pressing escape key
			                                    customClass: {
			                                        popup: 'custom-swal-font'
			                                    },
			                                    confirmButtonText: 'OK'
			                                });
			                            }
			                        });
			                    } else {
			                        Swal.fire({
			                            title: 'Error!',
			                            text: 'There was an error submitting your feedback.',
			                            icon: 'error',
			                            allowOutsideClick: false, // Prevent closing when clicking outside
			                                        allowEscapeKey: false, // Prevent closing when pressing escape key
			                            customClass: {
			                                popup: 'custom-swal-font'
			                            },
			                            confirmButtonText: 'OK'
			                        });
			                    }
			                })
			                .catch(error => {
			                    console.error('Error:', error);
			                    loadingSwal.close();
			                    submitButton.disabled = false; // Re-enable the button
			                    Swal.fire({
			                        title: 'Error!',
			                        text: 'There was an error submitting your feedback.',
			                        icon: 'error',
			                        allowOutsideClick: false, // Prevent closing when clicking outside
			                                    allowEscapeKey: false, // Prevent closing when pressing escape key
			                        customClass: {
			                            popup: 'custom-swal-font'
			                        },
			                        confirmButtonText: 'OK'
			                    });
			                });
			        },
			        error: function (xhr, status, error) {
			            alert('Failed to fetch recently inserted feedback ticket: ' + error);
			        }
			    });
			});


			   // Clear form fields when the modal is closed
			   document.getElementById('feedbackModal').addEventListener('hidden.bs.modal', function () {
			       const feedbackForm = document.getElementById('feedbackForm');
			       feedbackForm.reset(); // Reset the form fields
			       document.getElementById('feedbackAttachment').value = ""; // Clear file input manually
			   });
	</script>

</body>

</html>