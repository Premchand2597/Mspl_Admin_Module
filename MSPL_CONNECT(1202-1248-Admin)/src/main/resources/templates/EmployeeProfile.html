<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>SuperAdmin Profile</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: NiceAdmin
  * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
  * Updated: Apr 20 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  <style>
   .table-container {
            max-height: 345px; /* Adjust as needed */
            overflow-y: auto;
            border-radius: 4px;
            position: relative;
        }

        .table-container thead {
            position: sticky;
            top: 0;
            background-color: #f8f9fa; /* Light background for the header */
            z-index: 1; /* Ensure the header is above the scrolling content */
        }

        .table-container::-webkit-scrollbar {
            width: 5px; /* Width of the scrollbar */
        }

        .table-container::-webkit-scrollbar-track {
            background:#edeef5; /* Track color */
        }

        .table-container::-webkit-scrollbar-thumb {
            background: #888; /* Scrollbar color */
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: #555; /* Hover color */
        }
        .form-label{
        	font-size: 0.9rem;
        }
        .profile-table th{
        	 font-weight: 600;
   			 color: rgba(1, 41, 112, 0.6);
        }
        
        .updateEmployeeForm input,
        .updateEmployeeForm select,
        .updateEmployeeForm textarea
        {
        	font-size:14px;
        }
        .changePassword label{
        	font-size:14px;
        }
        	  /* Custom select container */
		.select-container {
		  position: relative;
		  display: inline-block;
		}
		
		/* Hide default arrow */
		.select-container select {
		  appearance: none;
		  -webkit-appearance: none;
		  -moz-appearance: none;
		  background: transparent;
		  padding-right: 2.5rem; /* Adjust based on the size of the arrow */
		}
		
		/* Custom arrow icon */
		.select-container::after {
		  content: "";
		  position: absolute;
		  top: 50%;
		  right: 0.5rem; /* Adjust based on the size of the arrow */
		  transform: translateY(-50%);
		  width: 2rem; /* Adjust based on the size of the arrow */
		  height: 0.8rem; /* Adjust based on the size of the arrow */
		  background: url('assets/img/down-arrow.png') no-repeat center center;
		  background-size: contain;
		  pointer-events: none;
		}
		
		/* Optional: Add focus style to the select element */
		.select-container select:focus {
		  outline: none;
		}
  </style>
</head>

<body>

  <!-- ======= Header ======= -->
  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center" th:if="${empDetailsByEmpId.deptId>0}">

   <!--  <div class="app-branding" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="logo-icon" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				</div> --><!-- End Logo -->
	
		   <div class="d-flex align-items-center" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="d-none d-lg-block" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				    <i class="bi bi-chevron-double-left toggle-sidebar-btn" onclick="toggleIconRotation()"></i>
			</div>
				
   <!--  <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div> --><!-- End Search Bar -->

	<div th:replace="fragments/header :: header" ></div>
	
  </header><!-- End Header -->
  
  <!-- =======Super Admin Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center" th:if="${empDetailsByEmpId.deptId == 0}">

    <div class="d-flex align-items-center" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="d-none d-lg-block" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				    <i class="bi bi-chevron-double-left toggle-sidebar-btn" onclick="toggleIconRotation()"></i>
	</div><!-- End Logo -->

    <!-- <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div> --><!-- End Search Bar -->

    <div th:replace="fragments/superAdminHeader :: header"></div>

  </header><!-- End Header -->

  <!-- ======= Sidebar ======= -->
  
<aside id="sidebar" class="sidebar">
<input type="hidden" id="employee-id" th:value="${empDetailsByEmpId.deptId}">
<input type="hidden" id="employeeId1" name="empId" th:value="${empDetailsByEmpId.empid}" />
<input type="hidden" id="loggedEmpEmail" th:value="${empDetailsByEmpId.email}">

    <ul class="sidebar-nav" id="sidebar-nav">
		 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/userDashboard}">
                <i class="bi bi-grid"></i>
                <span>Dashboard</span>
            </a>
        </li>
         <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminProfile(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-person"></i>
                 <span>My Profile</span>
            </a>
        </li>  
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/attendanceLive(email=${empDetailsByEmpId.email})}">
                <i class="bi bi-calendar3"></i>
                <span>Attendence</span>
            </a> 
        </li>      
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/groupMailId}">
                <i class="bi bi-telephone"></i>
                <span>Employee Contacts</span>
            </a>
        </li>
       <!--  <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link " th:href="@{/InterCommDetails}">
                <i class="bi bi-telephone"></i>
                <span>InterComm Details</span>
            </a>
        </li> -->
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/adminHoliday}">
                <i class="bi bi-calendar4-week"></i>
                <span>Holiday List</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
		    <a class="nav-link active" th:href="@{/employee}">
		        <i class="bi bi-people"></i>	
		        <span>Employee</span>
		    </a>
	   </li> 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminLeaves(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-card-text"></i>
                <span>Team Leaves</span>
            </a>
        </li>    
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/events}">
                <i class="bi bi-megaphone"></i>
                <span>Announcement</span>
            </a>
        </li>           
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/asset}">
                <i class="bi bi-wallet"></i>
                <span>Assets</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/ongoingProject}">
                <i class="bi bi-card-heading"></i>
                <span>Projects</span>
            </a>
        </li>   
         <!-- <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminPayslip(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-file-text"></i>
                <span>Payslip</span>
            </a>
        </li> -->     
         <!-- Loop through the permissions map -->
       <li class="nav-item" th:if="${permissions.interviewAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/moatIframe}">
                <i class="bi bi-vector-pen"></i>
                <span>Interview</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.sales && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/sales}">
                <i class="bi bi-cart3"></i>
                <span>Sales</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.accountsAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/accounts}">
                <i class="bi bi-person-vcard"></i>
                <span>Accounts</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/store}">
                <i class="bi bi-shop-window"></i>
                <span>Store</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
				<a class="nav-link" th:href="@{/my-favorites}">
					<i class="bi bi-layout-text-window-reverse"></i>
					<span>To-Chat & Remind</span><span id="unreadCountBadge" class="badge bg-primary" style="display: none;"></span>
				</a>
		</li>
        
        
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link " th:href="@{/navbar}">
		        <i class="bi bi-grid"></i>
		        <span>Dashboard</span>
		    </a>
	    </li>
	    <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link" th:href="@{/attendanceLive(email=${empDetailsByEmpId.email})}">
                <i class="bi bi-calendar3"></i>
                <span>Attendence</span>
            </a>
      </li> 
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/adminHoliday}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Holiday List</span>
		    </a>
	 </li>	
	<li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/groupMailId}">
		        <i class="bi bi-telephone"></i>
		        <span>Employee Contacts</span>
		    </a>
	 </li>
	 <!--  <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link" th:href="@{/InterCommDetails}">
                <i class="bi bi-telephone"></i>
                <span>InterComm Details</span>
            </a>
      </li> -->
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/viewAdminLeaves(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Team Leaves</span>
		    </a>
	 </li> 
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/events}">
		        <i class="bi bi-megaphone"></i>
		        <span>Announcement</span>
		    </a>
	 </li> 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/addDepartment}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Department</span>
		    </a>
	   </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/addRole}">
		        <i class="bi bi-receipt"></i>
		        <span>Role</span>
		    </a>
	 </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:classappend="${empDetailsByEmpId.deptId==0} ? ' active'"  th:href="@{/employee}">
		        <i class="bi bi-people"></i>
		        <span>Employee</span>
		    </a>
	 </li> 
	 
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/ongoingProject}">
                <i class="bi bi-calendar3"></i>
                <span>Projects</span>
            </a>
      </li>  
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/asset}">
                <i class="bi bi-wallet"></i>
                <span>Assets</span>
            </a>
      </li> 
      <li class="nav-item" th:if="${permissions.interviewAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/moatIframe}">
                <i class="bi bi-vector-pen"></i>
                <span>Interview</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.sales && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/sales}">
                <i class="bi bi-cart3"></i>
                <span>Sales</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.accountsAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/accounts}">
                <i class="bi bi-person-vcard"></i>
                <span>Accounts</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/store}">
                <i class="bi bi-shop-window"></i>
                <span>Store</span>
            </a>
        </li> 
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId==0}">
				<a class="nav-link" th:href="@{/my-favorites}">
					<i class="bi bi-layout-text-window-reverse"></i>
					<span>To-Chat & Remind</span><span id="unreadCountBadge" class="badge bg-primary" style="display: none;"></span>
				</a>
		</li>  
    </ul>
</aside>
  <!-- End Sidebar-->

  <main id="main" class="main">
  
  <div class="chat-app" style="display: none;">
                <div id="plist" class="people-list">
                        <div class="input-group mb-3">
                                <input type="text" id="searchInputModal" class="form-control" placeholder="Search..."
                                        aria-label="Search">
                                <span class="input-group-text">
                                        <i class="bi bi-search"></i>
                                </span>

                        </div>
                        <ul id="employeeNames" class="list-unstyled chat-list mt-2 mb-0">
                                <!-- Employee names will be dynamically populated here -->
                        </ul>
                </div>

                <div class="chat">
                        <div class="chat-header clearfix">
                                <div class="row w-100">

                                        <!-- Employee Photo and Name Section -->
                                        <div class="col-lg-6 d-flex align-items-center">
                                                <div class="chat-about d-flex align-items-center">
                                                        <img id="employeePhoto" class="employee-photo" src="default-avatar.png"
                                                                alt="Employee Photo" />
                                                        <h6 class="m-b-0 ml-2" id="employeeName">Select an Employee</h6>
                                                </div>
                                        </div>
                                        <!-- Right aligned three dots (Vertical) -->
                                        <div class="col-lg-6 text-right">
                                                <div class="dropdown custom-dropdown">
                                                        <button class="btn btn-outline-secondary" type="button" id="dropdownMenuButton"
                                                                data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="fa fa-ellipsis-v"></i>
                                                        </button>
                                                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
                                                                <li><a class="dropdown-item" href="#">Delete Chat</a></li>
                                                                <li><a class="dropdown-item" href="#">Mute</a></li>
                                                                <li><a class="dropdown-item" href="#">Contact Info</a></li>
                                                        </ul>
                                                </div>
                                        </div>
                                </div>
                        </div>
                        <div id="chat-window" class="chat-history">
                                <ul class="m-b-0">
                                        <!-- Chat messages will be populated here dynamically -->

                                </ul>
                                <div id="message-icon-container" class="message-icon" style="display: none;">

                                        <!-- Plain square message icon SVG (behind) -->
                                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                                <g id="SVGRepo_iconCarrier">
                                                        <path
                                                                d="M10 9H17M10 13H17M7 9H7.01M7 13H7.01M21 20L17.6757 18.3378C17.4237 18.2118 17.2977 18.1488 17.1656 18.1044C17.0484 18.065 16.9277 18.0365 16.8052 18.0193C16.6672 18 16.5263 18 16.2446 18H6.2C5.07989 18 4.51984 18 4.09202 17.782C3.71569 17.5903 3.40973 17.2843 3.21799 16.908C3 16.4802 3 15.9201 3 14.8V7.2C3 6.07989 3 5.51984 3.21799 5.09202C3.40973 4.71569 3.71569 4.40973 4.09202 4.21799C4.51984 4 5.0799 4 6.2 4H17.8C18.9201 4 19.4802 4 19.908 4.21799C20.2843 4.40973 20.5903 4.71569 20.782 5.09202C21 5.51984 21 6.0799 21 7.2V20Z"
                                                                stroke="#94b7db" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                </g>
                                        </svg>

                                        <!-- SVG with animation -->
                                        <svg class="animated-icon" viewBox="0 0 374 374" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <g clip-path="url(#clip0)">
                                                        <path
                                                                d="M318.084 132.622C311.339 101.37 287.642 82 256.652 82C238.423 82 217.459 89.3248 197.954 102.509C191.574 106.904 182.642 106.904 176.079 102.672C155.298 88.9992 135.246 82 116.652 82C85.6626 82 61.9647 101.533 55.2199 133.111C44.2824 183.896 80.923 252.26 187.017 291C292.746 251.446 329.204 183.082 318.084 132.622Z" />
                                                        <path
                                                                d="M187.466 0C187.366 0 187.166 0 186.866 0C85.666 0 3.36603 82.3 3.36603 183.5C3.36603 224.8 17.466 264.9 43.266 297.2L16.566 359.3C14.366 364.4 16.766 370.3 21.766 372.4C23.566 373.2 25.566 373.4 27.466 373.1L125.366 355.9C144.966 363 165.566 366.6 186.366 366.5C287.566 366.5 369.866 284.2 369.866 183C370.066 82.1 288.366 0.1 187.466 0ZM192.966 269.8C188.966 271.3 184.666 271.3 180.666 269.8C149.066 257.1 124.466 238.3 109.466 215.4C95.966 194.7 90.766 171.4 94.866 149.9C100.466 121.4 121.866 102.3 148.266 102.3C160.966 102.3 173.866 106.5 186.766 114.7C199.366 106.5 212.466 102.3 225.066 102.3C251.866 102.3 272.866 120.9 278.466 149.6C286.066 188.8 262.666 241.3 192.966 269.8Z" />
                                                </g>
                                                <defs>
                                                        <clipPath id="clip0">
                                                                <rect width="373.232" height="373.232" fill="white" />
                                                        </clipPath>
                                                </defs>
                                        </svg>



                                        <!-- Dots Animation -->
                                        <div class="dots">
                                                <div class="dot"></div>
                                                <div class="dot"></div>
                                                <div class="dot"></div>
                                        </div>




                                </div>


                        </div>
                        <!-- Move the paragraph outside the chat window -->
                        <p id="logo-text"
                                style="text-align: center; font-size: 14px; color: #6c757d; margin-top: 10px; display: none;">
                                "Reach out to your colleagues and stay on top of your projects with quick, seamless communication."
                        </p>
                        <div class="chat-message clearfix">
                                <div class="custom-input-group mb-0">
                                        <input type="text" id="message" class="custom-form-control" placeholder="Enter your message..." />
                                        <div class="custom-input-group-append">
                                                <button class="custom-send-btn" onclick="sendMessage()">
                                                        <i class="ri ri-send-plane-2-fill"></i>
                                                </button>
                                        </div>
                                </div>

                        </div>
                </div>
        </div>
        <input type="hidden" th:value="${empDetailsByEmpId.email}" id="loggedInMail">
	<input type="hidden" id="emp_idSessionValue" th:value="${empDetailsByEmpId.empid}">        
<!-- Display Success Message -->
<div class="alert alert-success alert-dismissible" style="display:none;" role="alert">
    <span></span>
    <button type="button" class="btn-close" aria-label="Close"></button>
</div>

<!-- Display Error Message -->
<div class="alert alert-danger alert-dismissible" style="display:none;" role="alert">
    <span></span>
    <button type="button" class="btn-close" aria-label="Close"></button>
</div>


        
    <div class="pagetitle">
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a th:href="@{/navbar}">Home</a></li>
          <li class="breadcrumb-item active">Profile</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->

    <section class="section profile">
      <div class="row">
        <div class="col-xl-4">

          <div class="card">
            <div class="card-body profile-card pt-4 d-flex flex-column align-items-center">

              <img src="assets/img/profile-img.jpg" alt="Profile" class="rounded-circle">
              <h2 th:text="${employee.fullName}"></h2>
              <h3 th:text="${employee.roleName}"></h3>
              <div class="social-links mt-2">
                <a th:href="${employee.twitter_link}" class="twitter"><i class="bi bi-twitter"></i></a>
                <!-- <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                <a href="#" class="instagram"><i class="bi bi-instagram"></i></a> -->
                <a th:href="${employee.linkedin_link}" class="linkedin"><i class="bi bi-linkedin"></i></a>
              </div>
            </div>
            <div class="card-body profile-card profile-table pt-1 d-flex flex-column align-items-left" style="font-size:14px;">
		    <table class="table" style="width:100%; table-layout:fixed;">
		        <tbody>
		            <tr>
		                <th class="col-lg-4 col-md-4 label">Full Name</th>
		                <td class="col-lg-8 col-md-8" th:text="${employee.fullName}"></td>
		            </tr>
		            <tr>
		                <th class="col-lg-4 col-md-4 label">Job</th>
		                <td class="col-lg-8 col-md-8" th:text="${employee.roleName}"></td>
		            </tr>		            
		            <tr>
		                <th class="col-lg-4 col-md-4 label">Address</th>
		                <td class="col-lg-8 col-md-8" th:text="${employee.address}"></td>
		            </tr>
		            <tr>
		                <th class="col-lg-4 col-md-4 label">Phone</th>
		                <td class="col-lg-8 col-md-8" th:text="${employee.mobileNo}"></td>
		            </tr>
		            <tr>
		                <th class="col-lg-4 col-md-4 label">Email</th>
		                <td class="col-lg-8 col-md-8" th:text="${employee.email}"></td>
		            </tr>
		        </tbody>
		    </table>
		</div>

          </div>
          <div class="card">
          
            
          </div>

        </div>

        <div class="col-xl-8">

          <div class="card">
            <div class="card-body pt-3">
              <!-- Bordered Tabs -->
              <ul class="nav nav-tabs nav-tabs-bordered">

                <li class="nav-item">
                  <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#profile-overview">Emmergency<br> Contact</button>
                </li>

                <li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-edit">Update</button>
                </li>

                <li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-settings">Permission</button>
                </li>
				<li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-documents" onclick="documentOnlyUploadView();">Documents</button>
                </li>
                <li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-change-password">Change Password</button>
                </li>

              </ul>
              <div class="tab-content pt-2">

                    <div class="tab-pane fade show active profile-overview d-flex justify-content-between" id="profile-overview">
				
				    <!-- Primary Emergency Contact Card -->
				    <div class="card mb-3 shadow-sm">
				        <div class="card-body">
				            <h6 class="card-subtitle mb-2 text-muted">Primary Contact</h6>
				            <div class="d-flex align-items-center">
				                <i class="bi bi-person-circle me-2 text-primary" style="font-size: 20px;"></i>
				                <p class="mb-1 fw-bold" th:text="${employee.primary_emergency_contact_name}" style="font-size: 14px;"></p>
				            </div>
				            <div class="d-flex align-items-center">
				                <i class="bi bi-telephone-fill me-2 text-primary" style="font-size: 18px;"></i>
				                <p class="mb-1" th:text="${employee.primary_emergency_contact_number}" style="font-size: 14px;"></p>
				            </div>
				            <div class="d-flex align-items-center">
				                <i class="bi bi-people-fill me-2 text-primary" style="font-size: 18px;"></i>
				                <p class="mb-0" th:text="${employee.primary_emergency_contact_relation}" style="font-size: 14px;"></p>
				            </div>
				        </div>
				    </div>
				<hr style="width: 100px; transform: rotate(90deg);">
				    <!-- Secondary Emergency Contact Card -->
				    <div class="card mb-3 shadow-sm" style="width:50%;">
				        <div class="card-body">
				            <h6 class="card-subtitle mb-2 text-muted">Secondary Contact</h6>
				            <div class="d-flex align-items-center">
				                <i class="bi bi-person-circle me-2 text-primary" style="font-size: 20px;"></i>
				                <p class="mb-1 fw-bold" th:text="${employee.secondary_emergency_contact_name}" style="font-size: 14px;"></p>
				            </div>
				            <div class="d-flex align-items-center">
				                <i class="bi bi-telephone-fill me-2 text-primary" style="font-size: 18px;"></i>
				                <p class="mb-1" th:text="${employee.secondary_emergency_contact_number}" style="font-size: 14px;"></p>
				            </div>
				            <div class="d-flex align-items-center">
				                <i class="bi bi-people-fill me-2 text-primary" style="font-size: 18px;"></i>
				                <p class="mb-0" th:text="${employee.secondary_emergency_contact_relation}" style="font-size: 14px;"></p>
				            </div>
				        </div>
				    </div>
				</div>

                <div class="tab-pane fade profile-edit pt-3" id="profile-edit">

                  <!-- Profile Edit Form -->
                   <form class="updateEmployeeForm updateEmployeeFormWithValidation"
								th:action="@{/updateEmployee}" method="post"
								enctype="multipart/form-data">
								<div class="row jumbotron box8">
									<div class="row mb-3">
				                      <label for="profileImage" class="col-md-4 col-lg-3 col-form-label">Profile Image</label>
				                      <div class="col-md-8 col-lg-9">
				                        <img src="assets/img/profile-img.jpg" alt="Profile">
				                        <div class="pt-2">
				                          <a href="#" class="btn btn-primary btn-sm" title="Upload new profile image"><i class="bi bi-upload"></i></a>
				                          <a href="#" class="btn btn-danger btn-sm" title="Remove my profile image"><i class="bi bi-trash"></i></a>
				                        </div>
				                      </div>
				                    </div>
									<div class="col-sm-4 form-group mb-4 custom-field">
									    <input type="text" class="form-control custom_textfield"
									           name="empId" id="empId" placeholder=" " 
									           th:value="${employee.empid}" readonly required>
									    <label for="empId">Employee ID</label>
									    <span id="empId_error"></span>
									</div>
									
									<div class="col-sm-4 form-group mb-4 custom-field select-container">
									    <select class="form-control custom-select browser-default custom_selectfield"
									            name="deptId" id="deptId" required
									            onchange="fetchDesignations(this.value)">
									        <option th:value="${employee.deptId}" th:text="${employee.deptName}" selected></option>
									        <option th:each="dept : ${departments}" th:value="${dept.dept_id}" th:text="${dept.deptName}"></option>
									    </select> 
									    <label for="deptId">Department</label>
									    <span id="dept_error"></span>
									</div>
									
									<div class="col-sm-4 form-group mb-4 custom-field select-container">
									    <select class="form-control custom-select browser-default custom_selectfield"
									            name="roleId" id="roleId" required
									            onchange="toggleReportingManager(document.getElementById('designation').value);">
									        <option th:value="${employee.roleId}" th:text="${employee.roleName}" selected>Select Designation</option>
									    </select> 
									    <label for="roleId">Designation</label>
									    <span id="designation_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" class="form-control custom_textfield"
									           maxlength="20" name="firstName" id="first_name"
									           placeholder=" " th:value="${employee.fName}" required>
									    <label for="first_name">First Name</label>
									    <span id="firstName_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" class="form-control custom_textfield" name="lastName" id="last_name" placeholder=" " th:value="${employee.lName}" required>
									    <label for="last_name">Last Name</label>
									    <span id="lastName_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="email" class="form-control custom_emailfield"
									           name="email" id="email" placeholder=" " th:value="${employee.email}" required>
									    <label for="email">Email</label>
									    <span id="email_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" class="form-control custom_textfield"
									           maxlength="10" name="mobileNo" id="mobile_no"
									           placeholder=" " th:value="${employee.mobileNo}" required>
									    <label for="mobile_no">Mobile No</label>
									    <span id="mobile_error"></span>
									</div>
									
									<div class="col-sm-12 form-group mb-4 custom-field">
									    <textarea class="form-control" name="address"
									              id="address" rows="3"
									              placeholder=" " th:text="${employee.address}" required></textarea>
									    <label for="address">Address</label>
									    <span id="address_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="date" name="dob" class="form-control custom_date"
									           id="dob" placeholder=" " th:value="${employee.dob}" required>
									    <label for="dob">Date Of Birth</label>
									    <span id="dob_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="date" name="doj" class="form-control custom_date"
									           id="doj" placeholder=" " th:value="${employee.doj}" required>
									    <label for="doj">Date Of Joining</label>
									    <span id="doj_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" class="form-control custom_textfield"
									           maxlength="12" name="adharNo" id="aadhar"
									           placeholder=" " th:value="${employee.adharNo}" required>
									    <label for="aadhar">Aadhar No</label>
									    <span id="aadhar_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" class="form-control custom_textfield"
									           name="panCard" id="pan" placeholder=" " th:value="${employee.panCard}" required>
									    <label for="pan">PAN No</label>
									    <span id="pan_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field select-container">
									    <select class="form-control custom-select browser-default custom_selectfield"
									            name="gender" id="gender" required>
									        <option th:value="${employee.gender}" th:text="${employee.gender}" selected></option>
									        <option value="Male">Male</option>
									        <option value="Female">Female</option>
									        <option value="Other">Other</option>
									    </select>
									    <label for="gender">Gender</label>
									    <span id="gender_error"></span>
									</div>
									
									<div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" name="password"
									           class="form-control custom_passwordfield" id="pass1"
									           placeholder=" " th:value="${employee.password}" required>
									    <label for="pass1">Password</label>
									    <span id="password_error"></span>
									</div>

									<!-- <div class="col-sm-3 form-group photo_div mb-4">
										<label for="Date">Profile Pic (Png/Jpg)</label> <input
											type="file" id="photo" class="form-control custom_textfield"
											name="profilePic" required>
									</div>
									<div class="col-sm-3 form-group photo_div mb-4">
										<label for="Date">Pancard document (Png/Jpg)</label> <input
											type="file" id="panDoc" class="form-control custom_textfield"
											name="panPic" required>
									</div> -->
									<div class="col-sm-12 form-group mb-0 customize_btn_div mb-4 text-end">
										<button type="submit" class="btn btn-primary">Submit</button>
										<button type="reset" class="btn btn-secondary">Clear</button>
									</div>
								</div>
							</form><!-- End Profile Edit Form -->

                </div>

                <div class="tab-pane fade pt-3" id="profile-settings">

                  <!-- Settings Form -->
                  <form>

                    <div class="row mb-3">
                      <div class="col-md-8 col-lg-9">
                      
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="interviewAccess"
					           th:checked="${permissions.interviewAccess}">
					    <label class="form-check-label" for="interviewAccess">
					        Interview 
					    </label>						    
					</div>
					
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="salesAccess"
					           th:checked="${permissions.sales}">
					    <label class="form-check-label" for="salesAccess">
					        Sales
					    </label>
					</div>
					
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="accountsAccess"
					           th:checked="${permissions.accountsAccess}">
					    <label class="form-check-label" for="salesAccess">
					        Accounts
					    </label>
					</div>
					
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="storeAccess"
					           th:checked="${permissions.storeAccess}">
					    <label class="form-check-label" for="salesAccess">
					        Store
					    </label>
					</div>
                       <!--  <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="newProducts" checked>
                          <label class="form-check-label" for="newProducts">
                            Information on new products and services
                          </label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="proOffers">
                          <label class="form-check-label" for="proOffers">
                            Marketing and promo offers
                          </label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="securityNotify" checked disabled>
                          <label class="form-check-label" for="securityNotify">
                            Security alerts
                          </label>
                        </div> -->
                      </div>
                    </div>

                   <!--  <div class="text-center">
                      <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div> -->
                  </form><!-- End settings Form -->

                </div>
                
                
                <div class="tab-pane fade show profile-overview" id="profile-documents">
                  <h5 class="card-title">Document Uploads</h5>
                  
                  <form id="docUploadForm" method="post" action="updateEmployeeDocUploads" enctype="multipart/form-data">
                  	<input type="hidden" name="emp_id" id="emp_idValue" th:value="${employee.empid}">
	                  <div class="row">
		                  	<div class="col-sm-6 form-group photo_div mb-4">
						        <label for="photo" style="font-size: 14px;">Profile Pic (Png/Jpg)</label>
						        
						        <!-- <div class="col-sm-4 form-group photo_div mb-4 profilePicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
							    	<img id="profilePic" width="100%" height="100%" src="" />
							    </div> -->
							    
							    <div class="col-sm-4 form-group photo_div mb-4 profilePicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    <iframe id="profilePicIframe" width="100%" height="100%" style="display: none;"></iframe>
								    <img id="profilePic" width="100%" height="100%" src="" style="display: none;" />
								</div>
						        
						        <input type="file" accept=".png,.jpg,.jpeg" style="font-size: 14px;" id="photo" class="form-control" name="profilePic">
						    </div>
						
						     <div class="col-sm-6 form-group photo_div mb-4">
						        <label for="panDoc" style="font-size: 14px;">Pancard Doc (Png/Jpg)</label>
						        
						        <!-- <div class="col-sm-4 form-group photo_div mb-4 panPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
							    	<img id="panPic" width="100%" height="100%" src="" />
							    </div> -->
							    
							    <div class="col-sm-4 form-group photo_div mb-4 panPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    <iframe id="panPicIframe" width="100%" height="100%" style="display: none;"></iframe>
								    <img id="panPic" width="100%" height="100%" src="" style="display: none;" />
								</div>
						        
						        <input type="file" accept=".png,.jpg,.jpeg" style="font-size: 14px;" id="panDoc" class="form-control" name="panPic">
						    </div>
					    </div>
					    
					    <div class="row">
						    <div class="col-sm-6 form-group photo_div mb-4">
						        <label for="aadharDoc" style="font-size: 14px;">Aadhar Doc (Pdf)</label>
						        
						        <div class="col-sm-4 form-group photo_div mb-4 aadharPicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
								    <iframe id="aadharPicIframe" width="100%" height="100%" style="display: none;"></iframe>
								    <img id="aadharPic" width="100%" height="100%" src="" style="display: none;" />
								</div>
						        
						        <input type="file" accept=".pdf" style="font-size: 14px;" id="aadharDoc" class="form-control" name="aadharPic">
						    </div>
						    
						   <div class="col-sm-6 form-group photo_div mb-4">
						        <label for="tenthDoc" style="font-size: 14px;">10th Doc (Pdf)</label>
						        
						        <!-- <div class="col-sm-4 form-group photo_div mb-4 tenthPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
							    	<img id="tenthPic" width="100%" height="100%" src="" />
							    </div> -->
							    
							    <div class="col-sm-4 form-group photo_div mb-4 tenthPicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
								    <iframe id="tenthPicIframe" width="100%" height="100%" style="display: none;"></iframe>
								    <img id="tenthPic" width="100%" height="100%" src="" style="display: none;" />
								</div>
						        
						        <input type="file" accept=".pdf" style="font-size: 14px;" id="tenthDoc" class="form-control" name="tenthPic">
						    </div>
					    </div>
					    
					    <div class="row">
						    <div class="col-sm-6 form-group photo_div mb-4">
						        <label for="pucDoc" style="font-size: 14px;">PUC Doc (Pdf)</label>
						        
						        <!-- <div class="col-sm-4 form-group photo_div mb-4 pucPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
							    	<img id="pucPic" width="100%" height="100%" src="" />
							    </div> -->
							    
							    <div class="col-sm-4 form-group photo_div mb-4 pucPicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
								    <iframe id="pucPicIframe" width="100%" height="100%" style="display: none;"></iframe>
								    <img id="pucPic" width="100%" height="100%" src="" style="display: none;" />
								</div>
						        
						        <input type="file" accept=".pdf" style="font-size: 14px;" id="pucDoc" class="form-control" name="pucPic">
						    </div>
						    
						    <div class="col-sm-6 form-group photo_div mb-4">
						        <label for="degreeDoc" style="font-size: 14px;">Degree Doc (Pdf)</label>
						        
						        <!-- <div class="col-sm-4 form-group photo_div mb-4 degreePicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
							    	<img id="degreePic" width="100%" height="100%" src="" />
							    </div> -->
							    
							    <div class="col-sm-4 form-group photo_div mb-4 degreePicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
								    <iframe id="degreePicIframe" width="100%" height="100%" style="display: none;"></iframe>
								    <img id="degreePic" width="100%" height="100%" src="" style="display: none;" />
								</div>
						        
						        <input type="file" accept=".pdf" style="font-size: 14px;" id="degreeDoc" class="form-control" name="degreePic">
						    </div> 
					    </div>
					    
					    <div class="col-sm-12 form-group mb-0 customize_btn_div mb-4 text-end">
							<button type="submit" class="btn btn-primary">Update Document</button>
						</div>
				    </form>
                  </div>
                  
                  

                <div class="tab-pane fade pt-3 changePassword" id="profile-change-password">
                  <!-- Change Password Form -->
		             <form id="passwordChangeForm">
					    <input type="hidden" id="employeeId" name="empId" th:value="${employee.empid}" />
					    
					    <div class="row mb-3">
					        <label for="currentPassword" class="col-md-4 col-lg-3 col-form-label">Current Password</label>
					        <div class="col-md-8 col-lg-9">
					            <input name="currentPassword" type="password" class="form-control" id="currentPassword" required>
					        </div>
					    </div>
					
					    <div class="row mb-3">
					        <label for="newPassword" class="col-md-4 col-lg-3 col-form-label">New Password</label>
					        <div class="col-md-8 col-lg-9">
					            <input name="newPassword" type="password" class="form-control" id="newPassword" required>
					        </div>
					    </div>
					
					    <div class="row mb-3">
					        <label for="renewPassword" class="col-md-4 col-lg-3 col-form-label">Re-enter New Password</label>
					        <div class="col-md-8 col-lg-9">
					            <input name="renewPassword" type="password" class="form-control" id="renewPassword" required>
					        </div>
					    </div>
					
					    <div class="text-center">
					        <button type="submit" class="btn btn-primary">Change Password</button>
					    </div>
					</form><!-- End Change Password Form -->
                </div>

              </div><!-- End Bordered Tabs -->

            </div>
          </div>

        </div>
      </div>
    </section>
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="copyright">
      &copy; Copyright <strong><span>Melange System pvt ltd</span></strong>. All Rights Reserved
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/chart.js/chart.umd.js"></script>
  <script src="assets/vendor/echarts/echarts.min.js"></script>
  <script src="assets/vendor/quill/quill.js"></script>
  <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="assets/vendor/tinymce/tinymce.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>


  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
<!-- script to check the New Password and Re-enter New Password are equal or not if equal update the password -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('passwordChangeForm');

    const currentPassword = document.getElementById('currentPassword');
    const newPasswordField = document.getElementById('newPassword');
    const renewPasswordField = document.getElementById('renewPassword');
    const empIdField = form ? form.querySelector('input[name="empId"]') : null;

    const successAlert = document.querySelector('.alert-success');
    const errorAlert = document.querySelector('.alert-danger');

    // Close buttons for the alerts
    const successCloseBtn = successAlert.querySelector('.btn-close');
    const errorCloseBtn = errorAlert.querySelector('.btn-close');

    // Handle the close button click to hide the alert
    successCloseBtn.addEventListener('click', () => successAlert.style.display = 'none');
    errorCloseBtn.addEventListener('click', () => errorAlert.style.display = 'none');

    if (form) {
        form.addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent the default form submission

            const newPassword = newPasswordField.value;
            const renewPassword = renewPasswordField.value;

            // Clear any previous alerts
            successAlert.style.display = 'none';
            errorAlert.style.display = 'none';

            if (newPassword !== renewPassword) {
                errorAlert.querySelector('span').textContent = 'New Password and Re-enter New Password do not match.';
                errorAlert.style.display = 'block'; // Show the error alert
                return;
            }

            // Create a FormData object from the form
            const formData = new FormData();
            formData.append('newPassword', newPassword);
            formData.append('empId', empIdField ? empIdField.value : '');
            formData.append('currentPassword', currentPassword.value);

            // Prepare the AJAX request
            fetch('/updatePassword', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    successAlert.querySelector('span').textContent = 'Password updated successfully!';
                    successAlert.style.display = 'block'; // Show the success alert
                } else {
                    errorAlert.querySelector('span').textContent = 'Error updating password: ' + data.message;
                    errorAlert.style.display = 'block'; // Show the error alert
                }
            })
            .catch(error => {
                console.error('Error:', error);
                errorAlert.querySelector('span').textContent = 'An error occurred while updating the password.';
                errorAlert.style.display = 'block'; // Show the error alert
            });
        });
    }
});
</script>
<!-- script to fetch the designation based on selected department -->
<script>
function fetchDesignations(deptId) {
     if(deptId) {
        fetch(`/getDesignations?deptId=${deptId}`)
            .then(response => response.json())
            .then(data => {
                let designationSelect = document.getElementById('roleId');
                designationSelect.innerHTML = '<option value="" selected>Select Designation</option>';
                data.forEach(designation => {
                    let option = document.createElement('option');
                    option.value = designation.role_id;
                    option.text = designation.roleName;
                    designationSelect.add(option);
                });
            })
            .catch(error => console.error('Error fetching designations:', error));
    }
}
</script>

<!-- script to update the permission -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
$(document).ready(function() { 
    // Bind the 'change' event to both checkboxes
    $('.form-check-input').on('change', function() {
        var isChecked = $(this).is(':checked');
        var permissionType = $(this).attr('id');  // Get the id of the checkbox (e.g., 'interviewAccess' or 'salesAccess')
        
        // Retrieve employeeId from the parent div's data-empid attribute
        var employeeId = document.getElementById("employeeId").value;
        //alert(employeeId);
        // Data to be sent with the request
        var data = {
            "userId": employeeId,
            "permissionType": permissionType,  // Send the permission type (interviewAccess or salesAccess)
            "enabled": isChecked
        };
        
        // Confirming values        
        $.ajax({
            url: '/updateInterviewPermission',  // Same endpoint
            type: 'POST',
            contentType: 'application/json', // Specify content type
            data: JSON.stringify(data),  // Send the data with the request
            success: function(response) {
                console.log('Permission updated successfully');
            },
            error: function(xhr, status, error) {
                console.error('Failed to update permission:', error);
                console.error('Response text:', xhr.responseText);
            }
        });
    });
});

/* enable and disable the sales */

/* $(document).ready(function() {
    $('#salesAccess').on('change', function() {
        var isChecked = $(this).is(':checked');
        var employeeId = document.getElementById("employeeId").value;
        
        // Confirming values        
        $.ajax({
            url: '/updateSalesPermission',
            type: 'POST',
            contentType: 'application/json', // Specify content type
            data: JSON.stringify({
                "userId": employeeId,
                "enabled": isChecked
            }),
            success: function(response) {
                console.log('Permission updated successfully');
            },
            error: function(xhr, status, error) {
                console.error('Failed to update permission:', error);
                console.error('Response text:', xhr.responseText);
            }
        });
    });
}); */


</script>


<!-- script to notification -->
<!-- <script>
// Function to fetch flag value from the backend
function fetchFlag() {
    $.get("/flag", function(response) {
        var requestCount = response;
         
        // If total notification count is greater than 0, show the bell icon and notifications
        if (requestCount.totalNotificationCount > 0) {
            $("#notificationBellIcon").show();  // Show bell icon
            $("#leaveRequestNotification").show();  // Show specific notification
            
            $("#leaveRequestMessage").text(requestCount.leaveRequestFlagCount + " leave request(s)");
            $(".badge-number").text(requestCount.totalNotificationCount);
            $("#leaveRequestFlagCount").text(requestCount.leaveRequestFlagCount);
        } else {
            // If total notification count is 0, hide the bell icon and notification
            $("#notificationBellIcon").hide();
        }
        //display the asset notifu=ication based on asset count value
        if(requestCount.asseteRequestFlagCount>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#assetRequestNotification").show();  // Show specific notification
             
             $("#assetRequestMessage").text(requestCount.asseteRequestFlagCount + " asset request(s)");
             $(".badge-number").text(requestCount.totalNotificationCount);
             $("#asseteRequestFlagCount").text(requestCount.asseteRequestFlagCount);
        		
        }
        else {
            // If total notification count is 0, hide the bell icon and notification
            $("#assetRequestNotification").hide();
        }
    });
}

// Periodically fetch flag value every second (adjust as needed)
setInterval(fetchFlag, 1000);

</script> -->

<!-- script to display document tab -->
<script>
function documentOnlyUploadView() {
    $.ajax({
        type: "GET",
        url: "fetchEmployeeDocumentDetailsOnlyByEmpId",
        data: {
            "emp_id": $('#emp_idValue').val()
        },
        success: function(data) {
            // Apply displayFile for each document
            displayFile('.profilePicDiv', '#profilePic', '#profilePicIframe', `data:image/png;base64,${data.profilePicPath}`, 'image');
            displayFile('.panPicDiv', '#panPic', '#panPicIframe', `data:image/png;base64,${data.panPicPath}`, 'image');
            displayFile('.aadharPicDiv', '#aadharPic', '#aadharPicIframe', `data:application/pdf;base64,${data.aadhar_pic}`, 'pdf');
            displayFile('.tenthPicDiv', '#tenthPic', '#tenthPicIframe', `data:application/pdf;base64,${data.tenth_pic}`, 'pdf');
            displayFile('.pucPicDiv', '#pucPic', '#pucPicIframe', `data:application/pdf;base64,${data.puc_pic}`, 'pdf');
            displayFile('.degreePicDiv', '#degreePic', '#degreePicIframe', `data:application/pdf;base64,${data.degree_pic}`, 'pdf');

            function displayFile(divSelector, imgSelector, iframeSelector, fileData, fileType) {
                if (fileData) {
                    if (fileType === 'image') {
                        const imageSrc = fileData;
                        $(imgSelector).attr('src', imageSrc).show();
                        $(iframeSelector).hide();
                    } else if (fileType === 'pdf') {
                        const pdfSrc = fileData;
                        $(iframeSelector).attr('src', pdfSrc).show();
                        $(imgSelector).hide();
                    } else {
                        console.warn("Unsupported file format for selector:", divSelector);
                    }
                    $(divSelector).show();
                }
            } 
        },
        error: function(xhr, status, error) {
            console.error("Error invoking data:", error);
        }
    });
}
</script>


<!-- script to notification on bottom of the page-->
<!--CHAT BOOT-->

		<!-- Include SockJS and Stomp.js libraries -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.3.0/sockjs.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

<!-- script to notification on bottom of the page-->
<script>
		//CODE FOR CHATBOOT NOTIFICATION 
		var stompClient = null;
		var employeeMap = {}; // To store the mapping of employee names to emails
		let employeePhotoMap = {};
		let emailToNameMap = {}; // New map for email -> name lookup
		var email = null;
		var visibilityState = document.visibilityState; // Track tab visibility
		var heartbeatInterval = null; // Track heartbeat interval

		function connectWebSocket() {
			var socket = new SockJS('/chat-websocket');
			  stompClient = Stomp.over(socket);

			  var email = document.getElementById('loggedInMail').value;
			  console.log(`Connecting WebSocket as: ${email}`);

			  stompClient.connect({ 'email': email }, function (frame) {
			      console.log('Connected to WebSocket:', frame);

			      // Mark user as active
			      stompClient.send("/app/userConnected", {}, JSON.stringify({ email }));

			      // Subscribe to active users list
			      stompClient.subscribe('/topic/activeUsers', function (message) {
			          var activeUsers = JSON.parse(message.body);
			          updateActiveUserUI(activeUsers);
			      });

			      // Start heartbeat initially
			      heartbeatInterval = setInterval(() => {
			          if (stompClient && stompClient.connected) {
			              stompClient.send("/app/userHeartbeat", {}, JSON.stringify({ email }));
			              console.log("Heartbeat sent for user: " + email);
			          }
			      }, 20000); // 30 seconds

			      // Detect tab visibility change
			      document.addEventListener("visibilitychange", function () {
			          if (document.hidden) {
			              console.log("User switched to another tab. Marking as inactive.");
			              stompClient.send("/app/userInactive", {}, JSON.stringify({ email }));
			              clearInterval(heartbeatInterval); // Stop heartbeat
			              heartbeatInterval = null;
			          } else {
			              console.log("User returned to the application tab. Marking as active.");
			              stompClient.send("/app/userConnected", {}, JSON.stringify({ email }));
			              if (!heartbeatInterval) {
			                  heartbeatInterval = setInterval(() => {
			                      if (stompClient && stompClient.connected) {
			                          stompClient.send("/app/userHeartbeat", {}, JSON.stringify({ email }));
			                          console.log("Heartbeat sent for user: " + email);
			                      }
			                  }, 30000);
			              }
			          }
			      });

			      // Detect tab close or WebSocket disconnect
			      socket.onclose = function () {
			          console.log("WebSocket disconnected. Updating user status.");
			          stompClient.send("/app/userDisconnected", {}, JSON.stringify({ email }));
			      };

			      window.addEventListener('beforeunload', function () {
			          stompClient.send("/app/userDisconnected", {}, JSON.stringify({ email }));
			      });

			  });
		}

		function updateActiveUserUI(activeUsers) {
		//	alert("1");
		    const employeeItems = document.getElementById('employeeNames').getElementsByTagName('li');

		    Array.from(employeeItems).forEach(item => {
		        const employeeName = item.querySelector('span').textContent;
		        const email = employeeMap[employeeName]; 
		        const statusIndicator = item.querySelector('.status-indicator'); // Get the status dot

		        if (activeUsers.includes(email)) {
		            item.classList.add('active-user');
		            statusIndicator.style.backgroundColor = '#66cc66'; // Green for active users
		        } else {
		            item.classList.remove('active-user');
		            statusIndicator.style.backgroundColor = '#ff6666'; // Red for inactive users
		        }

		        // If this employee is currently selected, update chat header status
				if (selectedEmployee === email) {
				           const chatStatusIndicator = document.getElementById('chatStatusIndicator');
				           if (activeUsers.includes(email)) {
				               chatStatusIndicator.style.backgroundColor = '#66cc66'; // Green (Online)
				           } else {
				               chatStatusIndicator.style.backgroundColor = '#ff6666'; // Red (Offline)
				           }
				       }
		    });
		}


		// Select an employee to chat with
		function selectEmployee(employeeName) {
			selectedEmployee = employeeMap[employeeName]; // Get the email from the map
			console.log(`Employee selected: ${selectedEmployee}`);

			// Highlight the selected employee
			var employeeItems = document.querySelectorAll('#employeeNames li');
			employeeItems.forEach(function (item) {
				item.classList.remove('active');
			});
			var selectedItem = Array.from(employeeItems).find(item => item.innerHTML === employeeName);
			if (selectedItem) {
				selectedItem.classList.add('active');
			}

			// Update chat header with employee name and photo
			document.querySelector('.chat-about h6').innerText = employeeName;
			document.querySelector('#employeePhoto').src = employeePhotoMap[selectedEmployee] || 'default-profile.jpg';

			// Hide the message icon and dots when an employee is selected
			document.getElementById('message-icon-container').style.display = 'none';
			// Hide the paragraph when an employee is selected
			document.getElementById('logo-text').style.display = 'none';

			// Load messages for the selected employee
			loadMessages();
		}

		function loadEmployees() {
			console.log("Loading employee names...");

			// Fetch employee names from the endpoint
			fetch('/employees/names')
				.then(response => {
					console.log("Response received:", response);
					if (!response.ok) {
						throw new Error(`HTTP error! status: ${response.status}`);
					}
					return response.json();
				})
				.then(data => {
					console.log("Employee data fetched:", data); // Log the raw data

					const employeeList = document.getElementById('employeeNames');
					if (!employeeList) {
						console.error("Element with ID 'employeeNames' not found.");
						return;
					}

					employeeList.innerHTML = ''; // Clear the list before adding new items

					// Iterate through employee data
					data.forEach(employee => {
						console.log("Processing employee:", employee);

						// Create a list item for each employee
						const li = document.createElement('li');
						li.classList.add('d-flex', 'align-items-center', 'employee-item');

						// Handle missing or empty profile photo paths
						const profilePic = employeePhotoMap[employee.email] || '/static/default-profile.jpg';
						console.log(`Profile picture for ${employee.name}: ${profilePic}`);

						li.innerHTML = `
			                    <img src="${profilePic}" 
			                         alt="Employee Photo" 
			                         class="employee-photo mr-2" />
			                    <span>${employee.name}</span>
			                `;

						// Map employee name to email
						employeeMap[employee.name] = employee.email;
						console.log("Mapped employee:", employee.name, "->", employee.email);
						// Add new reverse mapping (email -> name)
						emailToNameMap[employee.email] = employee.name;
						// Add click event to list item
						li.onclick = () => {
							console.log(`Selected employee: ${employee.name}`);
							selectEmployee(employee.name);
						};

						// Append the list item to the employee list
						employeeList.appendChild(li);

					});

					console.log("Employee names loaded successfully. Employee map:", employeeMap);
					// Call the unread messages function after loading employee data
					fetchUnreadMessages();

					// Set interval to check for new messages every 10 seconds
						setInterval(fetchUnreadMessages, 10000);
				})
				.catch(error => {
					console.error("Error loading employees:", error);
				});
		}


		function loadMessages() {
			// alert("Loading messages...");
			// Get the logged-in user's email and selected employee's email
			var loggedInEmail = document.getElementById('loggedInMail').value;
			var selectedEmployeeEmail = selectedEmployee; // Email is already stored in selectedEmployee

			console.log(`Loading messages between: ${loggedInEmail} and ${selectedEmployeeEmail}`);

			fetch(`/messages?loggedInEmail=${encodeURIComponent(loggedInEmail)}&selectedEmployeeEmail=${encodeURIComponent(selectedEmployeeEmail)}`)
				.then(response => response.json())
				.then(data => {
					console.log("Chat messages loaded:", data);
					// Clear the chat window before displaying messages
					var chatWindow = document.getElementById('chat-window').querySelector('ul');
					chatWindow.innerHTML = '';

					// Display messages
					data.forEach(function (msg) {
						// showMessage(msg.senderEmail, msg.content, msg.recipientEmail, loggedInEmail);
						showMessage(msg.id, msg.senderEmail, msg.content, msg.recipientEmail, msg.timestamp, loggedInEmail);
					});
				})
				.catch(error => console.error("Error loading chat messages:", error));
		}
		let activeDeleteDropdown = null;
		function showMessage(id, senderEmail, message, recipientEmail, timestamp, loggedInEmail) {
			console.log("Message ID:", id);
			console.log(`LoggedInEmailrrr: ${loggedInEmail}, SenderEmail: ${senderEmail}`);

			const isSender = senderEmail === loggedInEmail;
			const senderName = isSender ? "Me" : Object.keys(employeeMap).find(name => employeeMap[name] === senderEmail) || senderEmail;
			const senderPhoto = employeePhotoMap[senderEmail] || 'default-avatar.png';
			const formattedTime = new Date(timestamp).toLocaleString(); // Format timestamp

			console.log(`Message ID: ${id}, Time: ${formattedTime}, From: ${senderEmail}, To: ${recipientEmail}, Content: "${message}"`);

			var chatWindow = document.getElementById('chat-window').querySelector('ul');
			var li = document.createElement('li');
			li.className = isSender ? 'clearfix right' : 'clearfix left';

			li.innerHTML = `
					    <div class="message-container" data-message-id="${id}" onclick="toggleDeleteOption(this)">
					        <img class="sender-photo" src="${senderPhoto}" alt="Sender Photo" />
					        <div class="message ${isSender ? 'my-message' : 'other-message'}">
					            <strong>${senderName}:</strong> ${message}
					        </div>
					    </div>
					    <div class="timestamp" style="text-align: ${isSender ? 'right' : 'left'};">
					        ${formattedTime}
					    </div>
					    ${isSender ? `
					        <div class="message-action-dropdown" >
					            <a class="dropdown-item" href="#" onclick="deleteMessage(this, ${id})">Delete Message</a>
					        </div>
					    ` : ''}`;

			chatWindow.appendChild(li);
			chatWindow.scrollTop = chatWindow.scrollHeight;
		}
		
		/*function fetchUnreadMessages() {
			console.log("Fetching unread messages...");
			var loggedInEmail = document.getElementById('loggedInMail').value;

			fetch(`/unread?email=${loggedInEmail}`)
				.then(response => response.json())
				.then(messages => {
					messages.forEach(message => {
						let senderName = emailToNameMap[message.senderEmail] || message.senderEmail;

						// Show notification with sender's email as a parameter
						showToastNotification(`New message from ${senderName}: ${message.content}`, message.senderEmail);
					});
				})
				.catch(error => console.error("Error fetching unread messages:", error));
		}*/

		let displayedMessageIds = new Set(); // Track displayed messages
		let closedMessageIds = new Set(); // Track closed messages

		function fetchUnreadMessages() {
		    console.log("Fetching unread messages...");
		    var loggedInEmail = document.getElementById('loggedInMail').value;

		    fetch(`/unread?email=${loggedInEmail}`)
		        .then(response => response.json())
		        .then(messages => {
		            messages.forEach(message => {
		                console.log("Processing message ID:", message.id); // Print message ID to console
		                
		                // Ignore messages that were previously closed
		                if (!displayedMessageIds.has(message.id) && !closedMessageIds.has(message.id)) {
							//alert(1);
		                    let senderName = emailToNameMap[message.senderEmail] || message.senderEmail;
		                    showToastNotification(`New message from ${senderName}: ${message.content}`, message.id, message.senderEmail);
		                    displayedMessageIds.add(message.id); // Mark message as displayed
		                }
						//alert(2);
		            });
		        })
		        .catch(error => console.error("Error fetching unread messages:", error));
		}
		// Global flag to track if the user manually dismissed notifications
		
		/*function showToastNotification(message, senderEmail) {
			
			var toastContainer = document.createElement('div');
			toastContainer.className = 'toast-notification';

			// Add message and close button
			toastContainer.innerHTML = `<p>${message}</p> <span class="toast-close"></span>`;

			document.body.appendChild(toastContainer);

			// Animate in
			setTimeout(() => {
				toastContainer.classList.add('show');
			}, 100);

			// Auto-hide after 8 seconds
			let autoHideTimeout = setTimeout(() => closeToast(toastContainer), 10000);

			// Prevent opening chat when clicking the close button
			toastContainer.querySelector('.toast-close').addEventListener('click', (event) => {
				event.stopPropagation(); // Prevent click from bubbling to toastContainer
				clearTimeout(autoHideTimeout);
				
				closeToast(toastContainer);
			});

			// Open chat when clicking on the notification
			toastContainer.addEventListener('click', () => {
				openChatWithSender(senderEmail);
				closeToast(toastContainer); // Remove notification when chat opens
			});
		}*/
		function showToastNotification(message, messageId, senderEmail) {
			//alert(1);
		    var toastContainer = document.createElement('div');
		    toastContainer.className = 'toast-notification';
		    toastContainer.innerHTML = `<p>${message}</p> <span class="toast-close"></span>`;

		    document.body.appendChild(toastContainer);

		    // Animate in
		    setTimeout(() => {
		        toastContainer.classList.add('show');
		    }, 100);

		    // Auto-hide after 8 seconds
		    let autoHideTimeout = setTimeout(() => closeToast(toastContainer, messageId), 8000);

		    // Prevent opening chat when clicking the close button
		    toastContainer.querySelector('.toast-close').addEventListener('click', (event) => {
		        event.stopPropagation(); // Prevent click from bubbling to toastContainer
		        clearTimeout(autoHideTimeout);
		        closedMessageIds.add(messageId); // Mark as closed so it won't be shown again
		        closeToast(toastContainer, messageId);
		    });

		    // Open chat when clicking on the notification
		    toastContainer.addEventListener('click', () => {
		        openChatWithSender(senderEmail);
		        closeToast(toastContainer, messageId); // Remove notification when chat opens
		    });
		}

		// Function to handle toast closing
		/*function closeToast(toast) {
			toast.classList.remove('show');
			setTimeout(() => toast.remove(), 300); // Faster fade-out
		}*/
		// Function to handle toast closing and mark as dismissed
		// Function to handle toast closing
		function closeToast(toast, messageId) {
		    toast.classList.remove('show');
		    setTimeout(() => toast.remove(), 300); // Faster fade-out
		}
		/*	function openChatWithSender(senderEmail) {
				console.log("Opening chat with:", senderEmail);
			    
				// Construct the URL for the UserFavorite page with the senderEmail as a query parameter
				const url = `/my-favorites?email=${encodeURIComponent(senderEmail)}`;
			    
				// Redirect to the UserFavorite page
				window.location.href = url;
			}*/

		function openChatWithSender(senderEmail) {
			console.log("Opening chat with:", senderEmail);

			// Store sender email in sessionStorage
			sessionStorage.setItem("chatSenderEmail", senderEmail);

			// Redirect to the UserFavorite page
			window.location.href = `/my-favorites`;
		}

		// Connect to the WebSocket server and load employees when the page is loaded
		document.addEventListener('DOMContentLoaded', function () {
			//fetchUnreadMessages();
			loadEmployees();
			connectWebSocket();
		});

	</script>
<!-- script for profile pic -->
<script>
$.ajax({
    type: "GET",
    url: "fetchEmployeeDocumentDetailsOnlyByEmpId",
    data: {
        "emp_id": $('#emp_idSessionValue').val()
    },
    success: function(data) {
    	console.log("++++data"+JSON.stringify(data));
        $('#dynamicProfilePic').attr('src', `${data.profilePicPath}`);
    },
    error: function(xhr, status, error) {
        console.error("Error invoking data:", error);
    }
});
</script>
</body>

</html>