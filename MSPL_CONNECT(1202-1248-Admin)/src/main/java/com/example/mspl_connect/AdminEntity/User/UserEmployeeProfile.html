<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>User Profile</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  
    <!-- SweetAlert2 Library -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- =======================================================
  
  * Template Name: NiceAdmin
  * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
  * Updated: Apr 20 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  
  ======================================================== -->
  
  <style>
  
		.profile-card .table {
		    width: 100%; /* Ensure table takes the full width of the parent */
		    table-layout: auto; /* Allow the table to adjust column widths based on content */
		}
		
		.profile-card .table th, .profile-card .table td {
		    word-wrap: break-word; /* Allows long words to break and wrap onto the next line */
		    white-space: normal; /* Allows text to wrap onto the next line */
		}
   
        .form-label{
        	font-size: 0.9rem;
        }
        
        .profile-table th{
        	 font-weight: 600;
   			 color: rgba(1, 41, 112, 0.6);
        }
        
        .updateEmployeeForm input,
        .updateEmployeeForm select,
        .updateEmployeeForm textarea
        {
        	font-size:14px;
        }
        
        .changePassword label{
        	font-size:14px;
        }
        
        /* Custom select container */
		.select-container {
		  position: relative;
		  display: inline-block;
		}
		
		/* Hide default arrow */
		.select-container select {
		  appearance: none;
		  -webkit-appearance: none;
		  -moz-appearance: none;
		  background: transparent;
		  padding-right: 2.5rem; /* Adjust based on the size of the arrow */
		}
		
		/* Custom arrow icon */
		.select-container::after {
		  content: "";
		  position: absolute;
		  top: 50%;
		  right: 0.5rem; /* Adjust based on the size of the arrow */
		  transform: translateY(-50%);
		  width: 2rem; /* Adjust based on the size of the arrow */
		  height: 0.8rem; /* Adjust based on the size of the arrow */
		  background: url('assets/img/down-arrow.png') no-repeat center center;
		  background-size: contain;
		  pointer-events: none;
		}
		
		/* Optional: Add focus style to the select element */
		.select-container select:focus {
		  outline: none;
		}
		
		 /* Footer styles */
        .footer {
            background-color: #f8f9fa;
            text-align: center;
        }
        span.error {
		    color: red;
		    font-size: 0.9em;
		}
        .edit-icon {
		    cursor: pointer;
		    color: #007bff;
		    transition: color 0.2s;
		}
		
		.edit-icon:hover {
		    color: #0056b3;
		}
  </style>
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center" th:if="${empDetailsByEmpId.deptId>0}">

   <!--  <div class="app-branding" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="logo-icon" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				</div> --><!-- End Logo -->
	
		   <div class="d-flex align-items-center" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="d-none d-lg-block" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				    <!-- <i class="bi bi-chevron-double-left toggle-sidebar-btn" onclick="toggleIconRotation()"></i> -->
			</div>
				
   <!--  <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div> --><!-- End Search Bar -->

	<div th:replace="fragments/header :: header" ></div>
	
  </header><!-- End Header -->
  
  <!-- =======Super Admin Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center" th:if="${empDetailsByEmpId.deptId == 0}">

    <div class="d-flex align-items-center" style="width:100%; margin:0 0 0 10px; padding:5px;">
				    <a class="app-logo" th:href=@{/dashboard}>
				        <img class="d-none d-lg-block" src="assets/img/logo.png" alt="logo" style="width:200px; height:50px; max-width:100%; padding:0 2px 0 10px; margin:0;">
				    </a>
				    <!-- <i class="bi bi-chevron-double-left toggle-sidebar-btn" onclick="toggleIconRotation()"></i> -->
	</div><!-- End Logo -->

    <!-- <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div> --><!-- End Search Bar -->

    <div th:replace="fragments/superAdminHeader :: header"></div>

  </header><!-- End Header -->


  <!-- ======= Sidebar ======= -->
  
<aside id="sidebar" class="sidebar">
<input type="hidden" id="employee-id" th:value="${empDetailsByEmpId.deptId}">
    <ul class="sidebar-nav" id="sidebar-nav">
		 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/userDashboard}">
                <i class="bi bi-grid"></i>
                <span>Dashboard</span>
            </a>
        </li>
         <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:classappend="${empDetailsByEmpId.email == employee.email ? 'active' : ''}"  th:href="@{/viewAdminProfile(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-person"></i>
                 <span>My Profile</span>
            </a>
        </li>  
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/attendanceLive(email=${empDetailsByEmpId.email})}">
                <i class="bi bi-calendar3"></i>
                <span>Attendence</span>
            </a> 
        </li>      
       <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/groupMailId}">
                <i class="bi bi-telephone"></i>
                <span>Employee Contacts</span>
            </a>
        </li>
       <!--  <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link " th:href="@{/InterCommDetails}">
                <i class="bi bi-telephone"></i>
                <span>InterComm Details</span>
            </a>
        </li> -->
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/adminHoliday}">
                <i class="bi bi-calendar4-week"></i>
                <span>Holiday List</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
		    <a class="nav-link" th:classappend="${empDetailsByEmpId.email != employee.email ? 'active' : ''}"  th:href="@{/employee}">
		        <i class="bi bi-people"></i>	
		        <span>Employee</span>
		    </a>
	   </li> 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminLeaves(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-card-text"></i>
                <span>Team Leaves</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/events}">
                <i class="bi bi-megaphone"></i>
                <span>Announcement</span>
            </a>
        </li>               
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/asset}">
                <i class="bi bi-wallet"></i>
                <span>Assets</span>
            </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/ongoingProject}">
                <i class="bi bi-card-heading"></i>
                <span>Projects</span>
            </a>
        </li>   
         <!-- <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
            <a class="nav-link" th:href="@{/viewAdminPayslip(empid=${empDetailsByEmpId.empid})}">
                <i class="bi bi-file-text"></i>
                <span>Payslip</span>
            </a>
        </li>     --> 
         <!-- Loop through the permissions map -->
       <li class="nav-item" th:if="${permissions.interviewAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/moatIframe}">
                <i class="bi bi-vector-pen"></i>
                <span>Interview</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.sales && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/sales}">
                <i class="bi bi-cart3"></i>
                <span>Sales</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.accountsAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/accounts}">
                <i class="bi bi-person-vcard"></i>
                <span>Accounts</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" th:href="@{/store}">
                <i class="bi bi-shop-window"></i>
                <span>Store</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.apprisalAccess && empDetailsByEmpId.deptId>0}" >
            <a class="nav-link" id="apprisalLink" th:href="@{/apprisal(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-file-text"></i>
		        <span>Appraisal</span>
		    </a>
        </li>
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
		    <a class="nav-link" id="apprisalLink" th:href="@{/employeeApprisal(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-file-text"></i>
		        <span>Employee Appraisal</span>
		    </a>
		</li>
       <li class="nav-item" th:if="${empDetailsByEmpId.deptId>0}">
				<a class="nav-link" th:href="@{/my-favorites}">
					<i class="bi bi-layout-text-window-reverse"></i>
					<span>To-Chat & Remind</span>
				</a>
		</li>
        
        
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link " th:href="@{/navbar}">
		        <i class="bi bi-grid"></i>
		        <span>Dashboard</span>
		    </a>
	    </li>
	    <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link" th:href="@{/attendanceLive(email=${empDetailsByEmpId.email})}">
                <i class="bi bi-calendar3"></i>
                <span>Attendence</span>
            </a>
        </li> 
         <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Holiday List</span>
		    </a>
	 </li>	
	 
	<li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/groupMailId}">
		        <i class="bi bi-telephone"></i>
		        <span>Employee Contacts</span>
		    </a>
	 </li>
	 <!--  <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/InterCommDetails}">
                <i class="bi bi-telephone"></i>
                <span>InterComm Details</span>
            </a>
      </li> -->
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/viewAdminLeaves(empid=${empDetailsByEmpId.empid})}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Team Leaves</span>
		    </a>
	 </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/events}">
		        <i class="bi bi-megaphone"></i>
		        <span>Announcement</span>
		    </a>
	 </li> 
        <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link" th:href="@{/addDepartment}">
		        <i class="bi bi-calendar4-week"></i>
		        <span>Department</span>
		    </a>
	   </li>
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link"  th:href="@{/addRole}">
		        <i class="bi bi-receipt"></i>
		        <span>Role</span>
		    </a>
	 </li>
	 
	 <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
		    <a class="nav-link active" th:href="@{/employee}">
		        <i class="bi bi-people"></i>
		        <span>Employee</span>
		    </a>
	 </li> 
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/ongoingProject}">
                <i class="bi bi-calendar3"></i>
                <span>Projects</span>
            </a>
      </li>  
      <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
            <a class="nav-link"  th:href="@{/asset}">
                <i class="bi bi-wallet"></i>
                <span>Assets</span>
            </a>
      </li>  
      <li class="nav-item" th:if="${permissions.interviewAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/moatIframe}">
                <i class="bi bi-vector-pen"></i>
                <span>Interview</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.sales && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/sales}">
                <i class="bi bi-cart3"></i>
                <span>Sales</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.accountsAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/accounts}">
                <i class="bi bi-person-vcard"></i>
                <span>Accounts</span>
            </a>
        </li>
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId==0}" >
            <a class="nav-link" th:href="@{/store}">
                <i class="bi bi-shop-window"></i>
                <span>Store</span>
            </a>
        </li>  
        <li class="nav-item" th:if="${permissions.storeAccess && empDetailsByEmpId.deptId==0}">
				<a class="nav-link" th:href="@{/my-favorites}">
					<i class="bi bi-layout-text-window-reverse"></i>
					<span>To-Chat & Remind</span>
				</a>
		</li>
    </ul>
</aside>

<!-- End Sidebar-->

  <main id="main" class="main">
  
  <input type="hidden" id="loggedInDeptName" th:value="${empDetailsByEmpId.deptName}">
 	<input type="hidden" id="employeeId1" name="empId" th:value="${empDetailsByEmpId.empid}">
 
  						<!-- Feedback Modal -->
						<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
							    <div class="modal-dialog">
							        <div class="modal-content rounded-4 shadow-lg">
							            <div class="modal-header border-0">
							                <h5 class="modal-title" id="feedbackModalLabel">Feedback Form</h5>
							                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							            </div>
							            <div class="modal-body">
							                <form id="feedbackForm" method="post" enctype="multipart/form-data">
							                	<!-- <input type="hidden" name="id" id="feedbackTicketNumber"> -->
							                    <div class="mb-3" style="display: none;">
							                        <label for="feedbackName" class="form-label fw-bold">Your Name</label>
							                        <input type="text" class="form-control" id="feedbackName" name="name" th:value="${empDetailsByEmpId.fullName}" readonly>
							                    </div>
							                    <div class="mb-3" style="display: none;">
							                        <label for="feedbackEmail" class="form-label fw-bold">Your Email</label>
							                        <input type="email" class="form-control" id="feedbackEmail" name="email" th:value="${empDetailsByEmpId.email}" readonly>
							                    </div>
							                    <div class="mb-3">
							                        <label for="feedbackEmailyy" class="form-label fw-bold">To</label>
							                        <div class="to-field-container">
							                            <span class="to-field rounded-pill px-3 py-2 shadow-sm">bugs_msplconnect@melangesystems.com</span>
							                        </div>
							                    </div>
												<div class="mb-3">
												    <label for="bugType" class="form-label fw-bold">Bug Type</label>
												    <select class="form-control" id="bugType" name="bugType" required>
												        <option value="MSPL Connect Application">MSPL Connect Application</option>
												        <option value="MSPL Connect New Feature">MSPL Connect New Feature</option>
												    </select>
												</div>
							
							                    <div class="mb-3">
							                        <label for="feedbackMessage" class="form-label fw-bold">Message</label>
							                        <textarea class="form-control" id="feedbackMessage" name="message" rows="4" placeholder="Enter your feedback here..." required></textarea>
							                    </div>
							                    <div class="mb-3">
							                        <label for="feedbackAttachment" class="form-label fw-bold">Attachment (optional)</label>
							                        <input type="file" class="form-control" id="feedbackAttachment" name="attachment" accept=".png, .jpg, .jpeg" multiple>
							                        <small class="text-muted">Max size: 5MB. You can upload multiple images.</small>
							                    </div>
							                    <button type="submit" class="btn btn-primary w-100 mt-3 py-2 shadow-sm" id="submitFeedbackBtn">Submit Feedback</button>
							                </form>
							            </div>
							        </div>
							    </div>
							</div>

  
  <!-- Message Display Area -->
		<div id="message" role="alert" style="display: none;" tabindex="0">

           <span id="messageSpan"></span>
           <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
  <input type="hidden" id="emp_idSessionValue" th:value="${empDetailsByEmpId.empid}">
     <!-- Display Success Message -->
       <!-- Display Success Message -->
	<div class="alert alert-success alert-dismissible" style="display:none;" role="alert">
	    <span></span>
	    <button type="button" class="btn-close" aria-label="Close"></button>
	</div>
	
	<!-- Display Error Message -->
	<div class="alert alert-danger alert-dismissible" style="display:none;" role="alert">
	    <span></span>
	    <button type="button" class="btn-close" aria-label="Close"></button>
	</div>

    <div class="pagetitle mb-0 d-flex">
      <i class="bi bi-chevron-double-left toggle-sidebar-btn mb-1" onclick="toggleIconRotation()" style="font-size:24px;color:#2F73B9;padding:0 10px;margin-left:-10px;margin-top:-10px;cursor:pointer;"></i>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a th:href="@{/userDashboard}">Home</a></li>
          <li class="breadcrumb-item active">Profile</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->

    <section class="section profile">
      <div class="row">
        <div class="col-xl-4">

          <div class="card">
            <div class="card-body profile-card pt-4 d-flex flex-column align-items-center">

              <img th:src="@{${employee.profilePicPath}}"  alt="Profile" class="rounded-circle">
              <h2 th:text="${employee.fullName}"></h2>
              <h3 th:text="${employee.roleName}"></h3>	
              <div class="social-links mt-2">
                <a th:href="${employee.twitter_link}" class="twitter"><i class="bi bi-twitter"></i></a>
                <!-- <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                <a href="#" class="instagram"><i class="bi bi-instagram"></i></a> -->
                <a th:href="${employee.linkedin_link}" class="linkedin"><i class="bi bi-linkedin"></i></a>
              </div>
            </div>
            <div class="card-body profile-card profile-table pt-1 d-flex flex-column align-items-left" style="font-size:14px;">
			    <table class="table" style="width:100%; table-layout:fixed;">
			        <tbody>
			        	 <tr style="border-top:1px solid #E9EAEC">
			                <th class="col-lg-4 col-md-4 label">Emp Id</th>
			                <td class="col-lg-8 col-md-8" th:text="${employee.empid}"></td>
			            </tr>
			            <tr>
			                <th class="col-lg-4 col-md-4 label">Name</th>
			                <td class="col-lg-8 col-md-8" th:text="${employee.fullName}"></td>
			            </tr>
			            <tr>
			                <th class="col-lg-4 col-md-4 label">Address</th>
			                <td class="col-lg-8 col-md-8" th:text="${employee.address}"></td>
			            </tr>
			            <tr>
			                <th class="col-lg-4 col-md-4 label">Phone</th>
			                <td class="col-lg-8 col-md-8" th:text="${employee.mobileNo}"></td>
			            </tr>
			            <tr>
			                <th class="col-lg-4 col-md-4 label">Email</th>
			                <td class="col-lg-8 col-md-8" th:text="${employee.email}" id="employeeEmail"></td>
			            </tr>
			        </tbody>
			    </table>
			</div>

          </div>
          <div class="card">
             
          </div>
        </div>

        <div class="col-xl-8">

          <div class="card">
            <div class="card-body pt-3">
              <!-- Bordered Tabs -->
              <ul class="nav nav-tabs nav-tabs-bordered">

                <li class="nav-item">
                  <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#profile-overview">Overview</button>
                </li>

               <li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-edit">Update</button>
                </li>
				<li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-documents" onclick="documentOnlyUploadView();">Documents</button>
                </li>
               <li class="nav-item" th:if="${empDetailsByEmpId.deptId==0}">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-settings">Permission</button>
                </li> 

                <li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-change-password">Change<br>Password</button>
                </li>
                <li class="nav-item">
                  <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-leaveDetails">Leave Details</button>
                </li>

              </ul>
              <div class="tab-content pt-2">

                <div class="tab-pane fade show active profile-overview" id="profile-overview">
                  <h5 class="card-title">About</h5>
                  <p class="small fst-italic">Sunt est soluta temporibus accusantium neque nam maiores cumque temporibus. Tempora libero non est unde veniam est qui dolor. Ut sunt iure rerum quae quisquam autem eveniet perspiciatis odit. Fuga sequi sed ea saepe at unde.</p>

                  <!--  <h5 class="card-title">Profile Details</h5>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label ">Full Name</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.fullName}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Job</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.roleName}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Country</div>
                    <div class="col-lg-9 col-md-8">USA</div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Address</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.address}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Phone</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.mobileNo}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Email</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.email}"></div>
                  </div>
 -->
                </div>

                <div class="tab-pane fade profile-edit pt-3" id="profile-edit">

                  <!-- Profile Edit Form -->
                   <form class="updateEmployeeForm updateEmployeeFormWithValidation"
								th:action="@{/updateEmployee}" method="post"
								enctype="multipart/form-data">
								<div class="row jumbotron box8">
									<!-- <div class="row mb-3">
				                      <label for="profileImage" class="col-md-4 col-lg-3 col-form-label">Profile Image</label>
				                      <div class="col-md-8 col-lg-9">
				                        <img src="assets/img/profile-img.jpg" alt="Profile">
				                        <div class="pt-2">
				                          <a href="#" class="btn btn-primary btn-sm" title="Upload new profile image"><i class="bi bi-upload"></i></a>
				                          <a href="#" class="btn btn-danger btn-sm" title="Remove my profile image"><i class="bi bi-trash"></i></a>
				                        </div>
				                      </div>
				                    </div> -->
									<div class="col-sm-4 form-group mb-4">
										<label for="empId">Employee ID</label>
									    <input type="text" class="form-control custom_textfield"
									           name="empId" id="empId" placeholder=" " 
									           th:value="${employee.empid}" readonly required>
									    
									    <span id="empId_error"></span>
									</div>
									
									<div class="col-sm-4 form-group mb-4 select-container">
									    <label for="deptId">Department</label>
									    <span id="dept_error"></span>
									    <select class="form-control custom-select browser-default custom_selectfield"
									            name="deptId" id="deptId" required
									            onchange="fetchDesignations(this.value)">
									        <option th:value="${employee.deptId}" th:text="${employee.deptName}" selected></option>
									        <option th:each="dept : ${departments}" th:value="${dept.dept_id}" th:text="${dept.deptName}"></option>
									    </select> 
									</div>
									
									<div class="col-sm-4 form-group mb-4 select-container">
									    <label for="roleId">Designation</label>
									    <span id="designation_error"></span>
									    <select class="form-control custom-select browser-default custom_selectfield"
									            name="roleId" id="roleId" required
									            onchange="toggleReportingManager(document.getElementById('designation').value);">
									        <option th:value="${employee.roleId}" th:text="${employee.roleName}" selected>Select Designation</option>
									    </select> 
									    
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									 	<label for="first_name">First Name</label>
									    <span id="firstName_error"></span>
									    <input type="text" class="form-control custom_textfield"
									           maxlength="20" name="firstName" id="first_name"
									           placeholder=" " th:value="${employee.fName}" required>
									   
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									    <label for="last_name">Last Name</label>
									    <span id="lastName_error"></span>
									    <input type="text" class="form-control custom_textfield"
									           maxlength="10" name="lastName" id="last_name"
									           placeholder=" " th:value="${employee.lName}">
									    
									    
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									    <label for="email">Email</label>
									    <span id="email_error"></span>
									    <input type="email" class="form-control custom_emailfield"
									           name="email" id="email" placeholder=" " th:value="${employee.email}" required>									   
									</div>
									
									<div class="col-sm-6 form-group mb-4">
										<label for="mobile_no">Mobile No</label>
									    <span id="mobile_error"></span>
									    <input type="text" class="form-control custom_textfield"
									           maxlength="10" name="mobileNo" id="mobile_no"
									           placeholder=" " th:value="${employee.mobileNo}" required pattern="\d{10}">									    
									</div>
									
									<div class="col-sm-12 form-group mb-4"> 
									    <label for="address">Address</label>
									    <span id="address_error"></span>
									    <textarea class="form-control" name="address"
									              id="address" rows="3"
									              placeholder=" " th:text="${employee.address}" required></textarea>
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									    <label for="dob">Date Of Birth (dd-mm-yyyy)</label>
									    <span id="dob_error"></span>
									    <input type="date" name="dob" class="form-control custom_date" id="dob" placeholder=" " th:value="${employee.dob}" required>									    
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									    <label for="doj">Date Of Joining (dd-mm-yyyy)</label>
									    <span id="doj_error"></span>
									    <input type="date" name="doj" class="form-control custom_date"
									           id="doj" placeholder=" " th:value="${employee.doj}" required>									   
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									    <label for="aadhar">Aadhar No</label>
									    <span id="aadhar_error"></span>
									    <input type="text" class="form-control custom_textfield"
									           maxlength="12" name="adharNo" id="aadhar"
									           placeholder=" " th:value="${employee.adharNo}">									    
									</div>
									
									<div class="col-sm-6 form-group mb-4">
									    <label for="pan">PAN No</label>
									    <span id="pan_error"></span>
									    <input type="text" class="form-control custom_textfield"
									           name="panCard" id="pan" placeholder=" " th:value="${employee.panCard}">
									   
									</div>
									
									<div class="col-sm-6 form-group mb-4 ">
									    <label for="gender">Gender</label>
									    <span id="gender_error"></span>
									    <select class="form-control  browser-default custom_selectfield"
									            name="gender" id="gender" required>
									        <option value="" disabled selected>Select gender</option>
									        <option value="Male" th:selected="${employee.gender == 'Male'}">Male</option>
									        <option value="Female" th:selected="${employee.gender == 'Female'}">Female</option>
									        <option value="Other" th:selected="${employee.gender == 'Other'}">Other</option>
									    </select>									    
									</div>
									<!-- <div class="col-sm-6 form-group mb-4 custom-field">
									    <input type="text" name="password"
									           class="form-control custom_passwordfield" id="pass1"
									           placeholder=" " th:value="${employee.password}" required>
									    <label for="pass1">Password</label>
									    <span id="password_error"></span>
									</div> -->

									<!-- <div class="col-sm-3 form-group photo_div mb-4">
										<label for="Date">Profile Pic (Png/Jpg)</label> <input
											type="file" id="photo" class="form-control custom_textfield"
											name="profilePic" required>
									</div>
									<div class="col-sm-3 form-group photo_div mb-4">
										<label for="Date">Pancard document (Png/Jpg)</label> <input
											type="file" id="panDoc" class="form-control custom_textfield"
											name="panPic" required>
									</div> -->
									<div class="col-sm-12 form-group mb-0 customize_btn_div mb-4 text-end">
										<button type="submit" class="btn btn-primary">Submit</button>
										<button type="reset" class="btn btn-secondary">Clear</button>
									</div>
								</div>
							</form><!-- End Profile Edit Form -->

                </div>
				<div class="tab-pane fade show profile-overview" id="profile-documents">
	                  <h5 class="card-title">Document Uploads</h5>
	                  
	                  <form id="docUploadForm" method="post" action="updateEmployeeDocUploads" enctype="multipart/form-data">
	                  	<input type="hidden" name="emp_id" id="emp_idValue" th:value="${employee.empid}">
		                  <div class="row">
			                  	<div class="col-sm-6 form-group photo_div mb-4">
							        <div class="d-flex justify-content-between"> <label for="photo" style="font-size: 14px;">Profile Pic (.png/.jpg)</label><span style="font-size:12px;color:#899499">   Max size:50MB</span></div>
							        
							        <!-- <div class="col-sm-4 form-group photo_div mb-4 profilePicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    	<img id="profilePic" width="100%" height="100%" src="" />
								    </div> -->
								    
								    <div class="col-sm-4 form-group photo_div mb-4 profilePicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
									    <iframe id="profilePicIframe" width="100%" height="100%" style="display: none;"></iframe>
									    <img id="profilePic" width="100%" height="100%" src="" style="display: none;" />
									</div>
							        
							        <input type="file" accept=".png,.jpg,.jpeg" style="font-size: 14px;" id="photo" class="form-control" name="profilePic">
							    </div>
							
							     <div class="col-sm-6 form-group photo_div mb-4">
							        <div class="d-flex justify-content-between"> <label for="panDoc" style="font-size: 14px;">Pancard Doc (.png/.jpg)</label><span style="font-size:12px;color:#899499">   Max size:50MB</span></div>
							        
							        <!-- <div class="col-sm-4 form-group photo_div mb-4 panPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    	<img id="panPic" width="100%" height="100%" src="" />
								    </div> --> 
								    
								    <div class="col-sm-4 form-group photo_div mb-4 panPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
									    <iframe id="panPicIframe" width="100%" height="100%" style="display: none;"></iframe>
									    <img id="panPic" width="100%" height="100%" src="" style="display: none;" />
									</div>
							        
							        <input type="file" accept=".png,.jpg,.jpeg" style="font-size: 14px;" id="panDoc" class="form-control" name="panPic">
							    </div>
						    </div>
						    
						    <div class="row">
							    <div class="col-sm-6 form-group photo_div mb-4">
							        <div class="d-flex justify-content-between"> <label for="aadharDoc" style="font-size: 14px;">Aadhar Doc (.png/.jpg)</label><span style="font-size:12px;color:#899499">   Max size:50MB</span></div>
							        
							        <div class="col-sm-4 form-group photo_div mb-4 aadharPicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
									    <iframe id="aadharPicIframe" width="100%" height="100%" style="display: none;"></iframe>
									    <img id="aadharPic" width="100%" height="100%" src="" style="display: none;" />
									</div>
							        
							        <input type="file" accept=".pdf" style="font-size: 14px;" id="aadharDoc" class="form-control" name="aadharPic">
							    </div>
							    
							   <div class="col-sm-6 form-group photo_div mb-4">
							        <div class="d-flex justify-content-between"> <label for="tenthDoc" style="font-size: 14px;">10th Doc (.png/.jpg)</label><span style="font-size:12px;color:#899499">   Max size:50MB</span></div>
							        
							        <!-- <div class="col-sm-4 form-group photo_div mb-4 tenthPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    	<img id="tenthPic" width="100%" height="100%" src="" />
								    </div> -->
								    
								    <div class="col-sm-4 form-group photo_div mb-4 tenthPicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
									    <iframe id="tenthPicIframe" width="100%" height="100%" style="display: none;"></iframe>
									    <img id="tenthPic" width="100%" height="100%" src="" style="display: none;" />
									</div>
							        
							        <input type="file" accept=".pdf" style="font-size: 14px;" id="tenthDoc" class="form-control" name="tenthPic">
							    </div>
						    </div>
						    
						    <div class="row">
							    <div class="col-sm-6 form-group photo_div mb-4">
							        <div class="d-flex justify-content-between"> <label for="pucDoc" style="font-size: 14px;">PUC Doc (.png/.jpg)</label><span style="font-size:12px;color:#899499">   Max size:50MB</span></div>
							        
							        <!-- <div class="col-sm-4 form-group photo_div mb-4 pucPicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    	<img id="pucPic" width="100%" height="100%" src="" />
								    </div> -->
								    
								    <div class="col-sm-4 form-group photo_div mb-4 pucPicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
									    <iframe id="pucPicIframe" width="100%" height="100%" style="display: none;"></iframe>
									    <img id="pucPic" width="100%" height="100%" src="" style="display: none;" />
									</div>
							        
							        <input type="file" accept=".pdf" style="font-size: 14px;" id="pucDoc" class="form-control" name="pucPic">
							    </div>
							    
							    <div class="col-sm-6 form-group photo_div mb-4">
							        <div class="d-flex justify-content-between"> <label for="degreeDoc" style="font-size: 14px;">Degree Doc (.png/.jpg)</label><span style="font-size:12px;color:#899499">   Max size:50MB</span></div>
							        
							        <!-- <div class="col-sm-4 form-group photo_div mb-4 degreePicDiv" style="width: 100%; height: 220px; margin-top: 10px; display: none;">
								    	<img id="degreePic" width="100%" height="100%" src="" />
								    </div> -->
								    
								    <div class="col-sm-4 form-group photo_div mb-4 degreePicDiv" style="width: 100%; height: 300px; margin-top: 10px; display: none;">
									    <iframe id="degreePicIframe" width="100%" height="100%" style="display: none;"></iframe>
									    <img id="degreePic" width="100%" height="100%" src="" style="display: none;" />
									</div>
							        
							        <input type="file" accept=".pdf" style="font-size: 14px;" id="degreeDoc" class="form-control" name="degreePic">
							    </div> 
						    </div>
						    
						    <div class="col-sm-12 form-group mb-0 customize_btn_div mb-4 text-end">
								<button type="submit" class="btn btn-primary">Update Document</button>
							</div>
					    </form>
	                  </div>
                <div class="tab-pane fade pt-3" id="profile-settings"  th:if="${empDetailsByEmpId.deptId==0}">

                  <!-- Settings Form -->
                  <form>

                    <div class="row mb-3">
                      <div class="col-md-8 col-lg-9">
                      
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="interviewAccess"
					           th:checked="${permissionstoDisplay.interviewAccess}">
					    <label class="form-check-label" for="interviewAccess">
					        Interview 
					    </label>						    
					</div>
					
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="salesAccess"
					           th:checked="${permissionstoDisplay.sales}">
					    <label class="form-check-label" for="salesAccess">
					        Sales
					    </label>
					</div>
					
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="accountsAccess"
					           th:checked="${permissionstoDisplay.accountsAccess}">
					    <label class="form-check-label" for="salesAccess">
					        Accounts
					    </label>
					</div>
					
					<div class="form-check form-switch" data-empid="[[${employee.empid}]]">
					    <input class="form-check-input" type="checkbox" id="storeAccess"
					           th:checked="${permissionstoDisplay.storeAccess}">
					    <label class="form-check-label" for="salesAccess">
					        Store
					    </label>
					</div>
                       <!--  <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="newProducts" checked>
                          <label class="form-check-label" for="newProducts">
                            Information on new products and services
                          </label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="proOffers">
                          <label class="form-check-label" for="proOffers">
                            Marketing and promo offers
                          </label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="securityNotify" checked disabled>
                          <label class="form-check-label" for="securityNotify">
                            Security alerts
                          </label>
                        </div> -->
                      </div>
                    </div>

                   <!--  <div class="text-center">
                      <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div> -->
                  </form><!-- End settings Form -->

                </div>
                

                <div class="tab-pane fade pt-3 changePassword" id="profile-change-password">
                  <!-- Change Password Form -->
		             <form id="passwordChangeForm">
		   						<input type="hidden" id="employeeId" name="empId" th:value="${employee.empid}" />
							    <div class="row mb-3" >
							        <label for="currentPassword" class="col-md-4 col-lg-3 col-form-label">Current Password</label>
							        <div class="col-md-8 col-lg-9">
							            <input name="currentPassword" type="password" class="form-control" id="currentPassword">
							        </div>
							    </div>
							 
							    <div class="row mb-3">
							        <label for="newPassword" class="col-md-4 col-lg-3 col-form-label">New Password</label>
							        <div class="col-md-8 col-lg-9">
							            <input name="newPassword" type="password" class="form-control" id="newPassword">
							        </div>
							    </div>
							
							    <div class="row mb-3">
							        <label for="renewPassword" class="col-md-4 col-lg-3 col-form-label">Re-enter New Password</label>
							        <div class="col-md-8 col-lg-9">
							            <input name="renewPassword" type="password" class="form-control" id="renewPassword">
							        </div>
							    </div>
							
							     <div class="text-center">
							        <button type="submit" class="btn btn-primary">Change Password</button>
							    </div>
							</form><!-- End Change Password Form -->
                </div>
 				<div class="tab-pane fade profile-overview" id="profile-leaveDetails">
                  <p class="small fst-italic"> Leave details.</p>
										<table class="table">
											<thead>
												<tr>
													<th>Leave Type</th>
													<th>Added</th>
													<th>Used</th>
													<th>Remaining</th>
													<th>Edit</th>
												</tr>
											</thead>
											<tbody id="leaveRecordsTable">
												<!-- Dynamic content will be inserted here -->
											</tbody>
										</table>
                  <!--  <h5 class="card-title">Profile Details</h5>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label ">Full Name</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.fullName}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Job</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.roleName}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Country</div>
                    <div class="col-lg-9 col-md-8">USA</div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Address</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.address}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Phone</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.mobileNo}"></div>
                  </div>

                  <div class="row">
                    <div class="col-lg-3 col-md-4 label">Email</div>
                    <div class="col-lg-9 col-md-8" th:text="${employee.email}"></div>
                  </div>
 -->
                </div>
              </div><!-- End Bordered Tabs -->

            </div>
          </div>

        </div>
      </div>
    </section>
  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="copyright">
      &copy; Copyright <strong><span>Melange System pvt ltd</span></strong>. All Rights Reserved
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/chart.js/chart.umd.js"></script>
  <script src="assets/vendor/echarts/echarts.min.js"></script>
  <script src="assets/vendor/quill/quill.js"></script>
  <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="assets/vendor/tinymce/tinymce.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  
 <!-- script to send feedback form -->
<script>

</script>


<!-- script to check the New Password and Re-enter New Password are equal or not if equal update the password -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('passwordChangeForm');

    const currentPassword = document.getElementById('currentPassword');
    const newPasswordField = document.getElementById('newPassword');
    const renewPasswordField = document.getElementById('renewPassword');
    const empIdField = form ? form.querySelector('input[name="empId"]') : null;

    const successAlert = document.querySelector('.alert-success');
    const errorAlert = document.querySelector('.alert-danger');

    // Close buttons for the alerts
    const successCloseBtn = successAlert.querySelector('.btn-close');
    const errorCloseBtn = errorAlert.querySelector('.btn-close');

    // Handle the close button click to hide the alert
    successCloseBtn.addEventListener('click', () => successAlert.style.display = 'none');
    errorCloseBtn.addEventListener('click', () => errorAlert.style.display = 'none');

    if (form) {
        form.addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent the default form submission

            const newPassword = newPasswordField.value;
            const renewPassword = renewPasswordField.value;
            const currentPasswordValue = currentPassword.value;
            const empId = empIdField ? empIdField.value : '';

            // Clear any previous alerts
            successAlert.style.display = 'none';
            errorAlert.style.display = 'none';

            // Step 1: Verify the current password via /verifyCurrentPassword
            try {
                const response = await fetch('/verifyCurrentPassword', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: new URLSearchParams({
                        empId: empId,
                        currentPassword: currentPasswordValue
                    })
                });

                const data = await response.json();

                if (!response.ok || !data.success) {
                    errorAlert.querySelector('span').textContent = data.message || 'Current password verification failed.';
                    errorAlert.style.display = 'block'; // Show the error alert
                    return;
                }
            } catch (error) {
                console.error('Error verifying current password:', error);
                errorAlert.querySelector('span').textContent = 'An error occurred while verifying the current password.';
                errorAlert.style.display = 'block'; // Show the error alert
                return;
            }

            // Step 2: Check if the new passwords match
            if (newPassword !== renewPassword) {
                errorAlert.querySelector('span').textContent = 'New Password and Re-enter New Password do not match.';
                errorAlert.style.display = 'block'; // Show the error alert
                return;
            }

            // Step 3: Proceed with updating the password
            const formData = new FormData();
            formData.append('newPassword', newPassword);
            formData.append('empId', empId);
            formData.append('currentPassword', currentPasswordValue);

            // Prepare the AJAX request for updating the password
            fetch('/updatePassword', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        successAlert.querySelector('span').textContent = 'Password updated successfully!';
                        successAlert.style.display = 'block'; // Show the success alert
                    } else {
                        errorAlert.querySelector('span').textContent = 'Error updating password: ' + data.message;
                        errorAlert.style.display = 'block'; // Show the error alert
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    errorAlert.querySelector('span').textContent = 'An error occurred while updating the password.';
                    errorAlert.style.display = 'block'; // Show the error alert
                });
        });
    }
});

</script>

<!-- script to fetch the designation based on selected department -->
<script>
function fetchDesignations(deptId) {
     if(deptId) {
        fetch(`/getDesignations?deptId=${deptId}`)
            .then(response => response.json())
            .then(data => {
                let designationSelect = document.getElementById('roleId');
                designationSelect.innerHTML = '<option value="" selected>Select Designation</option>';
                data.forEach(designation => {
                    let option = document.createElement('option');
                    option.value = designation.role_id;
                    option.text = designation.roleName;
                    designationSelect.add(option);
                });
            })
            .catch(error => console.error('Error fetching designations:', error));
    }
}
</script>

<!-- script to update the permission -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
$(document).ready(function() {
    $('#interviewAccess').on('change', function() {
        var isChecked = $(this).is(':checked');
        var employeeId = document.getElementById("employeeId").value;
        
        // Confirming values        
        $.ajax({
            url: '/updateInterviewPermission',
            type: 'POST',
            contentType: 'application/json', // Specify content type
            data: JSON.stringify({
                "userId": employeeId,
                "enabled": isChecked
            }),
            success: function(response) {
                console.log('Permission updated successfully');
            },
            error: function(xhr, status, error) {
                console.error('Failed to update permission:', error);
                console.error('Response text:', xhr.responseText);
            }
        });
    });
});
</script>
 <!-- script to notification -->
<script>
//Function to fetch flag value from the backend
function fetchFlag() {
    $.get("/flag", function(response) {
    	console.log("admin");
        var leaveRequestCountValue = response;
        console.log(leaveRequestCountValue);
       // If total notification count is greater than 0, show the bell icon
        if (leaveRequestCountValue.totalNotificationCount > 0) {
            $("#notificationBellIcon").show();  // Show bell icon
        } else {
            $("#notificationBellIcon").hide();  // Hide bell icon if no notifications
        }

        if (leaveRequestCountValue.leaveRequestFlagCount > 0) {
            $("#notificationBellIcon").show();  // Show bell icon
            $("#leaveRequestNotification").show();  // Show specific notification
            
            $("#leaveRequestMessage").text(leaveRequestCountValue.leaveRequestFlagCount + " leave request(s)");
            $(".badge-number").text(leaveRequestCountValue.leaveRequestFlagCount);
            $("#leaveRequestFlagCount").text(leaveRequestCountValue.leaveRequestFlagCount);
        }
        //display the asset notifu=ication based on asset count value
        if(leaveRequestCountValue.asseteRequestFlagCount>0){
        	 
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#assetRequestNotification").show();  // Show specific notification
              
             $("#assetRequestMessage").text(leaveRequestCountValue.asseteRequestFlagCount + " asset request(s)");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#asseteRequestFlagCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        	 	
        }
        
        //display the new project notification based on asset count value
        if(leaveRequestCountValue.newPrjectValueCount>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#newProjectNotification").show();  // Show specific notification
             
             $("#newProjectMessage").text(leaveRequestCountValue.newPrjectValueCount + " project request(s)");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
        //display the appraisal from HR notification ]
        if(leaveRequestCountValue.appraisalCount>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#hrAppraisal").show();  // Show specific notification
             
             $("#newProjectMessage").text(leaveRequestCountValue.appraisalCount + " Appraisal Form");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
      //display the appraisal from employee notification 
        if(leaveRequestCountValue.empAppraisalflag>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#empAppraisal").show();  // Show specific notification
             
             $("#apprisalempNotification").text(leaveRequestCountValue.empAppraisalflag + " employees sent appraisal");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
        
        //display the appraisal Due date notification 
        if(leaveRequestCountValue.adminAppraisalDuedate>0){
        	 $("#dueAppraisal").show();  // Show bell icon
             $("#empAppraisal").show();  // Show specific notification
             
             $("#apprisalDueNotification").text("Tomorrow is the due date for submit appraisal");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
             $("#newPrjectValueCount").text(leaveRequestCountValue.asseteRequestFlagCount);
        }
      //display the announcement notification based on asset count value
        if(leaveRequestCountValue.announcementNotification>0){
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#newAnnouncementNotification").show();  // Show specific notification
             
             $("#newannouncement").text(leaveRequestCountValue.announcementNotification + " announcement(s)");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);
        }
        //display the leave request status change notification
        if(leaveRequestCountValue.leaveRequestStatusChangeValue > 0){
        	 
        	 $("#notificationBellIcon").show();  // Show bell icon
             $("#leaveRequestSatusChangeNotification").show();  // Show specific notification
             
             $("#leaveRequestSatusChangeMessage").text("Your leave request status has been");
             $(".badge-number").text(leaveRequestCountValue.totalNotificationCount);             
        	 	
        } 
       
    });
}

// Periodically fetch flag value every second (adjust as needed)
setInterval(fetchFlag, 1000);

</script>

  <!-- script to notification link redirect -->
<!-- script to notification link redirect -->
<script th:inline="javascript">
    function redirectToLeaveRequest() {
        var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
        window.location.href = '/viewAdminLeaves?empid=' + empid;
    }
    function redirectToAsset() {
        //var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
        window.location.href = '/asset';
    }
    function redirectToProject() {
        //var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
        window.location.href = '/ongoingProject';
    }    
    function redirectToAppraisal() {
    	var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
    	window.location.href = '/apprisal?empid=' + empid;
    }    
    function redirectToemployeeAppraisal() {
    	var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
    	window.location.href = '/employeeApprisal?empid=' + empid;
    }    
    function redirectToAnnouncement() {
    	var empid = /*[[${empDetailsByEmpId.empid}]]*/ 'defaultEmpId';
    	window.location.href = '/events';
    }
    
    function redirectToAttendence() {
    	var email = /*[[${empDetailsByEmpId.email}]]*/ 'defaultEmpId';
    	window.location.href = '/attendanceLive?email=' +email;
    }
</script>
<!-- script for profile pic -->
<script>
$.ajax({
    type: "GET",
    url: "fetchEmployeeDocumentDetailsOnlyByEmpId",
    data: {
        "emp_id": $('#emp_idSessionValue').val()
    },
    success: function(data) {
    	console.log("++++data"+JSON.stringify(data));
        $('#dynamicProfilePic').attr('src', `${data.profilePicPath}`);
        $('#dynamicProfilePic1').attr('src', `${data.profilePicPath}`);
    },
    error: function(xhr, status, error) {
        console.error("Error invoking data:", error);
    }
});
</script>


<!-- script to display document tab -->
<script>
function documentOnlyUploadView() {
    $.ajax({
        type: "GET",
        url: "fetchEmployeeDocumentDetailsOnlyByEmpId",
        data: {
            "emp_id": $('#emp_idValue').val()
        },
        success: function(data) {
            //console.log(JSON.stringify(data));
            
            // Apply displayFile for each document
            displayFile('.profilePicDiv', '#profilePic', '#profilePicIframe', `${data.profilePicPath}`, 'image');
            displayFile('.panPicDiv', '#panPic', '#panPicIframe', `${data.panPicPath}`, 'image');
            displayFile('.aadharPicDiv', '#aadharPic', '#aadharPicIframe', `${data.aadhar_pic}`, 'pdf');
            displayFile('.tenthPicDiv', '#tenthPic', '#tenthPicIframe', `${data.tenth_pic}`, 'pdf');
            displayFile('.pucPicDiv', '#pucPic', '#pucPicIframe', `${data.puc_pic}`, 'pdf');
            displayFile('.degreePicDiv', '#degreePic', '#degreePicIframe', `${data.degree_pic}`, 'pdf');
            displayFile('.offerLetterDiv', '#offerLetterPic', '#offerLetterIframe', `${data.offer_letter}`, 'pdf');

            function displayFile(divSelector, imgSelector, iframeSelector, fileData, fileType) {
                if (fileData) {
                    if (fileType === 'image') {
                        const imageSrc = fileData;
                        $(imgSelector).attr('src', imageSrc).show();
                        $(iframeSelector).hide();
                    } else if (fileType === 'pdf') {
                        const pdfSrc = fileData;
                        $(iframeSelector).attr('src', pdfSrc).show();
                        $(imgSelector).hide();
                    } else {
                        console.warn("Unsupported file format for selector:", divSelector);
                        $(iframeSelector).hide().after('<p>No data available</p>');
                    }
                    $(divSelector).show();
                } else {
                    console.warn("No file data provided for:", divSelector);
                    $(iframeSelector).hide();
                    $(imgSelector).hide();
                    $(divSelector).append('<p>No file uploaded</p>');
                }
            }
        },
        error: function(xhr, status, error) {
            console.error("Error invoking data:", error);
        }
    });
}
</script>



<script>
    document.getElementById("docUploadForm").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent default form submission

        let formData = new FormData(this); // Create form data object

        fetch("updateEmployeeDocUploads", {
            method: "POST",
            body: formData
        })
        .then(response => {
            if (response.ok) {
                return response.text();
            } else {
                throw new Error("Failed to update documents");
            }
        })
        .then(data => {
        	location.reload();
        	/* const messageDiv = document.getElementById("message");
            messageDiv.style.display = "block";
            messageDiv.className = "alert alert-success alert-dismissible fade show";
            document.getElementById("messageSpan").innerHTML = data;
            messageDiv.focus(); */
        })
        .catch(error => {
        	const messageDiv = document.getElementById("message");
            messageDiv.style.display = "block";
            messageDiv.className = "alert alert-danger alert-dismissible fade show";
            document.getElementById("messageSpan").innerHTML = error.message;
            messageDiv.focus();
        });
    });
</script>


<!-- script to validate user profile form -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Validation functions for each field
    function validateEmpId() {
        const empId = document.getElementById('empId');
        const error = document.getElementById('empId_error');
        if (!empId.value.trim()) {
            error.textContent = 'Employee ID is required.';
        } else {
            error.textContent = '';
        }
    }

    function validateFirstName() {
        const firstName = document.getElementById('first_name');
        const error = document.getElementById('firstName_error');
        if (!firstName.value.trim()) {
            error.textContent = 'First name is required.';
        } else {
            error.textContent = '';
        }
    }

    function validateEmail() {
        const email = document.getElementById('email');
        const error = document.getElementById('email_error');
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!email.value.trim() || !emailRegex.test(email.value)) {
            error.textContent = 'Enter a valid email address.';
        } else {
            error.textContent = '';
        }
    }

    function validateMobile() {
        const mobile = document.getElementById('mobile_no');
        const error = document.getElementById('mobile_error');
        const mobileRegex = /^\d{10}$/;
        if (!mobile.value.trim() || !mobileRegex.test(mobile.value)) {
            error.textContent = 'Enter a valid 10-digit mobile number.';
        } else {
            error.textContent = '';
        }
    }

    function validateDept() {
        const dept = document.getElementById('deptId');
        const error = document.getElementById('dept_error');
        if (!dept.value.trim()) {
            error.textContent = 'Please select a department.';
        } else {
            error.textContent = '';
        }
    }

    function validateGender() {
        const gender = document.getElementById('gender');
        const error = document.getElementById('gender_error');
        if (!gender.value.trim()) {
            error.textContent = 'Please select your gender.';
        } else {
            error.textContent = '';
        }
    }

    function validateAddress() {
        const address = document.getElementById('address');
        const error = document.getElementById('address_error');
        if (!address.value.trim()) {
            error.textContent = 'Address is required.';
        } else {
            error.textContent = '';
        }
    }

    function validateDOB() {
        const dob = document.getElementById('dob');
        const error = document.getElementById('dob_error');
        if (!dob.value.trim()) {
            error.textContent = 'Date of Birth is required.';
        } else {
            error.textContent = '';
        }
    }

    function validateDOJ() {
        const doj = document.getElementById('doj');
        const error = document.getElementById('doj_error');
        if (!doj.value.trim()) {
            error.textContent = 'Date of Joining is required.';
        } else {
            error.textContent = '';
        }
    }

    // Attach blur event listeners to fields
    document.getElementById('empId').addEventListener('blur', validateEmpId);
    document.getElementById('first_name').addEventListener('blur', validateFirstName);
    document.getElementById('email').addEventListener('blur', validateEmail);
    document.getElementById('mobile_no').addEventListener('blur', validateMobile);
    document.getElementById('deptId').addEventListener('blur', validateDept);
    document.getElementById('gender').addEventListener('blur', validateGender);
    document.getElementById('address').addEventListener('blur', validateAddress);
    document.getElementById('dob').addEventListener('blur', validateDOB);
    document.getElementById('doj').addEventListener('blur', validateDOJ);

    // Allow only numbers in the mobile_no field
    document.getElementById('mobile_no').addEventListener('input', function () {
        this.value = this.value.replace(/[^0-9]/g, '');
    });
});
</script>
<!-- script to update the permission -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
$(document).ready(function() { 
    // Bind the 'change' event to both checkboxes
    $('.form-check-input').on('change', function() {
        var isChecked = $(this).is(':checked');
        var permissionType = $(this).attr('id');  // Get the id of the checkbox (e.g., 'interviewAccess' or 'salesAccess')
        
        // Retrieve employeeId from the parent div's data-empid attribute
        var employeeId = document.getElementById("employeeId").value;
        //alert(employeeId);
        // Data to be sent with the request
        var data = {
            "userId": employeeId,
            "permissionType": permissionType,  // Send the permission type (interviewAccess or salesAccess)
            "enabled": isChecked
        };
        
        // Confirming values        
        $.ajax({
            url: '/updateInterviewPermission',  // Same endpoint
            type: 'POST',
            contentType: 'application/json', // Specify content type
            data: JSON.stringify(data),  // Send the data with the request
            success: function(response) {
                console.log('Permission updated successfully');
            },
            error: function(xhr, status, error) {
                console.error('Failed to update permission:', error);
                console.error('Response text:', xhr.responseText);
            }
        });
    });
});

/* enable and disable the sales */

/* $(document).ready(function() {
    $('#salesAccess').on('change', function() {
        var isChecked = $(this).is(':checked');
        var employeeId = document.getElementById("employeeId").value;
        
        // Confirming values        
        $.ajax({
            url: '/updateSalesPermission',
            type: 'POST',
            contentType: 'application/json', // Specify content type
            data: JSON.stringify({
                "userId": employeeId,
                "enabled": isChecked
            }),
            success: function(response) {
                console.log('Permission updated successfully');
            },
            error: function(xhr, status, error) {
                console.error('Failed to update permission:', error);
                console.error('Response text:', xhr.responseText);
            }
        });
    });
}); */


</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Get the employee ID from the hidden input field
    const emailElement = document.getElementById("employeeEmail"); // Use ID for easier targeting
    const email = emailElement.textContent.trim();
    displayLeaveBalance(email);
});
//function to display leave balance modal
function displayLeaveBalance(email){
	
    // Remove surrounding double quotes if they exist
    email = email.replace(/^"|"$/g, ''); 
	
	
	fetch(`/leaveRecords/${email}`, { method: 'GET' })
		                .then(response => {
		                    console.log("Fetch request sent for leave records");

		                    if (!response.ok) {
		                        throw new Error('Network response was not ok for leave records');
		                    }
		                    return response.json();
		                })
		                .then(data => {
		                    console.log("Leave records data received from backend:", data);

		                    const tbody = document.querySelector('#leaveRecordsTable');
		                    tbody.innerHTML = ''; // Clear existing rows

		                    if (!data || data.length === 0) {
		                        const sickLeaveRow = document.createElement('tr');
		                        sickLeaveRow.innerHTML = `
		                            <td>Sick Leave</td>
		                            <td>0</td>
		                            <td>0</td>
		                            <td>0</td> 
		                            <td><i class="bi bi-pencil-square edit-icon" onclick="editLeave('Sick Leave')"></i></td>
		                        `;
		                        tbody.appendChild(sickLeaveRow);

		                        const casualLeaveRow = document.createElement('tr');
		                        casualLeaveRow.innerHTML = `
		                            <td>Casual Leave</td>
		                            <td>0</td>
		                            <td>0</td>
		                            <td>0</td>
		                            <td><i class="bi bi-pencil-square edit-icon" onclick="editLeave('Casual Leave')"></i></td>
		                        `;
		                        tbody.appendChild(casualLeaveRow);
		                    } else {
		                        data.forEach(record => {
		                            const row = document.createElement('tr');
		                            row.innerHTML = `
		                                <td>${record.leaveType}</td>
		                                <td>${record.totalAdded || '0'}</td>
		                                <td>${record.totalUsed || '0'}</td>
		                                <td>${record.remaining || '0'}</td>
		                                <td><i class="bi bi-pencil-square edit-icon" onclick="editLeave('${record.leaveType}')"></i></td>
		                            `;
		                            tbody.appendChild(row);
		                        });
		                    }

		                    return fetch('/fetchMaternityLeave/${email}', { method: 'GET' });
		                })
		                 .then(() => fetch(`/calculate-earned-leave?year=${new Date().getFullYear()}&email=${email}`, { method: 'GET' }))
		                .then(response => {
		                    console.log("Fetch request sent for calculated earned leave");
		                    console.log("Fetch request sent for calculated earned leave");
		                    console.log("Calculated Earned Leave Response Status:", response.status);

		                    if (!response.ok) {
		                        throw new Error('Network response was not ok for calculated earned leave');
		                    }
		                    return response.json();
		                })
		                .then(earnedLeave => {
		                    console.log("Calculated leave data received from backend:", earnedLeave);

		                    const row = document.createElement('tr');
		                    row.innerHTML = `
		                        <td>Earned Leave</td>
		                        <td>${earnedLeave.earnedLeave || '0'}</td>
		                        <td>${earnedLeave.elUsed || '0'}</td>
		                        <td>${earnedLeave.elRemaining || '0'}</td>
		                        <td><i class="bi bi-pencil-square edit-icon" onclick="editLeave('Earned Leave')"></i></td>
		                    `;
		                    const tbody = document.querySelector('#leaveRecordsTable');
		                    tbody.appendChild(row);

		                    // Hide the spinner and show the modal
		                    loadingSpinner.style.display = "none";

		                    const modal = new bootstrap.Modal(document.getElementById('leaveDetailsModal'));
		                    modal.show();
		                })
		                .catch(error => {
		                    console.error('Error fetching data:', error);
		                    // Hide the spinner on error
		                    loadingSpinner.style.display = "none";
		                });
	
	const modal = new bootstrap.Modal(document.getElementById('leaveDetailsModal'));
    modal.show();
}

function editLeave(leaveType) {
    alert(leaveType);
    // Add your edit functionality here
}
</script>
</body>

</html>